using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.Threading;
using System.Data.SqlClient;
using System.Windows.Forms.DataVisualization.Charting;

namespace SimulatorApplication
{
    public partial class Form1 : Form
    {

        public static string datasource = @"HP-PC\SQLEXPRESS";


        bool taskwait = true;

        public List<string> NoOfwafer = new List<string>();

        LotInformation lot = new LotInformation();


        public static string nooftherecipe;


        public static string str123;

        Thread t = new Thread(threadwait);

       public static Task taskTimer;                     // timer任務實體
        delegate void showTimeHandler();    // 顯示時間委派函式
      public static  ManualResetEvent pauseSignal;       // 控制任務 暫停或繼續
        int cnt = 0;                        // 計數器

        ManualResetEvent manu = new ManualResetEvent(false);

        static AutoResetEvent myResetEvent = new AutoResetEvent(false);


        bool FlagStop = false;

        ManualResetEvent MTestTdEvent = new ManualResetEvent(true);


        public bool ispauserobot = false;


        public bool iscancelrecipe = false;

        int Cumtm = 0;

        Task task1 = null;


        public static string chamberload;
        public static string form2Msg;
        public static string stepname;
        public static int StepSec;
        public string mySec1;
        public int Sec1;
        public DateTime StartTime = new DateTime();
        public DateTime Wafer2StartTime = new DateTime();
        public DateTime Wafer3StartTime = new DateTime();
        public DateTime Wafer4StartTime = new DateTime();
        public DateTime Wafer5StartTime = new DateTime();
        public DateTime Wafer6StartTime = new DateTime();
        public DateTime Wafer7StartTime = new DateTime();
        public DateTime Wafer8StartTime = new DateTime();
        public DateTime Wafer9StartTime = new DateTime();
        public DateTime Wafer10StartTime = new DateTime();
        public DateTime Wafer11StartTime = new DateTime();
        public DateTime Wafer12StartTime = new DateTime();
        public DateTime Wafer13StartTime = new DateTime();
        public DateTime Wafer14StartTime = new DateTime();
        public DateTime Wafer15StartTime = new DateTime();
        public DateTime Wafer16StartTime = new DateTime();
        public DateTime Wafer17StartTime = new DateTime();
        public DateTime Wafer18StartTime = new DateTime();
        public DateTime Wafer19StartTime = new DateTime();
        public DateTime Wafer20StartTime = new DateTime();
        public DateTime Wafer21StartTime = new DateTime();
        public DateTime Wafer22StartTime = new DateTime();
        public DateTime Wafer23StartTime = new DateTime();
        public DateTime Wafer24StartTime = new DateTime();
        public DateTime EndTime = new DateTime();
        public DateTime WaferTime = new DateTime();
        public DateTime StepStartTime = new DateTime();
        public DateTime StepEndTime = new DateTime();
        public List<DateTime> ListStepStartTime = new List<DateTime>();
        public List<DateTime> ListStepEndTime = new List<DateTime>();
        public string noofwafer;
        bool on_off = false;
        bool stop = false;
        bool isStopRobot = false;
        bool isintoaligner = true;
        int x;
        int y;
        
        //  ManualResetEvent manu = new ManualResetEvent(true);

        // private readonly CancellationTokenSource _cts = new CancellationTokenSource();

        // private readonly PauseTokenSource _mPauseTokeSource = new PauseTokenSource();



        public Microsoft.VisualBasic.PowerPacks.ShapeContainer newcontainer;

        //   public Microsoft.VisualBasic.PowerPacks.ShapeContainer APMcontainer;

        //    public Microsoft.VisualBasic.PowerPacks.ShapeContainer robotupcontainer;

        //   public Microsoft.VisualBasic.PowerPacks.ShapeContainer robotintoAPMcontainer;



        AutoResetEvent manu1;
        string CI2;
        string BCI3;
        string SF6;
        string CHF3;
        string Oxygen;
        string Oxygen1;
        string Nitrogen;
        string Argon;
        public string strEvent = "insert into EventLog(Date,Event,Info) values(@1,@2,@3)";
        public delegate void LoadChamber1(object sender, EventArgs e);
        public LoadChamber1 loadchamber1;
        public delegate void LoadData();
        public LoadData loaddata;

        List<string> picname = new List<string>();
        //   ManualResetEvent pauseSignal;
        SqlConnectionStringBuilder scsb;
        List<string> strStepname1 = new List<string>();
        // LogIn login = new LogIn();



        public void analysis()
        {

        }




        public Form1()
        {
            InitializeComponent();
            //this.FormBorderStyle = FormBorderStyle.None;
            //this.WindowState = FormWindowState.Maximized;


        }


        private void Form1_Load(object sender, EventArgs e)
        {
            
            btnChamber.Enabled = false;
           
            

            button2.Tag = "";

            btnLogIn.Tag = "LogIn";
           // button5.Image = Properties.Resources.pause2;

            button5.Image.Tag = "Pause";

            button4.Enabled = false;
            button5.Enabled = false;


            //   picendeffector.Width += 2;

            Control.CheckForIllegalCrossThreadCalls = false;
            t.Start();
            picWafer1.Visible = false;
            picWafer2.Visible = false;
            picWafer3.Visible = false;
            picWafer4.Visible = false;
            picWafer5.Visible = false;
            picWafer6.Visible = false;
            picWafer7.Visible = false;
            picWafer8.Visible = false;
            picWafer9.Visible = false;
            picWafer10.Visible = false;
            picWafer11.Visible = false;
            picWafer12.Visible = false;
            picWafer13.Visible = false;
            picWafer14.Visible = false;
            picWafer15.Visible = false;
            picWafer16.Visible = false;
            picWafer17.Visible = false;
            picWafer18.Visible = false;
            picWafer19.Visible = false;
            picWafer20.Visible = false;
            picWafer21.Visible = false;
            picWafer22.Visible = false;
            picWafer23.Visible = false;
            picWafer24.Visible = false;
            picWafer25.Visible = false;




            btnendeffector.Parent = picMain;

            btnendeffector.FlatStyle = FlatStyle.Flat;
            btnendeffector.FlatAppearance.BorderColor = TransparencyKey;
            btnendeffector.FlatAppearance.MouseOverBackColor = TransparencyKey;
            btnendeffector.FlatAppearance.MouseDownBackColor = TransparencyKey;

            // btnendeffector.Parent = picMain;

            lblData.Visible = true;
            lblnum.Visible = true;
            picwafer.Image.Tag = "wafer";
            // panelrobot.BackColor = Color.Transparent;
            // panelrobot.Parent = picMain;
            lblwaferup.BackColor = Color.LightBlue;

            // ovalShape2.Visible = false;
            lblwaferaligner.BackColor = Color.LightBlue;
            lblwaferright.BackColor = Color.LightBlue;

            newcontainer = new Microsoft.VisualBasic.PowerPacks.ShapeContainer();
            //  APMcontainer = new Microsoft.VisualBasic.PowerPacks.ShapeContainer();
            // robotupcontainer = new Microsoft.VisualBasic.PowerPacks.ShapeContainer();
            // robotintoAPMcontainer = new Microsoft.VisualBasic.PowerPacks.ShapeContainer();


            //    robotintoAPMcontainer.Parent = this;
            //    robotupcontainer.Parent = this;
            newcontainer.Parent = this;
            //   APMcontainer.Parent = this;

            //    ovalShapeAPM.Parent = robotintoAPMcontainer;
            ovalShape1.Parent = newcontainer;
            //    ovalShapeAPM.Parent = APMcontainer;
            //    ovalShapeUp.Parent = robotupcontainer;
            // lblProcess.ForeColor = Color.Black;
            lblProcess.Text = "Unknow";
            lblProcess.BringToFront();
            lblStepName.BringToFront();
            lblProcessStep.BringToFront();

            ovalShape1.BackColor = Color.LightBlue;
            lblwafer.BackColor = Color.LightBlue;
            lblwaferAPM.BackColor = Color.LightBlue;

            ovalShapeAPM.BackColor = Color.Blue;

            ovalShape1.BringToFront();
            ovalShapeAPM.BringToFront();

            lblwafer.Visible = false;

            //   lblwafer.BackColor = Color.White;
            lblwafer.Text = "";

            picMain.SendToBack();

            // ovalShape2.BringToFront();
            //  Chamber1 chamber1 = new Chamber1();
            // ovalShape1.BackColor = Color.Red;
            // picMain.SendToBack();
            // this.panel3.BackColor = Color.Transparent;
            //this.panel3.Parent = this.picMain;
            //panel3.BringToFront();
            Properties.Resources.No1_2_3.Tag = "1_2_3";


            lblLoad.Left -= 0;
            lbl123.Left -= 0;
            lblCassetteRecipename.Left -= 0;
            lblmTorr.Left -= 0;
            lblState.Left -= 0;

            lblLoad.Text = "Aborted";

            lblChamber.Tag = chamberload;
            //  picMain.Image = Properties.Resources.mainpic;
            picMain.Image = Properties.Resources.mainpicture;
            picMain.Image.Tag = "mainpicture";


            //picCassette.Image = imageList1.Images[0];
            // picCassette.Image = Image.FromFile(@"C: \Users\hp\Documents\Visual Studio 2015\Projects\SimulatorApplication\SimulatorApplication\image\cassette.png");
            picCassette.Image = Properties.Resources.cassette;
            picwafer.Image = Properties.Resources.wafer;
            picCassette.Image.Tag = "cassette";

            picChamber.Image = Properties.Resources.new_chamber;


            // lblState.Text = "Idle";
            // lblmTorr.Text = "760 Torr";
            lblCassette.Tag = "";

        }

        private async void button2_Click(object sender, EventArgs e)
        {
            



            //       pauseSignal = new ManualResetEvent(false);


            if (button2.Tag.ToString() == "")
            {



                if (btnVCH.Text == "Control Mode: Automatic")

                {

                    if (lblProcess.Text == "Idle" && lbltm.Text == "Idle")

                    {


                       
                        DialogResult dr = lot.ShowDialog();
                        scsb = new SqlConnectionStringBuilder();
                        scsb.DataSource = datasource;
                        scsb.InitialCatalog = "RecipeType";
                        scsb.IntegratedSecurity = true;
                        SqlConnection con = new SqlConnection(scsb.ToString());


                        

                        if (dr == DialogResult.OK)
                        {
                            button3.Enabled = true;
                            button4.Enabled = true;
                            button5.Enabled = true;

                            iscancelrecipe = false;
                            if (ispauserobot == false)
                            {




                                //   pauseSignal = new ManualResetEvent(true);
                                //   taskTimer = new Task(timerCallback);
                                //  taskTimer.Start();
                                //    await taskTimer;


                                button2.Enabled = false;
                                //  button2.Tag = "robotStart";


                             /*   con.Open();
                                string SQLeventlog = "insert into EventLog (Date,Event,Info) values(@1,@2,@3)";

                                SqlCommand cmdeventlog = new SqlCommand(SQLeventlog,con);
                                cmdeventlog.Parameters.AddWithValue("@1",DateTime.Now);
                                cmdeventlog.Parameters.AddWithValue("@2", "");
                                cmdeventlog.Parameters.AddWithValue("@3", "");
                                con.Close();*/

                                con.Open();
                                string SQLnoofwafer = "select noofwafers from cassettewafer where cassetterecipename like @searchcassetterecipename";
                                SqlCommand cmdnoofwafer = new SqlCommand(SQLnoofwafer, con);
                                cmdnoofwafer.Parameters.AddWithValue("@searchcassetterecipename", form2Msg);
                                SqlDataReader readernoofwafer = cmdnoofwafer.ExecuteReader();
                                while (readernoofwafer.Read())
                                {
                                    NoOfwafer.Add(readernoofwafer["noofwafers"].ToString());

                                }
                                con.Close();
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "mainpicture"&&iscancelrecipe==false)
                                {
                                    await Task.Delay(1000);

                                    con.Open();

                                    SqlCommand cmdevent = new SqlCommand(strEvent, con);
                                    cmdevent.Parameters.AddWithValue("@1", DateTime.Now);
                                    cmdevent.Parameters.AddWithValue("@2", "Machine robot reversal");
                                    cmdevent.Parameters.AddWithValue("@3", "reverse the robot");

                                    cmdevent.ExecuteNonQuery();

                                    con.Close();

                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image.Tag = "picrobotbotton";
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotbotton" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);
                                    /////////////////////////////////////////////////////////////////////////////////////開始掃描Wafers

                                    picMain.Image = Properties.Resources.picrobotanalysis;
                                    picMain.Image.Tag = "picrobotanalysis";

                                    lblLoad.Text = "Loading";
                                    lblLoad.BackColor = Color.LimeGreen;
                                    lblmTorr.BackColor = Color.LimeGreen;
                                    str123 = lot.getLotID();
                                    lbl123.Text = lot.getLotID();
                                    lbl123.BackColor = Color.LimeGreen;
                                    lblCassetteRecipename.Text = form2Msg;
                                    lblCassetteRecipename.BackColor = Color.LimeGreen;
                                    lblState.Text = "Starting";
                                    lblState.BackColor = Color.LimeGreen;
                                    label1.BackColor = Color.LimeGreen;
                                    //  label1.Text = "Analysising.....";
                                    // label1.Font = new Font("微軟正黑體", 10);

                                    await Task.Delay(1000);

                                    picmap.Visible = true;

                                    for (int i = 1; i <= 24; i++)
                                    {
                                        await Task.Delay(50);
                                        picmap.Top -= 13;
                                    }

                                    picmap.Visible = false;

                                    picmap.Top += 312;

                                    await Task.Delay(1000);

                                  picmap1.Visible = true;
                                    for (int j = 1; j <= 24; j++)
                                    {
                                        await Task.Delay(50);
                                      picmap1.Top += 13;
                                    }
                                   picmap1.Visible = false;
                                   picmap1.Top -= 312;
                                    await Task.Delay(1000);



                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotanalysis" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    label1.Text = "";
                                    picMain.Image.Tag = "picrobotbotton2";

                                    //    picwafer.Image = Properties.Resources.waferfull;
                                    //  picwafer.Image.Tag = "waferfull";

                                    foreach (string i in NoOfwafer)
                                    {
                                        if (i == "1")
                                        {

                                            //  picwafer.Image = Properties.Resources.waferA1full;
                                            picWafer1.Visible = false;
                                            picWafer2.Visible = false;
                                            picWafer3.Visible = false;
                                            picWafer4.Visible = false;
                                            picWafer5.Visible = false;
                                            picWafer6.Visible = false;
                                            picWafer7.Visible = false;
                                            picWafer8.Visible = false;
                                            picWafer9.Visible = false;
                                            picWafer10.Visible = false;
                                            picWafer11.Visible = false;
                                            picWafer12.Visible = false;
                                            picWafer13.Visible = false;
                                            picWafer14.Visible = false;
                                            picWafer15.Visible = false;
                                            picWafer16.Visible = false;
                                            picWafer17.Visible = false;
                                            picWafer18.Visible = false;
                                            picWafer19.Visible = false;
                                            picWafer20.Visible = false;
                                            picWafer21.Visible = false;
                                            picWafer22.Visible = false;
                                            picWafer23.Visible = false;
                                            picWafer24.Visible = false;
                                            picWafer25.Visible = false;



                                            picWafer1.Visible = true;

                                        }

                                        else if (i == "2")
                                        {
                                            //    picwafer.Image = Properties.Resources.waferA2full;
                                            picWafer1.Visible = false;
                                            picWafer2.Visible = false;
                                            picWafer3.Visible = false;
                                            picWafer4.Visible = false;
                                            picWafer5.Visible = false;
                                            picWafer6.Visible = false;
                                            picWafer7.Visible = false;
                                            picWafer8.Visible = false;
                                            picWafer9.Visible = false;
                                            picWafer10.Visible = false;
                                            picWafer11.Visible = false;
                                            picWafer12.Visible = false;
                                            picWafer13.Visible = false;
                                            picWafer14.Visible = false;
                                            picWafer15.Visible = false;
                                            picWafer16.Visible = false;
                                            picWafer17.Visible = false;
                                            picWafer18.Visible = false;
                                            picWafer19.Visible = false;
                                            picWafer20.Visible = false;
                                            picWafer21.Visible = false;
                                            picWafer22.Visible = false;
                                            picWafer23.Visible = false;
                                            picWafer24.Visible = false;
                                            picWafer25.Visible = false;


                                            picWafer1.Visible = true;
                                            picWafer2.Visible = true;

                                        }

                                        else if (i == "3")
                                        {
                                            // picwafer.Image = Properties.Resources.waferA3full;
                                            picWafer1.Visible = false;
                                            picWafer2.Visible = false;
                                            picWafer3.Visible = false;
                                            picWafer4.Visible = false;
                                            picWafer5.Visible = false;
                                            picWafer6.Visible = false;
                                            picWafer7.Visible = false;
                                            picWafer8.Visible = false;
                                            picWafer9.Visible = false;
                                            picWafer10.Visible = false;
                                            picWafer11.Visible = false;
                                            picWafer12.Visible = false;
                                            picWafer13.Visible = false;
                                            picWafer14.Visible = false;
                                            picWafer15.Visible = false;
                                            picWafer16.Visible = false;
                                            picWafer17.Visible = false;
                                            picWafer18.Visible = false;
                                            picWafer19.Visible = false;
                                            picWafer20.Visible = false;
                                            picWafer21.Visible = false;
                                            picWafer22.Visible = false;
                                            picWafer23.Visible = false;
                                            picWafer24.Visible = false;
                                            picWafer25.Visible = false;




                                            picWafer1.Visible = true;
                                            picWafer2.Visible = true;
                                            picWafer3.Visible = true;
                                        }
                                        else if (i == "4")
                                        {
                                            //picwafer.Image = Properties.Resources.waferA4full;
                                            picWafer1.Visible = false;
                                            picWafer2.Visible = false;
                                            picWafer3.Visible = false;
                                            picWafer4.Visible = false;
                                            picWafer5.Visible = false;
                                            picWafer6.Visible = false;
                                            picWafer7.Visible = false;
                                            picWafer8.Visible = false;
                                            picWafer9.Visible = false;
                                            picWafer10.Visible = false;
                                            picWafer11.Visible = false;
                                            picWafer12.Visible = false;
                                            picWafer13.Visible = false;
                                            picWafer14.Visible = false;
                                            picWafer15.Visible = false;
                                            picWafer16.Visible = false;
                                            picWafer17.Visible = false;
                                            picWafer18.Visible = false;
                                            picWafer19.Visible = false;
                                            picWafer20.Visible = false;
                                            picWafer21.Visible = false;
                                            picWafer22.Visible = false;
                                            picWafer23.Visible = false;
                                            picWafer24.Visible = false;
                                            picWafer25.Visible = false;



                                            picWafer1.Visible = true;
                                            picWafer2.Visible = true;
                                            picWafer3.Visible = true;
                                            picWafer4.Visible = true;
                                        }
                                        else if (i == "5")
                                        {
                                            // picwafer.Image = Properties.Resources.waferA5full;
                                            picWafer1.Visible = false;
                                            picWafer2.Visible = false;
                                            picWafer3.Visible = false;
                                            picWafer4.Visible = false;
                                            picWafer5.Visible = false;
                                            picWafer6.Visible = false;
                                            picWafer7.Visible = false;
                                            picWafer8.Visible = false;
                                            picWafer9.Visible = false;
                                            picWafer10.Visible = false;
                                            picWafer11.Visible = false;
                                            picWafer12.Visible = false;
                                            picWafer13.Visible = false;
                                            picWafer14.Visible = false;
                                            picWafer15.Visible = false;
                                            picWafer16.Visible = false;
                                            picWafer17.Visible = false;
                                            picWafer18.Visible = false;
                                            picWafer19.Visible = false;
                                            picWafer20.Visible = false;
                                            picWafer21.Visible = false;
                                            picWafer22.Visible = false;
                                            picWafer23.Visible = false;
                                            picWafer24.Visible = false;
                                            picWafer25.Visible = false;




                                            picWafer1.Visible = true;
                                            picWafer2.Visible = true;
                                            picWafer3.Visible = true;
                                            picWafer4.Visible = true;
                                            picWafer5.Visible = true;
                                        }
                                        else if (i == "6")
                                        {
                                            //  picwafer.Image = Properties.Resources.waferA6full;
                                            picWafer1.Visible = false;
                                            picWafer2.Visible = false;
                                            picWafer3.Visible = false;
                                            picWafer4.Visible = false;
                                            picWafer5.Visible = false;
                                            picWafer6.Visible = false;
                                            picWafer7.Visible = false;
                                            picWafer8.Visible = false;
                                            picWafer9.Visible = false;
                                            picWafer10.Visible = false;
                                            picWafer11.Visible = false;
                                            picWafer12.Visible = false;
                                            picWafer13.Visible = false;
                                            picWafer14.Visible = false;
                                            picWafer15.Visible = false;
                                            picWafer16.Visible = false;
                                            picWafer17.Visible = false;
                                            picWafer18.Visible = false;
                                            picWafer19.Visible = false;
                                            picWafer20.Visible = false;
                                            picWafer21.Visible = false;
                                            picWafer22.Visible = false;
                                            picWafer23.Visible = false;
                                            picWafer24.Visible = false;
                                            picWafer25.Visible = false;





                                            picWafer1.Visible = true;
                                            picWafer2.Visible = true;
                                            picWafer3.Visible = true;
                                            picWafer4.Visible = true;
                                            picWafer5.Visible = true;
                                            picWafer6.Visible = true;
                                        }
                                        else if (i == "7")
                                        {

                                            // picwafer.Image = Properties.Resources.waferA7full;

                                            picWafer1.Visible = false;
                                            picWafer2.Visible = false;
                                            picWafer3.Visible = false;
                                            picWafer4.Visible = false;
                                            picWafer5.Visible = false;
                                            picWafer6.Visible = false;
                                            picWafer7.Visible = false;
                                            picWafer8.Visible = false;
                                            picWafer9.Visible = false;
                                            picWafer10.Visible = false;
                                            picWafer11.Visible = false;
                                            picWafer12.Visible = false;
                                            picWafer13.Visible = false;
                                            picWafer14.Visible = false;
                                            picWafer15.Visible = false;
                                            picWafer16.Visible = false;
                                            picWafer17.Visible = false;
                                            picWafer18.Visible = false;
                                            picWafer19.Visible = false;
                                            picWafer20.Visible = false;
                                            picWafer21.Visible = false;
                                            picWafer22.Visible = false;
                                            picWafer23.Visible = false;
                                            picWafer24.Visible = false;
                                            picWafer25.Visible = false;




                                            picWafer1.Visible = true;
                                            picWafer2.Visible = true;
                                            picWafer3.Visible = true;
                                            picWafer4.Visible = true;
                                            picWafer5.Visible = true;
                                            picWafer6.Visible = true;
                                            picWafer7.Visible = true;
                                        }
                                        else if (i == "8")
                                        {

                                            // picwafer.Image = Properties.Resources.waferA8full;
                                            picWafer1.Visible = false;
                                            picWafer2.Visible = false;
                                            picWafer3.Visible = false;
                                            picWafer4.Visible = false;
                                            picWafer5.Visible = false;
                                            picWafer6.Visible = false;
                                            picWafer7.Visible = false;
                                            picWafer8.Visible = false;
                                            picWafer9.Visible = false;
                                            picWafer10.Visible = false;
                                            picWafer11.Visible = false;
                                            picWafer12.Visible = false;
                                            picWafer13.Visible = false;
                                            picWafer14.Visible = false;
                                            picWafer15.Visible = false;
                                            picWafer16.Visible = false;
                                            picWafer17.Visible = false;
                                            picWafer18.Visible = false;
                                            picWafer19.Visible = false;
                                            picWafer20.Visible = false;
                                            picWafer21.Visible = false;
                                            picWafer22.Visible = false;
                                            picWafer23.Visible = false;
                                            picWafer24.Visible = false;
                                            picWafer25.Visible = false;




                                            picWafer1.Visible = true;
                                            picWafer2.Visible = true;
                                            picWafer3.Visible = true;
                                            picWafer4.Visible = true;
                                            picWafer5.Visible = true;
                                            picWafer6.Visible = true;
                                            picWafer7.Visible = true;
                                            picWafer8.Visible = true;

                                        }
                                        else if (i == "9")
                                        {
                                            //  picwafer.Image = Properties.Resources.waferA9full;
                                            picWafer1.Visible = false;
                                            picWafer2.Visible = false;
                                            picWafer3.Visible = false;
                                            picWafer4.Visible = false;
                                            picWafer5.Visible = false;
                                            picWafer6.Visible = false;
                                            picWafer7.Visible = false;
                                            picWafer8.Visible = false;
                                            picWafer9.Visible = false;
                                            picWafer10.Visible = false;
                                            picWafer11.Visible = false;
                                            picWafer12.Visible = false;
                                            picWafer13.Visible = false;
                                            picWafer14.Visible = false;
                                            picWafer15.Visible = false;
                                            picWafer16.Visible = false;
                                            picWafer17.Visible = false;
                                            picWafer18.Visible = false;
                                            picWafer19.Visible = false;
                                            picWafer20.Visible = false;
                                            picWafer21.Visible = false;
                                            picWafer22.Visible = false;
                                            picWafer23.Visible = false;
                                            picWafer24.Visible = false;
                                            picWafer25.Visible = false;




                                            picWafer1.Visible = true;
                                            picWafer2.Visible = true;
                                            picWafer3.Visible = true;
                                            picWafer4.Visible = true;
                                            picWafer5.Visible = true;
                                            picWafer6.Visible = true;
                                            picWafer7.Visible = true;
                                            picWafer8.Visible = true;
                                            picWafer9.Visible = true;
                                        }
                                        else if (i == "10")
                                        {
                                            // picwafer.Image = Properties.Resources.waferA10full;
                                            picWafer1.Visible = false;
                                            picWafer2.Visible = false;
                                            picWafer3.Visible = false;
                                            picWafer4.Visible = false;
                                            picWafer5.Visible = false;
                                            picWafer6.Visible = false;
                                            picWafer7.Visible = false;
                                            picWafer8.Visible = false;
                                            picWafer9.Visible = false;
                                            picWafer10.Visible = false;
                                            picWafer11.Visible = false;
                                            picWafer12.Visible = false;
                                            picWafer13.Visible = false;
                                            picWafer14.Visible = false;
                                            picWafer15.Visible = false;
                                            picWafer16.Visible = false;
                                            picWafer17.Visible = false;
                                            picWafer18.Visible = false;
                                            picWafer19.Visible = false;
                                            picWafer20.Visible = false;
                                            picWafer21.Visible = false;
                                            picWafer22.Visible = false;
                                            picWafer23.Visible = false;
                                            picWafer24.Visible = false;
                                            picWafer25.Visible = false;





                                            picWafer1.Visible = true;
                                            picWafer2.Visible = true;
                                            picWafer3.Visible = true;
                                            picWafer4.Visible = true;
                                            picWafer5.Visible = true;
                                            picWafer6.Visible = true;
                                            picWafer7.Visible = true;
                                            picWafer8.Visible = true;
                                            picWafer9.Visible = true;
                                            picWafer10.Visible = true;


                                        }

                                    }


                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotbotton2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    // pictRobot.Visible = true;
                                    // picCassette.Image = Properties.Resources.cassette1;
                                    // picCassette.Height -= 150;
                                    // picCassette.Top += 150;
                                    lblCassette.BackColor = Color.Blue;
                                    lblCassette.Tag = "Blue";
                                    // lblCassette.Text = "Cassette";

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotbotton2" && lblCassette.Tag.ToString() == "Blue" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    //pictRobot.Image = Properties.Resources.new_robot;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "mainpicture2";

                                }
                                //  await Task.Delay(1000);

                                //   picCassette.Image = Properties.Resources.cassette3;//open cassette
                                // picMain.Image = Properties.Resources.mainpicCassetteopen;  
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "mainpicture2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassette";
                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;

                                    picCassette.Width += 25;
                                    picCassette.Height += 220;
                                    picCassette.Top -= 205;
                                    picCassette.Image.Tag = "robot_into_cassetteA1";
                                    picCassette.Left += 5;
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;
                                }


                                await Task.Delay(1000);

                                for (int i = 0; i < NoOfwafer.Count; i++)

                                {


                                    if (int.Parse(NoOfwafer[i]) >= 1)
                                    {
                                        /////////////////////////////////////////////////////////start WaferA1

                                        nooftherecipe = "1";

                                   
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassette" && iscancelrecipe == false)
                                        {
                                            picCassette.Image = Properties.Resources.cassette;
                                            await Task.Delay(1000);
                                            if (NoOfwafer[i] == "1")
                                            {
                                                // picwafer.Image = Properties.Resources.wafer;
                                                // picwafer.Image.Tag = "wafer";
                                                picWafer1.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.wafermapA2;
                                                picWafer1.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA3fullA1;
                                                picWafer1.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA4fullA1;
                                                picWafer1.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA5fullA1;
                                                picWafer1.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "6")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA5fullA1;
                                                picWafer1.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "7")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA5fullA1;
                                                picWafer1.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "8")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA5fullA1;
                                                picWafer1.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "9")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA5fullA1;
                                                picWafer1.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "10")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA5fullA1;
                                                picWafer1.Visible = false;
                                            }


                                            StartTime = DateTime.Now;


                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "1");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("Logname", lbl123.Text);
                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();












                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA1";
                                            // panel1.Visible = true;
                                            //  ovalShape1.Visible = true;
                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A1";
                                            lblCassette.BackColor = Color.Blue;

                                            picCassette.Image = Properties.Resources.cassette3;

                                            // picMain.Image = Properties.Resources.mainpicCassetteopen;
                                            picCassette.Height -= 220;
                                            picCassette.Width -= 25;
                                            picCassette.Top += 205;
                                            picCassette.Image.Tag = "cassette";
                                            picCassette.Left -= 5;
                                            //  await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA1" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);



                                            // pictRobot.Image = Properties.Resources.robotleft_A1;
                                            //   picMain.Image = Properties.Resources.picrobotcentralized;
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA1";
                                            //  ovalShape1.Visible = true;
                                            // lblwafer.Visible = true;
                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A1";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;
                                            // panel1.Visible = false;



                                            //   await Task.Delay(2000);
                                            //  picCentralize.Image = Properties.Resources.centralize2;//open centralize
                                            //  picMain.Image = Properties.Resources.robotleftA1opencentralize;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA1" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);






                                            // picCentralize.Image = Properties.Resources.robot_into_centralizeA1;

                                            //  picMain.Image = Properties.Resources.picrobotintocentralized;
                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA1";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A1";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA1" && iscancelrecipe == false)
                                        {
                                            ////////////////////////////////////////////////////////////////////////////////////
                                            await Task.Delay(2000);
                                            // pictRobot.Visible = true;
                                            // picCentralize.Image = Properties.Resources.centralize2;
                                            // picMain.Image = Properties.Resources.picrobotcentralized;
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA1-2";
                                            // ovalShape1.Visible = true;
                                            //picwafer.Visible = true;
                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A1";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;

                                            // await Task.Delay(2000);
                                            // picCentralize.Image = Properties.Resources.centralize;//close centralize
                                            // picMain.Image = Properties.Resources.robotleftA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA1-2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            //   picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA1";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A1";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;



                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA1" && picSV.Visible == true && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            // picChamber.Image = Properties.Resources.new_chamber1;//open chamber
                                            // picMain.Image = Properties.Resources.robotrightA1openchamber;
                                            picSV.Visible = false;  // open sv of chamber

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA1" && picSV.Visible == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            //pictRobot.Visible = false;
                                            //picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            //  picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA1";
                                            // picChamber.Width += 140;
                                            //picChamber.Left -= 150;
                                            //picChamber.Height += 10;
                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A1";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";

                                            // loaddata();
                                            // loadchamber1( sender, e);
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA1" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA1";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA1" && picSV.Visible == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA1 into Chamber
                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.form1 = this;
                                            chamber1.ShowDialog();

                                           lblRecipe.BackColor = Color.LimeGreen;
                                           lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {


                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                           //     await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                               //     await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,Logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", nooftherecipe);
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                              //  cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                                //  Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate,logid,NoOfRecipe) values(@11,@21,@31,@41,@51,@61,@71,@81,@91,@101),(@12,@22,@32,@42,@52,@62,@72,@82,@92,@102),(@13,@23,@33,@43,@53,@63,@73,@83,@93,@103)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84,@94,@104),(@15,@25,@35,@45,@55,@65,@75,@85,@95,@105),(@16,@26,@36,@46,@56,@66,@76,@86,@96,@106),(@17,@27,@37,@47,@57,@67,@77,@87,@97,@107),(@18,@28,@38,@48,@58,@68,@78,@88,@98,@108)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@91", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@92", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@93", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@94", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@95", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@96", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@97", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@98", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@101", nooftherecipe);
                                                cmdparameter.Parameters.AddWithValue("@102", nooftherecipe);
                                                cmdparameter.Parameters.AddWithValue("@103", nooftherecipe);
                                                cmdparameter.Parameters.AddWithValue("@104", nooftherecipe);
                                                cmdparameter.Parameters.AddWithValue("@105", nooftherecipe);
                                                cmdparameter.Parameters.AddWithValue("@106", nooftherecipe);
                                                cmdparameter.Parameters.AddWithValue("@107", nooftherecipe);
                                                cmdparameter.Parameters.AddWithValue("@108", nooftherecipe);


                                             //   cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }





                                            picMain.Image.Tag = "A1finishChamber";

                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "A1finishChamber" && picSV.Visible == true)
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "A1finishChamber" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA1-2";

                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA1-2")
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA1-2";
                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A1";
                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA1-2" && picSV.Visible == false&&iscancelrecipe==false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA1-2" && picSV.Visible == true&&iscancelrecipe==false)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA1-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA1-2"&&iscancelrecipe==false)
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassette2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassette2"&&iscancelrecipe==false)
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "mainpicture3";
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "mainpicture3"&&iscancelrecipe==false)
                                        {
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            //   picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {

                                                //   picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = false;
                                                picWafer2.Visible = false;
                                                picWafer3.Visible = false;
                                                picWafer4.Visible = false;
                                                picWafer5.Visible = false;
                                                picWafer6.Visible = false;
                                                picWafer7.Visible = false;
                                                picWafer8.Visible = false;
                                                picWafer9.Visible = false;
                                                picWafer10.Visible = false;
                                                picWafer11.Visible = false;
                                                picWafer12.Visible = false;
                                                picWafer13.Visible = false;
                                                picWafer14.Visible = false;
                                                picWafer15.Visible = false;
                                                picWafer16.Visible = false;
                                                picWafer17.Visible = false;
                                                picWafer18.Visible = false;
                                                picWafer19.Visible = false;
                                                picWafer20.Visible = false;
                                                picWafer21.Visible = false;
                                                picWafer22.Visible = false;
                                                picWafer23.Visible = false;
                                                picWafer24.Visible = false;
                                                picWafer25.Visible = false;



                                                picWafer1.Visible = true;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;

                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = false;
                                                picWafer2.Visible = false;
                                                picWafer3.Visible = false;
                                                picWafer4.Visible = false;
                                                picWafer5.Visible = false;
                                                picWafer6.Visible = false;
                                                picWafer7.Visible = false;
                                                picWafer8.Visible = false;
                                                picWafer9.Visible = false;
                                                picWafer10.Visible = false;
                                                picWafer11.Visible = false;
                                                picWafer12.Visible = false;
                                                picWafer13.Visible = false;
                                                picWafer14.Visible = false;
                                                picWafer15.Visible = false;
                                                picWafer16.Visible = false;
                                                picWafer17.Visible = false;
                                                picWafer18.Visible = false;
                                                picWafer19.Visible = false;
                                                picWafer20.Visible = false;
                                                picWafer21.Visible = false;
                                                picWafer22.Visible = false;
                                                picWafer23.Visible = false;
                                                picWafer24.Visible = false;
                                                picWafer25.Visible = false;




                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                //   picwafer.Image = Properties.Resources.waferA3full;

                                                picWafer1.Visible = false;
                                                picWafer2.Visible = false;
                                                picWafer3.Visible = false;
                                                picWafer4.Visible = false;
                                                picWafer5.Visible = false;
                                                picWafer6.Visible = false;
                                                picWafer7.Visible = false;
                                                picWafer8.Visible = false;
                                                picWafer9.Visible = false;
                                                picWafer10.Visible = false;
                                                picWafer11.Visible = false;
                                                picWafer12.Visible = false;
                                                picWafer13.Visible = false;
                                                picWafer14.Visible = false;
                                                picWafer15.Visible = false;
                                                picWafer16.Visible = false;
                                                picWafer17.Visible = false;
                                                picWafer18.Visible = false;
                                                picWafer19.Visible = false;
                                                picWafer20.Visible = false;
                                                picWafer21.Visible = false;
                                                picWafer22.Visible = false;
                                                picWafer23.Visible = false;
                                                picWafer24.Visible = false;
                                                picWafer25.Visible = false;



                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = false;
                                                picWafer2.Visible = false;
                                                picWafer3.Visible = false;
                                                picWafer4.Visible = false;
                                                picWafer5.Visible = false;
                                                picWafer6.Visible = false;
                                                picWafer7.Visible = false;
                                                picWafer8.Visible = false;
                                                picWafer9.Visible = false;
                                                picWafer10.Visible = false;
                                                picWafer11.Visible = false;
                                                picWafer12.Visible = false;
                                                picWafer13.Visible = false;
                                                picWafer14.Visible = false;
                                                picWafer15.Visible = false;
                                                picWafer16.Visible = false;
                                                picWafer17.Visible = false;
                                                picWafer18.Visible = false;
                                                picWafer19.Visible = false;
                                                picWafer20.Visible = false;
                                                picWafer21.Visible = false;
                                                picWafer22.Visible = false;
                                                picWafer23.Visible = false;
                                                picWafer24.Visible = false;
                                                picWafer25.Visible = false;



                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;

                                                picWafer1.Visible = false;
                                                picWafer2.Visible = false;
                                                picWafer3.Visible = false;
                                                picWafer4.Visible = false;
                                                picWafer5.Visible = false;
                                                picWafer6.Visible = false;
                                                picWafer7.Visible = false;
                                                picWafer8.Visible = false;
                                                picWafer9.Visible = false;
                                                picWafer10.Visible = false;
                                                picWafer11.Visible = false;
                                                picWafer12.Visible = false;
                                                picWafer13.Visible = false;
                                                picWafer14.Visible = false;
                                                picWafer15.Visible = false;
                                                picWafer16.Visible = false;
                                                picWafer17.Visible = false;
                                                picWafer18.Visible = false;
                                                picWafer19.Visible = false;
                                                picWafer20.Visible = false;
                                                picWafer21.Visible = false;
                                                picWafer22.Visible = false;
                                                picWafer23.Visible = false;
                                                picWafer24.Visible = false;
                                                picWafer25.Visible = false;



                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                            }


                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 1)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();


                                                lblState.Text = "Finished";

                                               

                                            }

                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;

                                                lblState.Text = "stopping";
                                            }

                                            picMain.Image.Tag = "finishWaferA1";
                                           

                                        }

                                        /////////////////////////////////////////////////////////finish waferA1
                                    }












                                    if (int.Parse(NoOfwafer[i]) >= 2)
                                    {
                                        nooftherecipe = "2";
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA1"&&isStopRobot==false&&iscancelrecipe==false)
                                        {
                                            /////////////////////////////////////////////////////////start WaferA2
                                            lblState.Text = "starting";

                                            await Task.Delay(1000);
                                        

                                            //pictRobot.Image = Properties.Resources.new_robot;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "A2mainpicture";
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "A2mainpicture")
                                        {
                                            await Task.Delay(1000);

                                            //   picCassette.Image = Properties.Resources.cassette3;//open cassette
                                            // picMain.Image = Properties.Resources.mainpicCassetteopen;  
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA2";
                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;

                                            picCassette.Width += 25;
                                            picCassette.Height += 220;
                                            picCassette.Top -= 205;
                                            picCassette.Image.Tag = "robot_into_cassetteA1";
                                            picCassette.Left += 5;
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;
                                            await Task.Delay(1000);
                                            

                                            picCassette.Image = Properties.Resources.cassette;
                                            await Task.Delay(1000);

                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.wafer;
                                                //picwafer.Image.Tag = "wafer";
                                                picWafer2.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA1full;

                                                picWafer2.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                //   picwafer.Image = Properties.Resources.waferA3fullA2;
                                                picWafer2.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA4fullA2;
                                                picWafer2.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA5fullA2;
                                                picWafer2.Visible = false;
                                            }

                                            StartTime = DateTime.Now;


                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "2");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);
                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA2"&&iscancelrecipe==false)
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA2";
                                            // panel1.Visible = true;
                                            //  ovalShape1.Visible = true;
                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A2";
                                            lblCassette.BackColor = Color.Blue;

                                            picCassette.Image = Properties.Resources.cassette3;

                                            // picMain.Image = Properties.Resources.mainpicCassetteopen;
                                            picCassette.Height -= 220;
                                            picCassette.Width -= 25;
                                            picCassette.Top += 205;
                                            picCassette.Image.Tag = "cassette";
                                            picCassette.Left -= 5;
                                            //  await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA2")
                                        {
                                            await Task.Delay(1000);

                                            

                                            // pictRobot.Image = Properties.Resources.robotleft_A1;
                                            //   picMain.Image = Properties.Resources.picrobotcentralized;
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA2";
                                            //  ovalShape1.Visible = true;
                                            // lblwafer.Visible = true;
                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A2";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;
                                            // panel1.Visible = false;



                                            //   await Task.Delay(2000);
                                            //  picCentralize.Image = Properties.Resources.centralize2;//open centralize
                                            //  picMain.Image = Properties.Resources.robotleftA1opencentralize;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            
                                            



                                            // picCentralize.Image = Properties.Resources.robot_into_centralizeA1;

                                            //  picMain.Image = Properties.Resources.picrobotintocentralized;
                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA2";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A2";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA2" && iscancelrecipe == false)
                                        {
                                            ////////////////////////////////////////////////////////////////////////////////////
                                            await Task.Delay(2000);
                                            // pictRobot.Visible = true;
                                            // picCentralize.Image = Properties.Resources.centralize2;
                                            // picMain.Image = Properties.Resources.picrobotcentralized;
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA2-2";
                                            // ovalShape1.Visible = true;
                                            //picwafer.Visible = true;
                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A2";

                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;

                                            // await Task.Delay(2000);
                                            // picCentralize.Image = Properties.Resources.centralize;//close centralize
                                            // picMain.Image = Properties.Resources.robotleftA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA2-2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            //   picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA2";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A2";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;



                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA2" && picSV.Visible == true && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            // picChamber.Image = Properties.Resources.new_chamber1;//open chamber
                                            // picMain.Image = Properties.Resources.robotrightA1openchamber;
                                            picSV.Visible = false;  // open sv of chamber
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA2" && picSV.Visible == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            //pictRobot.Visible = false;
                                            //picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            //  picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA2";
                                            // picChamber.Width += 140;
                                            //picChamber.Left -= 150;
                                            //picChamber.Height += 10;
                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A2";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";

                                            // loaddata();
                                            // loadchamber1( sender, e);
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA2";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA2" && picSV.Visible == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA2 into Chamber

                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.form1 = this;
                                            chamber1.ShowDialog();
                                         
                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                               // await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                //    await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,Logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "2");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);
                                               // cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();

                                             //   Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate,logid,noofrecipe) values(@11,@21,@31,@41,@51,@61,@71,@81,@91,@101),(@12,@22,@32,@42,@52,@62,@72,@82,@92,@102),(@13,@23,@33,@43,@53,@63,@73,@83,@93,@103)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84,@94,@104),(@15,@25,@35,@45,@55,@65,@75,@85,@95,@105),(@16,@26,@36,@46,@56,@66,@76,@86,@96,@106),(@17,@27,@37,@47,@57,@67,@77,@87,@97,@107),(@18,@28,@38,@48,@58,@68,@78,@88,@98,@108)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@91", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@92", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@93", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@94", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@95", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@96", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@97", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@98", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@101","2");
                                                cmdparameter.Parameters.AddWithValue("@102","2");
                                                cmdparameter.Parameters.AddWithValue("@103","2");
                                                cmdparameter.Parameters.AddWithValue("@104","2");
                                                cmdparameter.Parameters.AddWithValue("@105","2");
                                                cmdparameter.Parameters.AddWithValue("@106","2");
                                                cmdparameter.Parameters.AddWithValue("@107","2");
                                                cmdparameter.Parameters.AddWithValue("@108","2");
                                              //  cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }











                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA2" && picSV.Visible == true && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                            picMain.Image.Tag = "waferA2finishChamber";
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA2finishChamber" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA2-2";
                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA2-2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA2-2";
                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA2-2" && picSV.Visible == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA2-2" && picSV.Visible == true && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA2-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA2-2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "A2picrobotintocassette2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "A2picrobotintocassette2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            //  picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = false;
                                                picWafer2.Visible = false;
                                                picWafer3.Visible = false;
                                                picWafer4.Visible = false;
                                                picWafer5.Visible = false;
                                                picWafer6.Visible = false;
                                                picWafer7.Visible = false;
                                                picWafer8.Visible = false;
                                                picWafer9.Visible = false;
                                                picWafer10.Visible = false;
                                                picWafer11.Visible = false;
                                                picWafer12.Visible = false;
                                                picWafer13.Visible = false;
                                                picWafer14.Visible = false;
                                                picWafer15.Visible = false;
                                                picWafer16.Visible = false;
                                                picWafer17.Visible = false;
                                                picWafer18.Visible = false;
                                                picWafer19.Visible = false;
                                                picWafer20.Visible = false;
                                                picWafer21.Visible = false;
                                                picWafer22.Visible = false;
                                                picWafer23.Visible = false;
                                                picWafer24.Visible = false;
                                                picWafer25.Visible = false;

                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;

                                                picWafer1.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = false;
                                                picWafer2.Visible = false;
                                                picWafer3.Visible = false;
                                                picWafer4.Visible = false;
                                                picWafer5.Visible = false;
                                                picWafer6.Visible = false;
                                                picWafer7.Visible = false;
                                                picWafer8.Visible = false;
                                                picWafer9.Visible = false;
                                                picWafer10.Visible = false;
                                                picWafer11.Visible = false;
                                                picWafer12.Visible = false;
                                                picWafer13.Visible = false;
                                                picWafer14.Visible = false;
                                                picWafer15.Visible = false;
                                                picWafer16.Visible = false;
                                                picWafer17.Visible = false;
                                                picWafer18.Visible = false;
                                                picWafer19.Visible = false;
                                                picWafer20.Visible = false;
                                                picWafer21.Visible = false;
                                                picWafer22.Visible = false;
                                                picWafer23.Visible = false;
                                                picWafer24.Visible = false;
                                                picWafer25.Visible = false;


                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer1.Visible = false;
                                                picWafer2.Visible = false;
                                                picWafer3.Visible = false;
                                                picWafer4.Visible = false;
                                                picWafer5.Visible = false;
                                                picWafer6.Visible = false;
                                                picWafer7.Visible = false;
                                                picWafer8.Visible = false;
                                                picWafer9.Visible = false;
                                                picWafer10.Visible = false;
                                                picWafer11.Visible = false;
                                                picWafer12.Visible = false;
                                                picWafer13.Visible = false;
                                                picWafer14.Visible = false;
                                                picWafer15.Visible = false;
                                                picWafer16.Visible = false;
                                                picWafer17.Visible = false;
                                                picWafer18.Visible = false;
                                                picWafer19.Visible = false;
                                                picWafer20.Visible = false;
                                                picWafer21.Visible = false;
                                                picWafer22.Visible = false;
                                                picWafer23.Visible = false;
                                                picWafer24.Visible = false;
                                                picWafer25.Visible = false;

                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;


                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = false;
                                                picWafer2.Visible = false;
                                                picWafer3.Visible = false;
                                                picWafer4.Visible = false;
                                                picWafer5.Visible = false;
                                                picWafer6.Visible = false;
                                                picWafer7.Visible = false;
                                                picWafer8.Visible = false;
                                                picWafer9.Visible = false;
                                                picWafer10.Visible = false;
                                                picWafer11.Visible = false;
                                                picWafer12.Visible = false;
                                                picWafer13.Visible = false;
                                                picWafer14.Visible = false;
                                                picWafer15.Visible = false;
                                                picWafer16.Visible = false;
                                                picWafer17.Visible = false;
                                                picWafer18.Visible = false;
                                                picWafer19.Visible = false;
                                                picWafer20.Visible = false;
                                                picWafer21.Visible = false;
                                                picWafer22.Visible = false;
                                                picWafer23.Visible = false;
                                                picWafer24.Visible = false;
                                                picWafer25.Visible = false;

                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;


                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = false;
                                                picWafer2.Visible = false;
                                                picWafer3.Visible = false;
                                                picWafer4.Visible = false;
                                                picWafer5.Visible = false;
                                                picWafer6.Visible = false;
                                                picWafer7.Visible = false;
                                                picWafer8.Visible = false;
                                                picWafer9.Visible = false;
                                                picWafer10.Visible = false;
                                                picWafer11.Visible = false;
                                                picWafer12.Visible = false;
                                                picWafer13.Visible = false;
                                                picWafer14.Visible = false;
                                                picWafer15.Visible = false;
                                                picWafer16.Visible = false;
                                                picWafer17.Visible = false;
                                                picWafer18.Visible = false;
                                                picWafer19.Visible = false;
                                                picWafer20.Visible = false;
                                                picWafer21.Visible = false;
                                                picWafer22.Visible = false;
                                                picWafer23.Visible = false;
                                                picWafer24.Visible = false;
                                                picWafer25.Visible = false;

                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;


                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                            }

                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 2)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();



                                                lblState.Text = "Finished";
                                              

                                               

                                            }

                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;
                                                lblState.Text = "Stopping";
                                            }
                                            picMain.Image.Tag = "finishWaferA2";
                                        }
                                        /////////////////////////////////////////////////////////finish waferA2
                                    }












                                    if (int.Parse(NoOfwafer[i]) >= 3)
                                    {
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA2"&&isStopRobot==false && iscancelrecipe == false)
                                        {
                                            /////////////////////////////////////////////////////////start WaferA3
                                            nooftherecipe = "3";
                                            
                                            await Task.Delay(1000);

                                            //pictRobot.Image = Properties.Resources.new_robot;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "A3mainpicture";
                                            await Task.Delay(1000);

                                            //   picCassette.Image = Properties.Resources.cassette3;//open cassette
                                            // picMain.Image = Properties.Resources.mainpicCassetteopen;  
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "A3mainpicture" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA3";
                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;

                                            picCassette.Width += 25;
                                            picCassette.Height += 220;
                                            picCassette.Top -= 205;
                                            picCassette.Image.Tag = "robot_into_cassetteA1";
                                            picCassette.Left += 5;
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA3" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);




                                            picCassette.Image = Properties.Resources.cassette;
                                            await Task.Delay(1000);

                                            if (NoOfwafer[i] == "1")
                                            {
                                                // picwafer.Image = Properties.Resources.wafer;
                                                //  picwafer.Image.Tag = "wafer";
                                                picWafer3.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer3.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer3.Visible = false;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA4fullA3;
                                                picWafer3.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                //   picwafer.Image = Properties.Resources.waferA5fullA3;
                                                picWafer3.Visible = false;
                                            }

                                            StartTime = DateTime.Now;


                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "3");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);
                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();




                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA3";
                                            // panel1.Visible = true;
                                            //  ovalShape1.Visible = true;
                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A3";

                                            lblCassette.BackColor = Color.Blue;

                                            picCassette.Image = Properties.Resources.cassette3;

                                            // picMain.Image = Properties.Resources.mainpicCassetteopen;
                                            picCassette.Height -= 220;
                                            picCassette.Width -= 25;
                                            picCassette.Top += 205;
                                            picCassette.Image.Tag = "cassette";
                                            picCassette.Left -= 5;
                                            //  await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA3" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);



                                            // pictRobot.Image = Properties.Resources.robotleft_A1;
                                            //   picMain.Image = Properties.Resources.picrobotcentralized;
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA3";
                                            //  ovalShape1.Visible = true;
                                            // lblwafer.Visible = true;
                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A3";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;
                                            // panel1.Visible = false;



                                            //   await Task.Delay(2000);
                                            //  picCentralize.Image = Properties.Resources.centralize2;//open centralize
                                            //  picMain.Image = Properties.Resources.robotleftA1opencentralize;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA3" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);






                                            // picCentralize.Image = Properties.Resources.robot_into_centralizeA1;

                                            //  picMain.Image = Properties.Resources.picrobotintocentralized;
                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA3";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A3";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;


                                            ////////////////////////////////////////////////////////////////////////////////////
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA3" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);
                                            // pictRobot.Visible = true;
                                            // picCentralize.Image = Properties.Resources.centralize2;
                                            // picMain.Image = Properties.Resources.picrobotcentralized;
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;

                                            picMain.Image.Tag = "picrobotAlignerWaferA3-2";
                                            // ovalShape1.Visible = true;
                                            //picwafer.Visible = true;
                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A3";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;

                                            // await Task.Delay(2000);
                                            // picCentralize.Image = Properties.Resources.centralize;//close centralize
                                            // picMain.Image = Properties.Resources.robotleftA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA3-2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            //   picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA3";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A3";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;



                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA3" && picSV.Visible == true && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            // picChamber.Image = Properties.Resources.new_chamber1;//open chamber
                                            // picMain.Image = Properties.Resources.robotrightA1openchamber;
                                            picSV.Visible = false;  // open sv of chamber
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA3" && picSV.Visible == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            //pictRobot.Visible = false;
                                            //picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            //  picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA3";
                                            // picChamber.Width += 140;
                                            //picChamber.Left -= 150;
                                            //picChamber.Height += 10;
                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A3";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";

                                            // loaddata();
                                            // loadchamber1( sender, e);
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA3" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA3";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA3" && picSV.Visible == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);
                                             
                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA3 into Chamber

                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.ShowDialog();


                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {


                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {


                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));




                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                               // await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                               //     await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "3");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                          //      cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                              //  Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate,logid,NoOfRecipe) values(@11,@21,@31,@41,@51,@61,@71,@81,@91,@101),(@12,@22,@32,@42,@52,@62,@72,@82,@92,@102),(@13,@23,@33,@43,@53,@63,@73,@83,@93,@103)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84,@94,@104),(@15,@25,@35,@45,@55,@65,@75,@85,@95,@105),(@16,@26,@36,@46,@56,@66,@76,@86,@96,@106),(@17,@27,@37,@47,@57,@67,@77,@87,@97,@107),(@18,@28,@38,@48,@58,@68,@78,@88,@98,@108)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@91", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@92", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@93", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@94", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@95", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@96", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@97", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@98", lbl123.Text);
                                                cmdparameter.Parameters.AddWithValue("@101", nooftherecipe);
                                                cmdparameter.Parameters.AddWithValue("@102", nooftherecipe);
                                                cmdparameter.Parameters.AddWithValue("@103", nooftherecipe);
                                                cmdparameter.Parameters.AddWithValue("@104", nooftherecipe);
                                                cmdparameter.Parameters.AddWithValue("@105", nooftherecipe);
                                                cmdparameter.Parameters.AddWithValue("@106", nooftherecipe);
                                                cmdparameter.Parameters.AddWithValue("@107", nooftherecipe);
                                                cmdparameter.Parameters.AddWithValue("@108", nooftherecipe);
                                               
                                              


                                                //   cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }











                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA3" && picSV.Visible == true && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                            picMain.Image.Tag = "A3finishChamber";
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "A3finishChamber" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA3-2";
                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA3-2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA3-2";
                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;
                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA3-2" && picSV.Visible == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA3-2" && picSV.Visible == true && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA3-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;

                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA3-2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "A3picrobotintocassette-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "A3picrobotintocassette-2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "A3mainpicture-2";
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "A3mainpicture-2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                              
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;

                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;

                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;

                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;

                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                            }


                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 3)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();



                                                lblState.Text = "Finished";
                                               

                                            }

                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;
                                                lblState.Text = "Stopping";
                                            }
                                            picMain.Image.Tag = "finishWaferA3";
                                        }
                                        /////////////////////////////////////////////////////////finish waferA3
                                    }









                                      if (int.Parse(NoOfwafer[i]) >= 4)
                                      {
                                        /////////////////////////////////////////////////////////start WaferA4
                                        nooftherecipe = "4";
                                          if(ispauserobot==false&&picMain.Image.Tag.ToString()=="finishWaferA3"&&isStopRobot==false && iscancelrecipe == false)
                                          await Task.Delay(1000);

                                          //pictRobot.Image = Properties.Resources.new_robot;
                                          picMain.Image = Properties.Resources.mainpicture;
                                        picMain.Image.Tag = "mainpictureA4";
                                          await Task.Delay(1000);

                                        //   picCassette.Image = Properties.Resources.cassette3;//open cassette
                                        // picMain.Image = Properties.Resources.mainpicCassetteopen;  
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "mainpictureA4")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA4";
                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;

                                            picCassette.Width += 25;
                                            picCassette.Height += 220;
                                            picCassette.Top -= 205;
                                            picCassette.Image.Tag = "robot_into_cassetteA1";
                                            picCassette.Left += 5;
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;
                                            await Task.Delay(1000);




                                            picCassette.Image = Properties.Resources.cassette;

                                            await Task.Delay(1000);

                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.wafer;
                                                //  picwafer.Image.Tag = "wafer";
                                                picWafer4.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer4.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer4.Visible = false;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                //   picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer4.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                //   picwafer.Image = Properties.Resources.waferA5fullA4;
                                                picWafer4.Visible = false;
                                            }

                                            StartTime = DateTime.Now;


                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "4");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);
                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();





                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA4" && iscancelrecipe == false)
                                        {

                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA4";
                                            // panel1.Visible = true;
                                            //  ovalShape1.Visible = true;
                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A4";

                                            lblCassette.BackColor = Color.Blue;

                                            picCassette.Image = Properties.Resources.cassette3;

                                            // picMain.Image = Properties.Resources.mainpicCassetteopen;
                                            picCassette.Height -= 220;
                                            picCassette.Width -= 25;
                                            picCassette.Top += 205;
                                            picCassette.Image.Tag = "cassette";
                                            picCassette.Left -= 5;
                                            //  await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA4" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);



                                            // pictRobot.Image = Properties.Resources.robotleft_A1;
                                            //   picMain.Image = Properties.Resources.picrobotcentralized;
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag= "picrobotAlignerWaferA4";
                                            //  ovalShape1.Visible = true;
                                            // lblwafer.Visible = true;
                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A4";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;
                                            // panel1.Visible = false;



                                            //   await Task.Delay(2000);
                                            //  picCentralize.Image = Properties.Resources.centralize2;//open centralize
                                            //  picMain.Image = Properties.Resources.robotleftA1opencentralize;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA4" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);






                                            // picCentralize.Image = Properties.Resources.robot_into_centralizeA1;

                                            //  picMain.Image = Properties.Resources.picrobotintocentralized;
                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA4";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A4";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA4" && iscancelrecipe == false)
                                        {
                                            ////////////////////////////////////////////////////////////////////////////////////
                                            await Task.Delay(2000);
                                            // pictRobot.Visible = true;
                                            // picCentralize.Image = Properties.Resources.centralize2;
                                            // picMain.Image = Properties.Resources.picrobotcentralized;
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA4-2";
                                            // ovalShape1.Visible = true;
                                            //picwafer.Visible = true;
                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A4";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA4-2" && iscancelrecipe == false)
                                        {
                                            // await Task.Delay(2000);
                                            // picCentralize.Image = Properties.Resources.centralize;//close centralize
                                            // picMain.Image = Properties.Resources.robotleftA1;
                                            await Task.Delay(2000);

                                            //   picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA4";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A4";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA4" && iscancelrecipe == false)
                                        {

                                            await Task.Delay(1000);

                                            // picChamber.Image = Properties.Resources.new_chamber1;//open chamber
                                            // picMain.Image = Properties.Resources.robotrightA1openchamber;
                                            picSV.Visible = false;  // open sv of chamber
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA4" && picSV.Visible == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            //pictRobot.Visible = false;
                                            //picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            //  picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA4";
                                            // picChamber.Width += 140;
                                            //picChamber.Left -= 150;
                                            //picChamber.Height += 10;
                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A4";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";

                                            // loaddata();
                                            // loadchamber1( sender, e);

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA4" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;


                                            picMain.Image.Tag = "picwaferinAPMA4";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;

                                        }
                                        if(ispauserobot==false&&picMain.Image.Tag.ToString()== "picwaferinAPMA4"&&picSV.Visible==false && iscancelrecipe == false)
                                        { 
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            //////////////////////////////////////////////////////////////////////////////////////////// ///////////WaferA4 into Chamber
                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.ShowDialog();

                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                              //  await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                   // await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "4");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                               // cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                              //  Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                                cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }

                                            




                                            picMain.Image.Tag = "finishchamberA4";




                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }


                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA4" && picSV.Visible==true && iscancelrecipe == false)
                                        {

                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA4" && picSV.Visible == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA4-2";
                                           
                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA4-2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;

                                            picMain.Image.Tag = "picrobotAPMWaferA4-2";

                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA4-2" && picSV.Visible == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA4-2" && picSV.Visible == true && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA4-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA4-2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassettA4-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA4-2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                            }

                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 4)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();

                                                lblState.Text = "Finished";

                                                

                                            }
                                            picMain.Image.Tag = "finishwaferA4";
                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;
                                                lblState.Text = "Stopping";
                                            }

                                           
                                        }
                                          /////////////////////////////////////////////////////////finish waferA4
                                      }













                                    if (int.Parse(NoOfwafer[i]) >= 5)
                                    {
                                        /////////////////////////////////////////////////////////start WaferA5
                                        nooftherecipe = "5";
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishwaferA4" && isStopRobot == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            //pictRobot.Image = Properties.Resources.new_robot;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "mainpictureA5";

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "mainpictureA5" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            //   picCassette.Image = Properties.Resources.cassette3;//open cassette
                                            // picMain.Image = Properties.Resources.mainpicCassetteopen;  
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA5";
                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;

                                            picCassette.Width += 25;
                                            picCassette.Height += 220;
                                            picCassette.Top -= 205;
                                            picCassette.Image.Tag = "robot_into_cassetteA1";
                                            picCassette.Left += 5;
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;
                                            await Task.Delay(1000);


                                            picCassette.Image = Properties.Resources.cassette;
                                            await Task.Delay(1000);

                                            if (NoOfwafer[i] == "1")
                                            {
                                                // picwafer.Image = Properties.Resources.wafer;
                                                //  picwafer.Image.Tag = "wafer";
                                                picWafer5.Visible = true;
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer5.Visible = true;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                //   picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer5.Visible = true;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                //   picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer5.Visible = true;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer5.Visible = false;
                                            }

                                            StartTime = DateTime.Now;


                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "5");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);
                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();


                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA5" && iscancelrecipe == false)
                                        { 
                                        await Task.Delay(1000);

                                        picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA5";                                       // panel1.Visible = true;
                                        //  ovalShape1.Visible = true;
                                        lblwafer.Visible = true;
                                        lblwafer.Text = "A5";

                                        lblCassette.BackColor = Color.Blue;

                                        picCassette.Image = Properties.Resources.cassette3;

                                        // picMain.Image = Properties.Resources.mainpicCassetteopen;
                                        picCassette.Height -= 220;
                                        picCassette.Width -= 25;
                                        picCassette.Top += 205;
                                        picCassette.Image.Tag = "cassette";
                                        picCassette.Left -= 5;
                                        //  await Task.Delay(1000);
                                        picCassette.Image = Properties.Resources.cassette;
                                        // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA5" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);



                                            // pictRobot.Image = Properties.Resources.robotleft_A1;
                                            //   picMain.Image = Properties.Resources.picrobotcentralized;
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA5";
                                            //  ovalShape1.Visible = true;
                                            // lblwafer.Visible = true;
                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A5";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;
                                            // panel1.Visible = false;



                                            //   await Task.Delay(2000);
                                            //  picCentralize.Image = Properties.Resources.centralize2;//open centralize
                                            //  picMain.Image = Properties.Resources.robotleftA1opencentralize;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA5" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);






                                            // picCentralize.Image = Properties.Resources.robot_into_centralizeA1;

                                            //  picMain.Image = Properties.Resources.picrobotintocentralized;
                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA5";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A5";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA5" && iscancelrecipe == false)
                                        {
                                            ////////////////////////////////////////////////////////////////////////////////////
                                            await Task.Delay(2000);
                                            // pictRobot.Visible = true;
                                            // picCentralize.Image = Properties.Resources.centralize2;
                                            // picMain.Image = Properties.Resources.picrobotcentralized;
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA5-2";
                                            // ovalShape1.Visible = true;
                                            //picwafer.Visible = true;
                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A5";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;

                                            // await Task.Delay(2000);
                                            // picCentralize.Image = Properties.Resources.centralize;//close centralize
                                            // picMain.Image = Properties.Resources.robotleftA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA5-2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            //   picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA5";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A5";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;



                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA5" && picSV.Visible == true && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            // picChamber.Image = Properties.Resources.new_chamber1;//open chamber
                                            // picMain.Image = Properties.Resources.robotrightA1openchamber;
                                            picSV.Visible = false;  // open sv of chamber
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA5" && picSV.Visible == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            //pictRobot.Visible = false;
                                            //picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            //  picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA5";
                                            // picChamber.Width += 140;
                                            //picChamber.Left -= 150;
                                            //picChamber.Height += 10;
                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A5";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";

                                            // loaddata();
                                            // loadchamber1( sender, e);
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA5" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            
                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA5";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA5" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA5 into Chamber


                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                                await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                    await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "5");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                             //   cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                                Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                               // cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }











                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                            await Task.Delay(1000);


                                            picMain.Image.Tag = "finishchamberA5";

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA5" && picSV.Visible == true && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA5" && picSV.Visible == true && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA5-2";
                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA5-2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;

                                            picMain.Image.Tag = "picrobotAPMWaferA5-2";
                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA5-2" && picSV.Visible == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;

                                        }

                                        if (ispauserobot==false&&picMain.Image.Tag.ToString()== "picrobotAPMWaferA5-2" && picSV.Visible == true && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA5-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA5-2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA5-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA5-2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                picwafer.Image = Properties.Resources.waferA1full;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                picwafer.Image = Properties.Resources.waferA2full;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                picwafer.Image = Properties.Resources.waferA3full;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                picwafer.Image = Properties.Resources.waferA4full;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;

                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                            }

                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 5)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();

                                                /////////////////////////////////////////////////////////finish waferA5
                                                lblState.Text = "Finished";
                                            }
                                            picMain.Image.Tag = "finishwaferA5";

                                        }
                                      }




                                    if (int.Parse(NoOfwafer[i]) >= 6)
                                    {
                                        /////////////////////////////////////////////////////////start WaferA6

                                        nooftherecipe = "6";
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishwaferA5" && isStopRobot == false && iscancelrecipe == false)
                                        {
                                            picCassette.Image = Properties.Resources.cassette;
                                            await Task.Delay(1000);
                                            //  picMain.Image.Tag = "waferA6";

                                            if (NoOfwafer[i] == "1")
                                            {
                                                picwafer.Image = Properties.Resources.wafer;
                                                picwafer.Image.Tag = "wafer";
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                picwafer.Image = Properties.Resources.waferA1full;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                picwafer.Image = Properties.Resources.waferA2full;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                picwafer.Image = Properties.Resources.waferA3full;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                picwafer.Image = Properties.Resources.waferA4full;
                                            }
                                            else if (NoOfwafer[i] == "6")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer6.Visible = false;
                                            }
                                            StartTime = DateTime.Now;


                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "6");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();









                                            await Task.Delay(1000);

                                            //pictRobot.Image = Properties.Resources.new_robot;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "waferA6mainpicture";
                                            await Task.Delay(1000);

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA6mainpicture" && iscancelrecipe == false)
                                        {

                                            //   picCassette.Image = Properties.Resources.cassette3;//open cassette
                                            // picMain.Image = Properties.Resources.mainpicCassetteopen;  
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA6";
                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;

                                            picCassette.Width += 25;
                                            picCassette.Height += 220;
                                            picCassette.Top -= 205;
                                            picCassette.Image.Tag = "robot_into_cassetteA1";
                                            picCassette.Left += 5;
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA6" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            //  pictRobot.Visible = true;

                                            //  picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA6";                                           // panel1.Visible = true;
                                            //  ovalShape1.Visible = true;
                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A5";

                                            lblCassette.BackColor = Color.Blue;

                                            picCassette.Image = Properties.Resources.cassette3;

                                            // picMain.Image = Properties.Resources.mainpicCassetteopen;
                                            picCassette.Height -= 220;
                                            picCassette.Width -= 25;
                                            picCassette.Top += 205;
                                            picCassette.Image.Tag = "cassette";
                                            picCassette.Left -= 5;
                                            //  await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA6" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);



                                            // pictRobot.Image = Properties.Resources.robotleft_A1;
                                            //   picMain.Image = Properties.Resources.picrobotcentralized;
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            //  ovalShape1.Visible = true;
                                            // lblwafer.Visible = true;
                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A5";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;
                                            // panel1.Visible = false;

                                            picMain.Image.Tag = "picrobotAlignerWaferA6";

                                            //   await Task.Delay(2000);
                                            //  picCentralize.Image = Properties.Resources.centralize2;//open centralize
                                            //  picMain.Image = Properties.Resources.robotleftA1opencentralize;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA6" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);






                                            // picCentralize.Image = Properties.Resources.robot_into_centralizeA1;

                                            //  picMain.Image = Properties.Resources.picrobotintocentralized;
                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA6";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A6";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA6" && iscancelrecipe == false)
                                        {
                                            ////////////////////////////////////////////////////////////////////////////////////
                                            await Task.Delay(2000);
                                            // pictRobot.Visible = true;
                                            // picCentralize.Image = Properties.Resources.centralize2;
                                            // picMain.Image = Properties.Resources.picrobotcentralized;
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA6-2";
                                            // ovalShape1.Visible = true;
                                            //picwafer.Visible = true;
                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A6";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;

                                            // await Task.Delay(2000);
                                            // picCentralize.Image = Properties.Resources.centralize;//close centralize
                                            // picMain.Image = Properties.Resources.robotleftA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA6-2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            //   picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA6";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A6";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;



                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA6" && picSV.Visible == true && iscancelrecipe == false)
                                        {

                                            await Task.Delay(1000);

                                            // picChamber.Image = Properties.Resources.new_chamber1;//open chamber
                                            // picMain.Image = Properties.Resources.robotrightA1openchamber;
                                            picSV.Visible = false;  // open sv of chamber

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA6" && picSV.Visible == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            //pictRobot.Visible = false;
                                            //picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            //  picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA6";
                                            // picChamber.Width += 140;
                                            //picChamber.Left -= 150;
                                            //picChamber.Height += 10;
                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A6";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA6" && iscancelrecipe == false)
                                        {
                                            // loaddata();
                                            // loadchamber1( sender, e);
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA6";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA6" && iscancelrecipe == false)
                                        {

                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA6 into Chamber


                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                                await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                    await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "6");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                                cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                                Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname) values(@11,@21,@31,@41,@51,@61,@71),(@12,@22,@32,@42,@52,@62,@72),(@13,@23,@33,@43,@53,@63,@73)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74),(@15,@25,@35,@45,@55,@65,@75),(@16,@26,@36,@46,@56,@66,@76),(@17,@27,@37,@47,@57,@67,@77),(@18,@28,@38,@48,@58,@68,@78)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);


                                                cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }











                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                            picMain.Image.Tag = "A6finishChamber";
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "A6finishChamber" && picSV.Visible == true && iscancelrecipe == false)

                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "A6finishChamber" && picSV.Visible == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Aborted";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "???????????";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA6-2";
                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA6-2" && picSV.Visible == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA6-2" && picSV.Visible == true && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA6-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;

                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA6-2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA6-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Tag.ToString() == "picrobotintocassetteA6-2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "mainpictureA6-2";
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                        }
                                        if (ispauserobot == false && picMain.Tag.ToString() == "mainpictureA6-2" && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                picwafer.Image = Properties.Resources.waferA1full;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                picwafer.Image = Properties.Resources.waferA2full;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                picwafer.Image = Properties.Resources.waferA3full;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                picwafer.Image = Properties.Resources.waferA4full;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                picwafer.Image = Properties.Resources.waferA5full;
                                            }
                                            if (NoOfwafer[i] == "6")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA6full;
                                                picWafer1.Visible = false;
                                                picWafer2.Visible = false;
                                                picWafer3.Visible = false;
                                                picWafer4.Visible = false;
                                                picWafer5.Visible = false;
                                                picWafer6.Visible = false;

                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;

                                            }

                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 6)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();


                                            }

                                            //////////////////////////////////////////////////////////////////////////finish waferA6
                                            picMain.Image.Tag = "finishWaferA6";
                                        }
                                    }


                                    if (int.Parse(NoOfwafer[i]) >= 7)
                                    {
                                        //////////////////////////////////////////////////////////////////////////start waferA7
                                        nooftherecipe = "7";
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA6" && isStopRobot == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            picCassette.Image = Properties.Resources.cassette1;

                                            if (NoOfwafer[i] == "1")
                                            {
                                                picwafer.Image = Properties.Resources.wafer;
                                                picwafer.Image.Tag = "wafer";
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                picwafer.Image = Properties.Resources.waferA1full;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                picwafer.Image = Properties.Resources.waferA2full;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                picwafer.Image = Properties.Resources.waferA3full;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                picwafer.Image = Properties.Resources.waferA4full;
                                            }
                                            else if (NoOfwafer[i] == "6")
                                            {
                                                picwafer.Image = Properties.Resources.waferA5full;

                                            }
                                            else if (NoOfwafer[i] == "7")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA6full;
                                                picWafer7.Visible = false;
                                            }


                                            StartTime = DateTime.Now;




                                            await Task.Delay(2000);
                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "7");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();

                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "waferA7mainpicture";

                                            await Task.Delay(1000);
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA7mainpicture")
                                        {
                                            // lblCassette.BackColor = Color.LimeGreen;
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA7";
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA7")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA7";

                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A7";

                                            lblCassette.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA7")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA7";

                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A7";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA7")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA7";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A7";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA7")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA7-2";

                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A7";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA7-2")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA7";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A7";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA7" && picSV.Visible == true)
                                        {
                                            await Task.Delay(1000);


                                            picSV.Visible = false;  // open sv of chamber
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA7" && picSV.Visible == false)
                                        { 
                                            await Task.Delay(1000);

                                        picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                        picMain.Image.Tag = "picrobotintoAPMWaferA7";

                                        lblwaferup.Visible = false;
                                        lblwaferAPM.Visible = true;
                                        lblwaferAPM.Text = "A7";
                                        ovalShape1.Top -= 145;
                                        ovalShape1.Left += 3;
                                        lblwafer.Top -= 145;
                                        lblwafer.Left += 3;



                                        lblChamber.BackColor = Color.LimeGreen;

                                        chamberload = "LimeGreen";
                                    }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA7")
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;

                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA7";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA7")

                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA7 into Chamber
                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.ShowDialog();

                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                                //  await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                    // await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "7");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                                // cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                                //  Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                                cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }






                                            picMain.Image.Tag = "finishchamberA7";




                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }


                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA7" && picSV.Visible == true)
                                        {

                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA7" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA7-2";

                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA7-2")
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;

                                            picMain.Image.Tag = "picrobotAPMWaferA7-2";

                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA7-2" && picSV.Visible == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA7-2" && picSV.Visible == true)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA7-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA7-2")
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassettA7-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA7-2")
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "6")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "7")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                            }




                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 7)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();

                                                lblState.Text = "Finished";



                                            }
                                            picMain.Image.Tag = "finishwaferA7";
                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;
                                                lblState.Text = "Stopping";
                                            }


                                        }
                                        /////////////////////////////////////////////////////////finish waferA7
                                    }



                                    if (int.Parse(NoOfwafer[i]) >= 8)
                                    {
                                        //////////////////////////////////////////////////////////////////////////start waferA8
                                        nooftherecipe = "8";
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA7" && isStopRobot == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            picCassette.Image = Properties.Resources.cassette1;

                                            if (NoOfwafer[i] == "1")
                                            {
                                                picwafer.Image = Properties.Resources.wafer;
                                                picwafer.Image.Tag = "wafer";
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                picwafer.Image = Properties.Resources.waferA1full;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                picwafer.Image = Properties.Resources.waferA2full;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                picwafer.Image = Properties.Resources.waferA3full;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                picwafer.Image = Properties.Resources.waferA4full;
                                            }
                                            else if (NoOfwafer[i] == "6")
                                            {
                                                picwafer.Image = Properties.Resources.waferA5full;

                                            }
                                            else if (NoOfwafer[i] == "7")
                                            {
                                                picwafer.Image = Properties.Resources.waferA6full;

                                            }
                                            else if (NoOfwafer[i] == "8")
                                            {
                                                //    picwafer.Image = Properties.Resources.waferA7full;
                                                picWafer8.Visible = false;

                                            }


                                            StartTime = DateTime.Now;




                                            await Task.Delay(2000);
                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "8");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();

                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "waferA8mainpicture";

                                            await Task.Delay(1000);
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA8mainpicture")
                                        {
                                            // lblCassette.BackColor = Color.LimeGreen;
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA8";
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA8")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA8";

                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A8";

                                            lblCassette.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA8")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA8";

                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A8";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA8")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA8";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A8";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA8")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA8-2";

                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A8";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA8-2")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA8";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A8";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA8" && picSV.Visible == true)
                                        {
                                            await Task.Delay(1000);


                                            picSV.Visible = false;  // open sv of chamber
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA8" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA8";

                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A8";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA8")
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;

                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA8";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA8")

                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA8 into Chamber
                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.ShowDialog();

                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                                //  await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                    // await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "8");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                                // cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                                //  Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                                cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }






                                            picMain.Image.Tag = "finishchamberA8";




                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }


                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA8" && picSV.Visible == true)
                                        {

                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA8" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA8-2";

                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA8-2")
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;

                                            picMain.Image.Tag = "picrobotAPMWaferA8-2";

                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA8-2" && picSV.Visible == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA8-2" && picSV.Visible == true)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA8-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA8-2")
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassettA8-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA8-2")
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "6")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "7")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "8")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                            }





                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 8)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();

                                                lblState.Text = "Finished";



                                            }
                                            picMain.Image.Tag = "finishwaferA8";
                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;
                                                lblState.Text = "Stopping";
                                            }


                                        }
                                        /////////////////////////////////////////////////////////finish waferA8
                                    }


                                    if (int.Parse(NoOfwafer[i]) >= 9)
                                    {
                                        //////////////////////////////////////////////////////////////////////////start waferA9
                                        nooftherecipe = "9";
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA8" && isStopRobot == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            picCassette.Image = Properties.Resources.cassette1;

                                            if (NoOfwafer[i] == "1")
                                            {
                                                picwafer.Image = Properties.Resources.wafer;
                                                picwafer.Image.Tag = "wafer";
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                picwafer.Image = Properties.Resources.waferA1full;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                picwafer.Image = Properties.Resources.waferA2full;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                picwafer.Image = Properties.Resources.waferA3full;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                picwafer.Image = Properties.Resources.waferA4full;
                                            }
                                            else if (NoOfwafer[i] == "6")
                                            {
                                                picwafer.Image = Properties.Resources.waferA5full;

                                            }
                                            else if (NoOfwafer[i] == "7")
                                            {
                                                picwafer.Image = Properties.Resources.waferA6full;

                                            }
                                            else if (NoOfwafer[i] == "8")
                                            {
                                                picwafer.Image = Properties.Resources.waferA7full;

                                            }
                                            else if (NoOfwafer[i] == "9")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA8full;
                                                picWafer9.Visible = false;
                                            }


                                            StartTime = DateTime.Now;




                                            await Task.Delay(2000);
                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "9");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();

                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "waferA9mainpicture";

                                            await Task.Delay(1000);
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA9mainpicture")
                                        {
                                            // lblCassette.BackColor = Color.LimeGreen;
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA9";
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA9")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA9";

                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A9";

                                            lblCassette.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA9")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA9";

                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A9";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA9")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA9";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A9";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA9")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA9-2";

                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A9";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA9-2")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA9";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A9";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA9" && picSV.Visible == true)
                                        {
                                            await Task.Delay(1000);


                                            picSV.Visible = false;  // open sv of chamber
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA9" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA9";

                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A9";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA9")
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;

                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA9";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA9")

                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA9 into Chamber
                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.ShowDialog();

                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                                //  await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                    // await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "9");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                                // cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                                //  Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                                cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }






                                            picMain.Image.Tag = "finishchamberA9";




                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }


                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA9" && picSV.Visible == true)
                                        {

                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA9" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA9-2";

                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA9-2")
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;

                                            picMain.Image.Tag = "picrobotAPMWaferA9-2";

                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA9-2" && picSV.Visible == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA9-2" && picSV.Visible == true)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA9-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA9-2")
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassettA9-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA9-2")
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "6")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "7")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "8")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "9")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                            }




                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 9)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();

                                                lblState.Text = "Finished";



                                            }
                                            picMain.Image.Tag = "finishwaferA9";
                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;
                                                lblState.Text = "Stopping";
                                            }


                                        }
                                        /////////////////////////////////////////////////////////finish waferA9
                                    }
                                    if (int.Parse(NoOfwafer[i]) >= 10)
                                    {
                                        //////////////////////////////////////////////////////////////////////////start waferA10
                                        nooftherecipe = "10";
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA9" && isStopRobot == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            picCassette.Image = Properties.Resources.cassette1;

                                            if (NoOfwafer[i] == "1")
                                            {
                                                picwafer.Image = Properties.Resources.wafer;
                                                picwafer.Image.Tag = "wafer";
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                picwafer.Image = Properties.Resources.waferA1full;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                picwafer.Image = Properties.Resources.waferA2full;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                picwafer.Image = Properties.Resources.waferA3full;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                picwafer.Image = Properties.Resources.waferA4full;
                                            }
                                            else if (NoOfwafer[i] == "6")
                                            {
                                                picwafer.Image = Properties.Resources.waferA5full;

                                            }
                                            else if (NoOfwafer[i] == "7")
                                            {
                                                picwafer.Image = Properties.Resources.waferA6full;

                                            }
                                            else if (NoOfwafer[i] == "8")
                                            {
                                                picwafer.Image = Properties.Resources.waferA7full;

                                            }
                                            else if (NoOfwafer[i] == "9")
                                            {
                                                picwafer.Image = Properties.Resources.waferA8full;

                                            }
                                            else if (NoOfwafer[i] == "10")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer10.Visible = false;
                                            }


                                            StartTime = DateTime.Now;




                                            await Task.Delay(2000);
                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "10");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();

                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "waferA10mainpicture";

                                            await Task.Delay(1000);
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA10mainpicture")
                                        {
                                            // lblCassette.BackColor = Color.LimeGreen;
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA10";
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA10")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA10";

                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A10";

                                            lblCassette.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA10")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA10";

                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A10";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA10")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA10";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A10";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA10")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA10-2";

                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A10";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA10-2")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA10";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A10";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA10" && picSV.Visible == true)
                                        {
                                            await Task.Delay(1000);


                                            picSV.Visible = false;  // open sv of chamber
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA10" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA10";

                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A10";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA10")
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;

                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA10";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA10")

                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA10 into Chamber
                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.ShowDialog();

                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                                //  await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                    // await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "10");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                                // cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                                //  Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                                cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }






                                            picMain.Image.Tag = "finishchamberA10";




                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }


                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA10" && picSV.Visible == true)
                                        {

                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA10" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA10-2";

                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA10-2")
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;

                                            picMain.Image.Tag = "picrobotAPMWaferA10-2";

                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA10-2" && picSV.Visible == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA10-2" && picSV.Visible == true)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA10-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA10-2")
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassettA10-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA10-2")
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "6")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "7")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "8")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "9")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "10")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }




                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 10)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();

                                                lblState.Text = "Finished";



                                            }
                                            picMain.Image.Tag = "finishwaferA10";
                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;
                                                lblState.Text = "Stopping";
                                            }


                                        }
                                        /////////////////////////////////////////////////////////finish waferA10
                                    }


                                    if (int.Parse(NoOfwafer[i]) >= 11)
                                    {
                                        //////////////////////////////////////////////////////////////////////////start waferA11
                                        nooftherecipe = "11";
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA10" && isStopRobot == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            picCassette.Image = Properties.Resources.cassette1;

                                            if (NoOfwafer[i] == "1")
                                            {
                                                picwafer.Image = Properties.Resources.wafer;
                                                picwafer.Image.Tag = "wafer";
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                picwafer.Image = Properties.Resources.waferA1full;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                picwafer.Image = Properties.Resources.waferA2full;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                picwafer.Image = Properties.Resources.waferA3full;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                picwafer.Image = Properties.Resources.waferA4full;
                                            }
                                            else if (NoOfwafer[i] == "6")
                                            {
                                                picwafer.Image = Properties.Resources.waferA5full;

                                            }
                                            else if (NoOfwafer[i] == "7")
                                            {
                                                picwafer.Image = Properties.Resources.waferA6full;

                                            }
                                            else if (NoOfwafer[i] == "8")
                                            {
                                                picwafer.Image = Properties.Resources.waferA7full;

                                            }
                                            else if (NoOfwafer[i] == "9")
                                            {
                                                picwafer.Image = Properties.Resources.waferA8full;

                                            }
                                            else if (NoOfwafer[i] == "10")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }
                                            else if (NoOfwafer[i] == "11")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer11.Visible = false;
                                            }



                                            StartTime = DateTime.Now;




                                            await Task.Delay(2000);
                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "11");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();

                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "waferA11mainpicture";

                                            await Task.Delay(1000);
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA11mainpicture")
                                        {
                                            // lblCassette.BackColor = Color.LimeGreen;
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA11";
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA11")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA11";

                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A11";

                                            lblCassette.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA11")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA11";

                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A11";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA11")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA11";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A11";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA11")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA11-2";

                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A10";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA11-2")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA11";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A11";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA11" && picSV.Visible == true)
                                        {
                                            await Task.Delay(1000);


                                            picSV.Visible = false;  // open sv of chamber
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA11" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA11";

                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A11";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA11")
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;

                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA11";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA11")

                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA11 into Chamber
                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.ShowDialog();

                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                                //  await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                    // await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "11");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                                // cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                                //  Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                                cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }






                                            picMain.Image.Tag = "finishchamberA11";




                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }


                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA11" && picSV.Visible == true)
                                        {

                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA11" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA11-2";

                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA11-2")
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;

                                            picMain.Image.Tag = "picrobotAPMWaferA11-2";

                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA11-2" && picSV.Visible == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA11-2" && picSV.Visible == true)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA11-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA11-2")
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassettA11-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA11-2")
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "6")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "7")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "8")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "9")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "10")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "11")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                            }




                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 11)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();

                                                lblState.Text = "Finished";



                                            }
                                            picMain.Image.Tag = "finishwaferA11";
                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;
                                                lblState.Text = "Stopping";
                                            }


                                        }
                                        /////////////////////////////////////////////////////////finish waferA11
                                    }

                                    if (int.Parse(NoOfwafer[i]) >= 12)
                                    {
                                        //////////////////////////////////////////////////////////////////////////start waferA12
                                        nooftherecipe = "12";
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA11" && isStopRobot == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            picCassette.Image = Properties.Resources.cassette1;

                                            if (NoOfwafer[i] == "1")
                                            {
                                                picwafer.Image = Properties.Resources.wafer;
                                                picwafer.Image.Tag = "wafer";
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                picwafer.Image = Properties.Resources.waferA1full;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                picwafer.Image = Properties.Resources.waferA2full;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                picwafer.Image = Properties.Resources.waferA3full;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                picwafer.Image = Properties.Resources.waferA4full;
                                            }
                                            else if (NoOfwafer[i] == "6")
                                            {
                                                picwafer.Image = Properties.Resources.waferA5full;

                                            }
                                            else if (NoOfwafer[i] == "7")
                                            {
                                                picwafer.Image = Properties.Resources.waferA6full;

                                            }
                                            else if (NoOfwafer[i] == "8")
                                            {
                                                picwafer.Image = Properties.Resources.waferA7full;

                                            }
                                            else if (NoOfwafer[i] == "9")
                                            {
                                                picwafer.Image = Properties.Resources.waferA8full;

                                            }
                                            else if (NoOfwafer[i] == "10")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }
                                            else if (NoOfwafer[i] == "11")
                                            {
                                                picwafer.Image = Properties.Resources.waferA10full;

                                            }

                                            else if (NoOfwafer[i] == "12")
                                            {
                                                picWafer12.Visible = false;

                                            }



                                            StartTime = DateTime.Now;




                                            await Task.Delay(2000);
                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "12");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();

                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "waferA12mainpicture";

                                            await Task.Delay(1000);
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA12mainpicture")
                                        {
                                            // lblCassette.BackColor = Color.LimeGreen;
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA12";
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA12")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA12";

                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A12";

                                            lblCassette.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA12")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA12";

                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A12";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA12")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA12";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A12";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA12")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA12-2";

                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A12";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA12-2")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA12";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A12";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA12" && picSV.Visible == true)
                                        {
                                            await Task.Delay(1000);


                                            picSV.Visible = false;  // open sv of chamber
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA12" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA12";

                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A12";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA12")
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;

                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA12";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA12")

                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA12 into Chamber
                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.ShowDialog();

                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                                //  await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                    // await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "12");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                                // cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                                //  Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                                cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }






                                            picMain.Image.Tag = "finishchamberA12";




                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }


                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA12" && picSV.Visible == true)
                                        {

                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA12" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA12-2";

                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA12-2")
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;

                                            picMain.Image.Tag = "picrobotAPMWaferA12-2";

                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA12-2" && picSV.Visible == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA12-2" && picSV.Visible == true)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA12-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA12-2")
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassettA12-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA12-2")
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "6")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "7")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "8")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "9")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "10")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "11")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "12")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                            }




                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 12)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();

                                                lblState.Text = "Finished";



                                            }
                                            picMain.Image.Tag = "finishwaferA12";
                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;
                                                lblState.Text = "Stopping";
                                            }


                                        }
                                        /////////////////////////////////////////////////////////finish waferA12
                                    }

                                    if (int.Parse(NoOfwafer[i]) >= 13)
                                    {
                                        //////////////////////////////////////////////////////////////////////////start waferA13
                                        nooftherecipe = "13";
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA12" && isStopRobot == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            picCassette.Image = Properties.Resources.cassette1;

                                            if (NoOfwafer[i] == "1")
                                            {
                                                picwafer.Image = Properties.Resources.wafer;
                                                picwafer.Image.Tag = "wafer";
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                picwafer.Image = Properties.Resources.waferA1full;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                picwafer.Image = Properties.Resources.waferA2full;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                picwafer.Image = Properties.Resources.waferA3full;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                picwafer.Image = Properties.Resources.waferA4full;
                                            }
                                            else if (NoOfwafer[i] == "6")
                                            {
                                                picwafer.Image = Properties.Resources.waferA5full;

                                            }
                                            else if (NoOfwafer[i] == "7")
                                            {
                                                picwafer.Image = Properties.Resources.waferA6full;

                                            }
                                            else if (NoOfwafer[i] == "8")
                                            {
                                                picwafer.Image = Properties.Resources.waferA7full;

                                            }
                                            else if (NoOfwafer[i] == "9")
                                            {
                                                picwafer.Image = Properties.Resources.waferA8full;

                                            }
                                            else if (NoOfwafer[i] == "10")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }
                                            else if (NoOfwafer[i] == "11")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }
                                            else if (NoOfwafer[i] == "12")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }
                                            else if (NoOfwafer[i] == "13")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer13.Visible = false;

                                            }


                                            StartTime = DateTime.Now;




                                            await Task.Delay(2000);
                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "13");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();

                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "waferA13mainpicture";

                                            await Task.Delay(1000);
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA13mainpicture")
                                        {
                                            // lblCassette.BackColor = Color.LimeGreen;
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA13";
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA13")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA13";

                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A13";

                                            lblCassette.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA13")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA13";

                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A13";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA13")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA13";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A13";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA13")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA13-2";

                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A13";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA13-2")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA13";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A13";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA13" && picSV.Visible == true)
                                        {
                                            await Task.Delay(1000);


                                            picSV.Visible = false;  // open sv of chamber
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA13" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA13";

                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A13";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA13")
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;

                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA13";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA13")

                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA13 into Chamber
                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.ShowDialog();

                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                                //  await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                    // await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "13");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                                // cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                                //  Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                                cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }






                                            picMain.Image.Tag = "finishchamberA13";




                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }


                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA13" && picSV.Visible == true)
                                        {

                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA13" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA13-2";

                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA13-2")
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;

                                            picMain.Image.Tag = "picrobotAPMWaferA13-2";

                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA13-2" && picSV.Visible == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA13-2" && picSV.Visible == true)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA13-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA13-2")
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassettA13-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA13-2")
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "6")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "7")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "8")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "9")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "10")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "11")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "12")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "13")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                            }




                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 13)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();

                                                lblState.Text = "Finished";



                                            }
                                            picMain.Image.Tag = "finishwaferA13";
                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;
                                                lblState.Text = "Stopping";
                                            }


                                        }
                                        /////////////////////////////////////////////////////////finish waferA13
                                    }

                                    if (int.Parse(NoOfwafer[i]) >= 14)
                                    {
                                        //////////////////////////////////////////////////////////////////////////start waferA14
                                        nooftherecipe = "14";
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA13" && isStopRobot == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            picCassette.Image = Properties.Resources.cassette1;

                                            if (NoOfwafer[i] == "1")
                                            {
                                                picwafer.Image = Properties.Resources.wafer;
                                                picwafer.Image.Tag = "wafer";
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                picwafer.Image = Properties.Resources.waferA1full;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                picwafer.Image = Properties.Resources.waferA2full;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                picwafer.Image = Properties.Resources.waferA3full;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                picwafer.Image = Properties.Resources.waferA4full;
                                            }
                                            else if (NoOfwafer[i] == "6")
                                            {
                                                picwafer.Image = Properties.Resources.waferA5full;

                                            }
                                            else if (NoOfwafer[i] == "7")
                                            {
                                                picwafer.Image = Properties.Resources.waferA6full;

                                            }
                                            else if (NoOfwafer[i] == "8")
                                            {
                                                picwafer.Image = Properties.Resources.waferA7full;

                                            }
                                            else if (NoOfwafer[i] == "9")
                                            {
                                                picwafer.Image = Properties.Resources.waferA8full;

                                            }
                                            else if (NoOfwafer[i] == "10")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }
                                            else if (NoOfwafer[i] == "11")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "12")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "13")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer14.Visible = false;
                                            }



                                            StartTime = DateTime.Now;




                                            await Task.Delay(2000);
                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "14");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();

                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "waferA14mainpicture";

                                            await Task.Delay(1000);
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA14mainpicture")
                                        {
                                            // lblCassette.BackColor = Color.LimeGreen;
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA14";
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA14")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA14";

                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A14";

                                            lblCassette.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA14")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA14";

                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A14";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA14")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA14";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A14";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA14")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA14-2";

                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A14";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA14-2")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA14";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A14";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA14" && picSV.Visible == true)
                                        {
                                            await Task.Delay(1000);


                                            picSV.Visible = false;  // open sv of chamber
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA14" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA14";

                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A14";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA14")
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;

                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA14";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA14")

                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA14 into Chamber
                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.ShowDialog();

                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                                //  await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                    // await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "14");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                                // cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                                //  Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                                cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }






                                            picMain.Image.Tag = "finishchamberA14";




                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }


                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA14" && picSV.Visible == true)
                                        {

                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA14" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA14-2";

                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA14-2")
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;

                                            picMain.Image.Tag = "picrobotAPMWaferA14-2";

                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA14-2" && picSV.Visible == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA14-2" && picSV.Visible == true)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA14-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA14-2")
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassettA14-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA14-2")
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "6")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "7")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "8")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "9")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "10")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "11")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "12")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "13")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;

                                            }





                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 14)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();

                                                lblState.Text = "Finished";



                                            }
                                            picMain.Image.Tag = "finishwaferA14";
                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;
                                                lblState.Text = "Stopping";
                                            }


                                        }
                                        /////////////////////////////////////////////////////////finish waferA14
                                    }

                                    if (int.Parse(NoOfwafer[i]) >= 15)
                                    {
                                        //////////////////////////////////////////////////////////////////////////start waferA15
                                        nooftherecipe = "15";
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA14" && isStopRobot == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            picCassette.Image = Properties.Resources.cassette1;

                                            if (NoOfwafer[i] == "1")
                                            {
                                                picwafer.Image = Properties.Resources.wafer;
                                                picwafer.Image.Tag = "wafer";
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                picwafer.Image = Properties.Resources.waferA1full;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                picwafer.Image = Properties.Resources.waferA2full;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                picwafer.Image = Properties.Resources.waferA3full;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                picwafer.Image = Properties.Resources.waferA4full;
                                            }
                                            else if (NoOfwafer[i] == "6")
                                            {
                                                picwafer.Image = Properties.Resources.waferA5full;

                                            }
                                            else if (NoOfwafer[i] == "7")
                                            {
                                                picwafer.Image = Properties.Resources.waferA6full;

                                            }
                                            else if (NoOfwafer[i] == "8")
                                            {
                                                picwafer.Image = Properties.Resources.waferA7full;

                                            }
                                            else if (NoOfwafer[i] == "9")
                                            {
                                                picwafer.Image = Properties.Resources.waferA8full;

                                            }
                                            else if (NoOfwafer[i] == "10")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }
                                            else if (NoOfwafer[i] == "11")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "12")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "13")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer14.Visible = false;
                                            }

                                            else if (NoOfwafer[i] == "15")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer15.Visible = false;
                                            }



                                            StartTime = DateTime.Now;




                                            await Task.Delay(2000);
                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "15");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();

                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "waferA15mainpicture";

                                            await Task.Delay(1000);
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA15mainpicture")
                                        {
                                            // lblCassette.BackColor = Color.LimeGreen;
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA15";
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA15")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA15";

                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A15";

                                            lblCassette.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA15")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA15";

                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A15";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA15")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA15";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A15";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA15")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA15-2";

                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A15";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA15-2")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA15";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A15";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA15" && picSV.Visible == true)
                                        {
                                            await Task.Delay(1000);


                                            picSV.Visible = false;  // open sv of chamber
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA15" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA15";

                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A15";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA15")
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;

                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA15";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA15")

                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA15 into Chamber
                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.ShowDialog();

                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                                //  await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                    // await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "15");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                                // cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                                //  Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                                cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }






                                            picMain.Image.Tag = "finishchamberA15";




                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }


                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA15" && picSV.Visible == true)
                                        {

                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA15" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA15-2";

                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA15-2")
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;

                                            picMain.Image.Tag = "picrobotAPMWaferA15-2";

                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA15-2" && picSV.Visible == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA15-2" && picSV.Visible == true)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA15-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA15-2")
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassettA15-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA15-2")
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "6")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "7")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "8")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "9")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "10")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "11")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "12")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "13")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;

                                            }
                                            if (NoOfwafer[i] == "15")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                            }




                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 15)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();

                                                lblState.Text = "Finished";



                                            }
                                            picMain.Image.Tag = "finishwaferA15";
                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;
                                                lblState.Text = "Stopping";
                                            }


                                        }
                                        /////////////////////////////////////////////////////////finish waferA15
                                    }

                                    if (int.Parse(NoOfwafer[i]) >= 16)
                                    {
                                        //////////////////////////////////////////////////////////////////////////start waferA16
                                        nooftherecipe = "16";
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA15" && isStopRobot == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            picCassette.Image = Properties.Resources.cassette1;

                                            if (NoOfwafer[i] == "1")
                                            {
                                                picwafer.Image = Properties.Resources.wafer;
                                                picwafer.Image.Tag = "wafer";
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                picwafer.Image = Properties.Resources.waferA1full;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                picwafer.Image = Properties.Resources.waferA2full;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                picwafer.Image = Properties.Resources.waferA3full;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                picwafer.Image = Properties.Resources.waferA4full;
                                            }
                                            else if (NoOfwafer[i] == "6")
                                            {
                                                picwafer.Image = Properties.Resources.waferA5full;

                                            }
                                            else if (NoOfwafer[i] == "7")
                                            {
                                                picwafer.Image = Properties.Resources.waferA6full;

                                            }
                                            else if (NoOfwafer[i] == "8")
                                            {
                                                picwafer.Image = Properties.Resources.waferA7full;

                                            }
                                            else if (NoOfwafer[i] == "9")
                                            {
                                                picwafer.Image = Properties.Resources.waferA8full;

                                            }
                                            else if (NoOfwafer[i] == "10")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }
                                            else if (NoOfwafer[i] == "11")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "12")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "13")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer14.Visible = false;
                                            }

                                            else if (NoOfwafer[i] == "15")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer15.Visible = false;
                                            }

                                            else if (NoOfwafer[i] == "16")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer16.Visible = false;
                                            }

                                            StartTime = DateTime.Now;




                                            await Task.Delay(2000);
                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "16");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();

                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "waferA16mainpicture";

                                            await Task.Delay(1000);
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA16mainpicture")
                                        {
                                            // lblCassette.BackColor = Color.LimeGreen;
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA16";
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA16")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA16";

                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A16";

                                            lblCassette.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA16")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA16";

                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A16";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA16")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA16";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A16";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA16")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA16-2";

                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A16";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA16-2")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA16";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A16";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA16" && picSV.Visible == true)
                                        {
                                            await Task.Delay(1000);


                                            picSV.Visible = false;  // open sv of chamber
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA16" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA16";

                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A16";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA16")
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;

                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA16";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA16")

                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA16 into Chamber
                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.ShowDialog();

                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                                //  await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                    // await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "16");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                                // cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                                //  Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                                cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }






                                            picMain.Image.Tag = "finishchamberA16";




                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }


                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA16" && picSV.Visible == true)
                                        {

                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA16" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA16-2";

                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA16-2")
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;

                                            picMain.Image.Tag = "picrobotAPMWaferA16-2";

                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA16-2" && picSV.Visible == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA16-2" && picSV.Visible == true)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA16-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA16-2")
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassettA16-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA16-2")
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "6")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "7")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "8")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "9")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "10")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "11")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "12")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "13")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;

                                            }
                                            if (NoOfwafer[i] == "15")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "16")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                            }




                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 16)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();

                                                lblState.Text = "Finished";



                                            }
                                            picMain.Image.Tag = "finishwaferA16";
                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;
                                                lblState.Text = "Stopping";
                                            }


                                        }
                                        /////////////////////////////////////////////////////////finish waferA16
                                    }

                                    if (int.Parse(NoOfwafer[i]) >= 17)
                                    {
                                        //////////////////////////////////////////////////////////////////////////start waferA17
                                        nooftherecipe = "17";
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA17" && isStopRobot == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            picCassette.Image = Properties.Resources.cassette1;

                                            if (NoOfwafer[i] == "1")
                                            {
                                                picwafer.Image = Properties.Resources.wafer;
                                                picwafer.Image.Tag = "wafer";
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                picwafer.Image = Properties.Resources.waferA1full;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                picwafer.Image = Properties.Resources.waferA2full;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                picwafer.Image = Properties.Resources.waferA3full;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                picwafer.Image = Properties.Resources.waferA4full;
                                            }
                                            else if (NoOfwafer[i] == "6")
                                            {
                                                picwafer.Image = Properties.Resources.waferA5full;

                                            }
                                            else if (NoOfwafer[i] == "7")
                                            {
                                                picwafer.Image = Properties.Resources.waferA6full;

                                            }
                                            else if (NoOfwafer[i] == "8")
                                            {
                                                picwafer.Image = Properties.Resources.waferA7full;

                                            }
                                            else if (NoOfwafer[i] == "9")
                                            {
                                                picwafer.Image = Properties.Resources.waferA8full;

                                            }
                                            else if (NoOfwafer[i] == "10")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }
                                            else if (NoOfwafer[i] == "11")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "12")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "13")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer14.Visible = false;
                                            }

                                            else if (NoOfwafer[i] == "15")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer15.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "16")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer15.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "17")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer17.Visible = false;
                                            }



                                            StartTime = DateTime.Now;




                                            await Task.Delay(2000);
                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "17");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();

                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "waferA17mainpicture";

                                            await Task.Delay(1000);
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA17mainpicture")
                                        {
                                            // lblCassette.BackColor = Color.LimeGreen;
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA17";
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA17")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA17";

                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A17";

                                            lblCassette.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA17")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA17";

                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A17";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA17")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA17";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A17";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA17")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA17-2";

                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A17";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA17-2")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA17";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A17";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA17" && picSV.Visible == true)
                                        {
                                            await Task.Delay(1000);


                                            picSV.Visible = false;  // open sv of chamber
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA17" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA17";

                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A17";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA17")
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;

                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA17";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA17")

                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA17 into Chamber
                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.ShowDialog();

                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                                //  await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                    // await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "17");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                                // cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                                //  Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                                cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }






                                            picMain.Image.Tag = "finishchamberA17";




                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }


                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA17" && picSV.Visible == true)
                                        {

                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA17" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA17-2";

                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA17-2")
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;

                                            picMain.Image.Tag = "picrobotAPMWaferA17-2";

                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA17-2" && picSV.Visible == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA17-2" && picSV.Visible == true)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA17-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA17-2")
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassettA17-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA17-2")
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "6")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "7")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "8")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "9")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "10")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "11")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "12")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "13")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;

                                            }
                                            if (NoOfwafer[i] == "15")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "16")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "17")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                            }




                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 17)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();

                                                lblState.Text = "Finished";



                                            }
                                            picMain.Image.Tag = "finishwaferA17";
                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;
                                                lblState.Text = "Stopping";
                                            }


                                        }
                                        /////////////////////////////////////////////////////////finish waferA17
                                    }

                                    if (int.Parse(NoOfwafer[i]) >= 18)
                                    {
                                        //////////////////////////////////////////////////////////////////////////start waferA18
                                        nooftherecipe = "18";
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA18" && isStopRobot == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            picCassette.Image = Properties.Resources.cassette1;

                                            if (NoOfwafer[i] == "1")
                                            {
                                                picwafer.Image = Properties.Resources.wafer;
                                                picwafer.Image.Tag = "wafer";
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                picwafer.Image = Properties.Resources.waferA1full;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                picwafer.Image = Properties.Resources.waferA2full;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                picwafer.Image = Properties.Resources.waferA3full;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                picwafer.Image = Properties.Resources.waferA4full;
                                            }
                                            else if (NoOfwafer[i] == "6")
                                            {
                                                picwafer.Image = Properties.Resources.waferA5full;

                                            }
                                            else if (NoOfwafer[i] == "7")
                                            {
                                                picwafer.Image = Properties.Resources.waferA6full;

                                            }
                                            else if (NoOfwafer[i] == "8")
                                            {
                                                picwafer.Image = Properties.Resources.waferA7full;

                                            }
                                            else if (NoOfwafer[i] == "9")
                                            {
                                                picwafer.Image = Properties.Resources.waferA8full;

                                            }
                                            else if (NoOfwafer[i] == "10")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }
                                            else if (NoOfwafer[i] == "11")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "12")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "13")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer14.Visible = false;
                                            }

                                            else if (NoOfwafer[i] == "15")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer15.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "16")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer15.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "17")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer17.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "18")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer18.Visible = false;
                                            }



                                            StartTime = DateTime.Now;




                                            await Task.Delay(2000);
                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "18");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();

                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "waferA18mainpicture";

                                            await Task.Delay(1000);
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA18mainpicture")
                                        {
                                            // lblCassette.BackColor = Color.LimeGreen;
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA18";
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA18")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA18";

                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A18";

                                            lblCassette.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA18")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA18";

                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A18";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA18")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA18";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A18";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA18")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA18-2";

                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A18";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA18-2")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA18";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A18";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA18" && picSV.Visible == true)
                                        {
                                            await Task.Delay(1000);


                                            picSV.Visible = false;  // open sv of chamber
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA18" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA18";

                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A18";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA18")
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;

                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA18";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA18")

                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA18 into Chamber
                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.ShowDialog();

                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                                //  await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                    // await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "18");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                                // cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                                //  Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                                cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }






                                            picMain.Image.Tag = "finishchamberA18";




                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }


                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA18" && picSV.Visible == true)
                                        {

                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA18" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA18-2";

                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA18-2")
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;

                                            picMain.Image.Tag = "picrobotAPMWaferA18-2";

                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA18-2" && picSV.Visible == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA18-2" && picSV.Visible == true)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA18-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA18-2")
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassettA18-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA18-2")
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "6")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "7")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "8")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "9")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "10")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "11")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "12")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "13")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;

                                            }
                                            if (NoOfwafer[i] == "15")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "16")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "17")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "18")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                            }



                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 18)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();

                                                lblState.Text = "Finished";



                                            }
                                            picMain.Image.Tag = "finishwaferA18";
                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;
                                                lblState.Text = "Stopping";
                                            }


                                        }
                                        /////////////////////////////////////////////////////////finish waferA18
                                    }


                                    if (int.Parse(NoOfwafer[i]) >= 19)
                                    {
                                        //////////////////////////////////////////////////////////////////////////start waferA19
                                        nooftherecipe = "19";
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA19" && isStopRobot == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            picCassette.Image = Properties.Resources.cassette1;

                                            if (NoOfwafer[i] == "1")
                                            {
                                                picwafer.Image = Properties.Resources.wafer;
                                                picwafer.Image.Tag = "wafer";
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                picwafer.Image = Properties.Resources.waferA1full;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                picwafer.Image = Properties.Resources.waferA2full;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                picwafer.Image = Properties.Resources.waferA3full;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                picwafer.Image = Properties.Resources.waferA4full;
                                            }
                                            else if (NoOfwafer[i] == "6")
                                            {
                                                picwafer.Image = Properties.Resources.waferA5full;

                                            }
                                            else if (NoOfwafer[i] == "7")
                                            {
                                                picwafer.Image = Properties.Resources.waferA6full;

                                            }
                                            else if (NoOfwafer[i] == "8")
                                            {
                                                picwafer.Image = Properties.Resources.waferA7full;

                                            }
                                            else if (NoOfwafer[i] == "9")
                                            {
                                                picwafer.Image = Properties.Resources.waferA8full;

                                            }
                                            else if (NoOfwafer[i] == "10")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }
                                            else if (NoOfwafer[i] == "11")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "12")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "13")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer14.Visible = false;
                                            }

                                            else if (NoOfwafer[i] == "15")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer15.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "16")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer15.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "17")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer17.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "18")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer18.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "19")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer19.Visible = false;
                                            }


                                            StartTime = DateTime.Now;




                                            await Task.Delay(2000);
                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "19");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();

                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "waferA19mainpicture";

                                            await Task.Delay(1000);
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA19mainpicture")
                                        {
                                            // lblCassette.BackColor = Color.LimeGreen;
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA19";
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA19")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA19";

                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A19";

                                            lblCassette.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA19")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA19";

                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A19";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA19")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA19";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A19";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA19")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA19-2";

                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A19";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA19-2")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA19";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A19";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA19" && picSV.Visible == true)
                                        {
                                            await Task.Delay(1000);


                                            picSV.Visible = false;  // open sv of chamber
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA19" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA19";

                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A19";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA19")
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;

                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA19";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA19")

                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA19 into Chamber
                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.ShowDialog();

                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                                //  await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                    // await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "19");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                                // cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                                //  Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                                cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }






                                            picMain.Image.Tag = "finishchamberA19";




                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }


                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA19" && picSV.Visible == true)
                                        {

                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA19" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA19-2";

                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA19-2")
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;

                                            picMain.Image.Tag = "picrobotAPMWaferA19-2";

                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA19-2" && picSV.Visible == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA19-2" && picSV.Visible == true)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA19-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA19-2")
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassettA19-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA19-2")
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "6")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "7")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "8")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "9")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "10")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "11")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "12")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "13")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;

                                            }
                                            if (NoOfwafer[i] == "15")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "16")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "17")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "18")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "19")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                            }


                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 19)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();

                                                lblState.Text = "Finished";



                                            }
                                            picMain.Image.Tag = "finishwaferA19";
                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;
                                                lblState.Text = "Stopping";
                                            }


                                        }
                                        /////////////////////////////////////////////////////////finish waferA19
                                    }

                                    if (int.Parse(NoOfwafer[i]) >= 20)
                                    {
                                        //////////////////////////////////////////////////////////////////////////start waferA20
                                        nooftherecipe = "20";
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA20" && isStopRobot == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            picCassette.Image = Properties.Resources.cassette1;

                                            if (NoOfwafer[i] == "1")
                                            {
                                                picwafer.Image = Properties.Resources.wafer;
                                                picwafer.Image.Tag = "wafer";
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                picwafer.Image = Properties.Resources.waferA1full;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                picwafer.Image = Properties.Resources.waferA2full;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                picwafer.Image = Properties.Resources.waferA3full;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                picwafer.Image = Properties.Resources.waferA4full;
                                            }
                                            else if (NoOfwafer[i] == "6")
                                            {
                                                picwafer.Image = Properties.Resources.waferA5full;

                                            }
                                            else if (NoOfwafer[i] == "7")
                                            {
                                                picwafer.Image = Properties.Resources.waferA6full;

                                            }
                                            else if (NoOfwafer[i] == "8")
                                            {
                                                picwafer.Image = Properties.Resources.waferA7full;

                                            }
                                            else if (NoOfwafer[i] == "9")
                                            {
                                                picwafer.Image = Properties.Resources.waferA8full;

                                            }
                                            else if (NoOfwafer[i] == "10")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }
                                            else if (NoOfwafer[i] == "11")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "12")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "13")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer14.Visible = false;
                                            }

                                            else if (NoOfwafer[i] == "15")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer15.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "16")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer15.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "17")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer17.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "18")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer18.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "19")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer19.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "20")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer20.Visible = false;
                                            }

                                            StartTime = DateTime.Now;




                                            await Task.Delay(2000);
                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "20");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();

                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "waferA20mainpicture";

                                            await Task.Delay(1000);
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA20mainpicture")
                                        {
                                            // lblCassette.BackColor = Color.LimeGreen;
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA20";
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA20")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA20";

                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A20";

                                            lblCassette.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA20")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA20";

                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A20";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA20")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA20";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A20";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA20")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA20-2";

                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A20";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA20-2")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA20";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A20";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA20" && picSV.Visible == true)
                                        {
                                            await Task.Delay(1000);


                                            picSV.Visible = false;  // open sv of chamber
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA20" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA20";

                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A20";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA20")
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;

                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA20";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA20")

                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA20 into Chamber
                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.ShowDialog();

                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                                //  await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                    // await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "20");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                                // cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                                //  Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                                cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }






                                            picMain.Image.Tag = "finishchamberA20";




                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }


                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA20" && picSV.Visible == true)
                                        {

                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA20" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA20-2";

                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA20-2")
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;

                                            picMain.Image.Tag = "picrobotAPMWaferA20-2";

                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA20-2" && picSV.Visible == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA20-2" && picSV.Visible == true)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA20-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA20-2")
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassettA20-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA20-2")
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "6")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "7")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "8")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "9")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "10")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "11")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "12")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "13")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;

                                            }
                                            if (NoOfwafer[i] == "15")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "16")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "17")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "18")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "19")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "20")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer20.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                                picWafer20.Image = Properties.Resources.picWaferGreen;
                                            }

                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 20)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();

                                                lblState.Text = "Finished";



                                            }
                                            picMain.Image.Tag = "finishwaferA20";
                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;
                                                lblState.Text = "Stopping";
                                            }


                                        }
                                        /////////////////////////////////////////////////////////finish waferA20
                                    }

                                    if (int.Parse(NoOfwafer[i]) >= 21)
                                    {
                                        //////////////////////////////////////////////////////////////////////////start waferA21
                                        nooftherecipe = "21";
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA21" && isStopRobot == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            picCassette.Image = Properties.Resources.cassette1;

                                            if (NoOfwafer[i] == "1")
                                            {
                                                picwafer.Image = Properties.Resources.wafer;
                                                picwafer.Image.Tag = "wafer";
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                picwafer.Image = Properties.Resources.waferA1full;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                picwafer.Image = Properties.Resources.waferA2full;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                picwafer.Image = Properties.Resources.waferA3full;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                picwafer.Image = Properties.Resources.waferA4full;
                                            }
                                            else if (NoOfwafer[i] == "6")
                                            {
                                                picwafer.Image = Properties.Resources.waferA5full;

                                            }
                                            else if (NoOfwafer[i] == "7")
                                            {
                                                picwafer.Image = Properties.Resources.waferA6full;

                                            }
                                            else if (NoOfwafer[i] == "8")
                                            {
                                                picwafer.Image = Properties.Resources.waferA7full;

                                            }
                                            else if (NoOfwafer[i] == "9")
                                            {
                                                picwafer.Image = Properties.Resources.waferA8full;

                                            }
                                            else if (NoOfwafer[i] == "10")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }
                                            else if (NoOfwafer[i] == "11")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "12")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "13")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer14.Visible = false;
                                            }

                                            else if (NoOfwafer[i] == "15")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer15.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "16")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer15.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "17")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer17.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "18")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer18.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "19")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer19.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "20")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer20.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "21")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer21.Visible = false;
                                            }
                                            StartTime = DateTime.Now;




                                            await Task.Delay(2000);
                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "21");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();

                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "waferA21mainpicture";

                                            await Task.Delay(1000);
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA21mainpicture")
                                        {
                                            // lblCassette.BackColor = Color.LimeGreen;
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA21";
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA21")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA21";

                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A21";

                                            lblCassette.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA21")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA21";

                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A21";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA21")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA21";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A21";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA21")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA21-2";

                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A21";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA21-2")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA21";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A21";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA21" && picSV.Visible == true)
                                        {
                                            await Task.Delay(1000);


                                            picSV.Visible = false;  // open sv of chamber
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA21" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA21";

                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A21";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA21")
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;

                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA21";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA21")

                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA21 into Chamber
                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.ShowDialog();

                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                                //  await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                    // await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "21");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                                // cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                                //  Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                                cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }






                                            picMain.Image.Tag = "finishchamberA21";




                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }


                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA21" && picSV.Visible == true)
                                        {

                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA21" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA21-2";

                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA21-2")
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;

                                            picMain.Image.Tag = "picrobotAPMWaferA21-2";

                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA21-2" && picSV.Visible == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA21-2" && picSV.Visible == true)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA21-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA21-2")
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassettA21-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA21-2")
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "6")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "7")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "8")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "9")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "10")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "11")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "12")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "13")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;

                                            }
                                            if (NoOfwafer[i] == "15")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "16")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "17")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "18")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "19")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "20")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer20.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                                picWafer20.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "21")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer20.Visible = true;
                                                picWafer21.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                                picWafer20.Image = Properties.Resources.picWaferGreen;
                                                picWafer21.Image = Properties.Resources.picWaferGreen;
                                            }

                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 21)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();

                                                lblState.Text = "Finished";



                                            }
                                            picMain.Image.Tag = "finishwaferA21";
                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;
                                                lblState.Text = "Stopping";
                                            }


                                        }
                                        /////////////////////////////////////////////////////////finish waferA21
                                    }

                                    if (int.Parse(NoOfwafer[i]) >= 22)
                                    {
                                        //////////////////////////////////////////////////////////////////////////start waferA22
                                        nooftherecipe = "22";
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA21" && isStopRobot == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            picCassette.Image = Properties.Resources.cassette1;

                                            if (NoOfwafer[i] == "1")
                                            {
                                                picwafer.Image = Properties.Resources.wafer;
                                                picwafer.Image.Tag = "wafer";
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                picwafer.Image = Properties.Resources.waferA1full;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                picwafer.Image = Properties.Resources.waferA2full;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                picwafer.Image = Properties.Resources.waferA3full;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                picwafer.Image = Properties.Resources.waferA4full;
                                            }
                                            else if (NoOfwafer[i] == "6")
                                            {
                                                picwafer.Image = Properties.Resources.waferA5full;

                                            }
                                            else if (NoOfwafer[i] == "7")
                                            {
                                                picwafer.Image = Properties.Resources.waferA6full;

                                            }
                                            else if (NoOfwafer[i] == "8")
                                            {
                                                picwafer.Image = Properties.Resources.waferA7full;

                                            }
                                            else if (NoOfwafer[i] == "9")
                                            {
                                                picwafer.Image = Properties.Resources.waferA8full;

                                            }
                                            else if (NoOfwafer[i] == "10")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }
                                            else if (NoOfwafer[i] == "11")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "12")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "13")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer14.Visible = false;
                                            }

                                            else if (NoOfwafer[i] == "15")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer15.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "16")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer15.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "17")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer17.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "18")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer18.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "19")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer19.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "20")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer20.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "21")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer21.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "22")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer22.Visible = false;
                                            }
                                            StartTime = DateTime.Now;




                                            await Task.Delay(2000);
                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "22");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();

                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "waferA22mainpicture";

                                            await Task.Delay(1000);
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA22mainpicture")
                                        {
                                            // lblCassette.BackColor = Color.LimeGreen;
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA22";
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA22")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA22";

                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A22";

                                            lblCassette.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA22")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA22";

                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A22";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA22")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA22";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A22";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA22")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA22-2";

                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A22";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA22-2")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA22";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A22";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA22" && picSV.Visible == true)
                                        {
                                            await Task.Delay(1000);


                                            picSV.Visible = false;  // open sv of chamber
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA22" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA22";

                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A22";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA22")
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;

                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA22";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA22")

                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA22 into Chamber
                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.ShowDialog();

                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                                //  await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                    // await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "22");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                                // cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                                //  Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                                cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }






                                            picMain.Image.Tag = "finishchamberA22";




                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }


                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA22" && picSV.Visible == true)
                                        {

                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA22" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA22-2";

                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA22-2")
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;

                                            picMain.Image.Tag = "picrobotAPMWaferA22-2";

                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA22-2" && picSV.Visible == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA22-2" && picSV.Visible == true)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA22-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA22-2")
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassettA22-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA22-2")
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "6")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "7")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "8")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "9")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "10")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "11")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "12")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "13")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;

                                            }
                                            if (NoOfwafer[i] == "15")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "16")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "17")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "18")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "19")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "20")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer20.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                                picWafer20.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "21")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer20.Visible = true;
                                                picWafer21.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                                picWafer20.Image = Properties.Resources.picWaferGreen;
                                                picWafer21.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "22")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer20.Visible = true;
                                                picWafer21.Visible = true;
                                                picWafer22.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                                picWafer20.Image = Properties.Resources.picWaferGreen;
                                                picWafer21.Image = Properties.Resources.picWaferGreen;
                                                picWafer22.Image = Properties.Resources.picWaferGreen;
                                            }

                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 22)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();

                                                lblState.Text = "Finished";



                                            }
                                            picMain.Image.Tag = "finishwaferA22";
                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;
                                                lblState.Text = "Stopping";
                                            }


                                        }
                                        /////////////////////////////////////////////////////////finish waferA22
                                    }


                                    if (int.Parse(NoOfwafer[i]) >= 23)
                                    {
                                        //////////////////////////////////////////////////////////////////////////start waferA23
                                        nooftherecipe = "23";
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA22" && isStopRobot == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            picCassette.Image = Properties.Resources.cassette1;

                                            if (NoOfwafer[i] == "1")
                                            {
                                                picwafer.Image = Properties.Resources.wafer;
                                                picwafer.Image.Tag = "wafer";
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                picwafer.Image = Properties.Resources.waferA1full;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                picwafer.Image = Properties.Resources.waferA2full;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                picwafer.Image = Properties.Resources.waferA3full;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                picwafer.Image = Properties.Resources.waferA4full;
                                            }
                                            else if (NoOfwafer[i] == "6")
                                            {
                                                picwafer.Image = Properties.Resources.waferA5full;

                                            }
                                            else if (NoOfwafer[i] == "7")
                                            {
                                                picwafer.Image = Properties.Resources.waferA6full;

                                            }
                                            else if (NoOfwafer[i] == "8")
                                            {
                                                picwafer.Image = Properties.Resources.waferA7full;

                                            }
                                            else if (NoOfwafer[i] == "9")
                                            {
                                                picwafer.Image = Properties.Resources.waferA8full;

                                            }
                                            else if (NoOfwafer[i] == "10")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }
                                            else if (NoOfwafer[i] == "11")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "12")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "13")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer14.Visible = false;
                                            }

                                            else if (NoOfwafer[i] == "15")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer15.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "16")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer15.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "17")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer17.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "18")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer18.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "19")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer19.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "20")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer20.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "21")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer21.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "22")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer22.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "23")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer22.Visible = false;
                                            }
                                            StartTime = DateTime.Now;




                                            await Task.Delay(2000);
                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "23");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();

                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "waferA23mainpicture";

                                            await Task.Delay(1000);
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA23mainpicture")
                                        {
                                            // lblCassette.BackColor = Color.LimeGreen;
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA23";
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA23")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA23";

                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A23";

                                            lblCassette.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA23")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA23";

                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A23";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA23")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA23";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A23";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA23")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA23-2";

                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A23";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA23-2")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA23";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A23";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA23" && picSV.Visible == true)
                                        {
                                            await Task.Delay(1000);


                                            picSV.Visible = false;  // open sv of chamber
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA23" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA23";

                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A23";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA23")
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;

                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA23";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA23")

                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA23 into Chamber
                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.ShowDialog();

                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                                //  await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                    // await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "23");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                                // cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                                //  Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                                cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }






                                            picMain.Image.Tag = "finishchamberA23";




                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }


                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA23" && picSV.Visible == true)
                                        {

                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA23" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA23-2";

                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA23-2")
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;

                                            picMain.Image.Tag = "picrobotAPMWaferA23-2";

                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA23-2" && picSV.Visible == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA23-2" && picSV.Visible == true)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA23-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA23-2")
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassettA23-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA23-2")
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "6")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "7")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "8")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "9")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "10")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "11")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "12")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "13")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;

                                            }
                                            if (NoOfwafer[i] == "15")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "16")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "17")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "18")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "19")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "20")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer20.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                                picWafer20.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "21")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer20.Visible = true;
                                                picWafer21.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                                picWafer20.Image = Properties.Resources.picWaferGreen;
                                                picWafer21.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "22")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer20.Visible = true;
                                                picWafer21.Visible = true;
                                                picWafer22.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                                picWafer20.Image = Properties.Resources.picWaferGreen;
                                                picWafer21.Image = Properties.Resources.picWaferGreen;
                                                picWafer22.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "23")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer20.Visible = true;
                                                picWafer21.Visible = true;
                                                picWafer22.Visible = true;
                                                picWafer23.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                                picWafer20.Image = Properties.Resources.picWaferGreen;
                                                picWafer21.Image = Properties.Resources.picWaferGreen;
                                                picWafer22.Image = Properties.Resources.picWaferGreen;
                                                picWafer23.Image = Properties.Resources.picWaferGreen;
                                            }

                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 23)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();

                                                lblState.Text = "Finished";



                                            }
                                            picMain.Image.Tag = "finishwaferA23";
                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;
                                                lblState.Text = "Stopping";
                                            }


                                        }
                                        /////////////////////////////////////////////////////////finish waferA23
                                    }

                                    if (int.Parse(NoOfwafer[i]) >= 24)
                                    {
                                        //////////////////////////////////////////////////////////////////////////start waferA24
                                        nooftherecipe = "24";
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA23" && isStopRobot == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            picCassette.Image = Properties.Resources.cassette1;

                                            if (NoOfwafer[i] == "1")
                                            {
                                                picwafer.Image = Properties.Resources.wafer;
                                                picwafer.Image.Tag = "wafer";
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                picwafer.Image = Properties.Resources.waferA1full;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                picwafer.Image = Properties.Resources.waferA2full;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                picwafer.Image = Properties.Resources.waferA3full;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                picwafer.Image = Properties.Resources.waferA4full;
                                            }
                                            else if (NoOfwafer[i] == "6")
                                            {
                                                picwafer.Image = Properties.Resources.waferA5full;

                                            }
                                            else if (NoOfwafer[i] == "7")
                                            {
                                                picwafer.Image = Properties.Resources.waferA6full;

                                            }
                                            else if (NoOfwafer[i] == "8")
                                            {
                                                picwafer.Image = Properties.Resources.waferA7full;

                                            }
                                            else if (NoOfwafer[i] == "9")
                                            {
                                                picwafer.Image = Properties.Resources.waferA8full;

                                            }
                                            else if (NoOfwafer[i] == "10")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }
                                            else if (NoOfwafer[i] == "11")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "12")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "13")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer14.Visible = false;
                                            }

                                            else if (NoOfwafer[i] == "15")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer15.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "16")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer15.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "17")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer17.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "18")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer18.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "19")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer19.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "20")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer20.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "21")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer21.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "22")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer22.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "23")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer23.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "24")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer24.Visible = false;
                                            }

                                            StartTime = DateTime.Now;




                                            await Task.Delay(2000);
                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "24");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();

                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "waferA24mainpicture";

                                            await Task.Delay(1000);
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA24mainpicture")
                                        {
                                            // lblCassette.BackColor = Color.LimeGreen;
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA24";
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA24")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA24";

                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A24";

                                            lblCassette.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA24")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA24";

                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A24";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA24")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA24";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A24";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA24")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA24-2";

                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A24";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA24-2")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA24";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A24";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA24" && picSV.Visible == true)
                                        {
                                            await Task.Delay(1000);


                                            picSV.Visible = false;  // open sv of chamber
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA24" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA24";

                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A24";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA24")
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;

                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA24";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA24")

                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA24 into Chamber
                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.ShowDialog();

                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                                //  await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                    // await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "24");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                                // cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                                //  Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                                cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }






                                            picMain.Image.Tag = "finishchamberA24";




                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }


                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA24" && picSV.Visible == true)
                                        {

                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA24" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA24-2";

                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA24-2")
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;

                                            picMain.Image.Tag = "picrobotAPMWaferA24-2";

                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA24-2" && picSV.Visible == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA24-2" && picSV.Visible == true)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA24-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA24-2")
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassettA24-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA24-2")
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "6")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "7")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "8")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "9")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "10")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "11")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "12")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "13")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;

                                            }
                                            if (NoOfwafer[i] == "15")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "16")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "17")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "18")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "19")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "20")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer20.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                                picWafer20.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "21")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer20.Visible = true;
                                                picWafer21.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                                picWafer20.Image = Properties.Resources.picWaferGreen;
                                                picWafer21.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "22")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer20.Visible = true;
                                                picWafer21.Visible = true;
                                                picWafer22.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                                picWafer20.Image = Properties.Resources.picWaferGreen;
                                                picWafer21.Image = Properties.Resources.picWaferGreen;
                                                picWafer22.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "23")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer20.Visible = true;
                                                picWafer21.Visible = true;
                                                picWafer22.Visible = true;
                                                picWafer23.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                                picWafer20.Image = Properties.Resources.picWaferGreen;
                                                picWafer21.Image = Properties.Resources.picWaferGreen;
                                                picWafer22.Image = Properties.Resources.picWaferGreen;
                                                picWafer23.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "24")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer20.Visible = true;
                                                picWafer21.Visible = true;
                                                picWafer22.Visible = true;
                                                picWafer23.Visible = true;
                                                picWafer24.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                                picWafer20.Image = Properties.Resources.picWaferGreen;
                                                picWafer21.Image = Properties.Resources.picWaferGreen;
                                                picWafer22.Image = Properties.Resources.picWaferGreen;
                                                picWafer23.Image = Properties.Resources.picWaferGreen;
                                                picWafer24.Image = Properties.Resources.picWaferGreen;
                                            }


                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 24)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();

                                                lblState.Text = "Finished";



                                            }
                                            picMain.Image.Tag = "finishwaferA24";
                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;
                                                lblState.Text = "Stopping";
                                            }


                                        }
                                        /////////////////////////////////////////////////////////finish waferA24
                                    }

                                    if (int.Parse(NoOfwafer[i]) >= 25)
                                    {
                                        //////////////////////////////////////////////////////////////////////////start waferA25
                                        nooftherecipe = "25";
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA24" && isStopRobot == false && iscancelrecipe == false)
                                        {
                                            await Task.Delay(2000);

                                            picCassette.Image = Properties.Resources.cassette1;

                                            if (NoOfwafer[i] == "1")
                                            {
                                                picwafer.Image = Properties.Resources.wafer;
                                                picwafer.Image.Tag = "wafer";
                                            }
                                            else if (NoOfwafer[i] == "2")
                                            {
                                                picwafer.Image = Properties.Resources.waferA1full;
                                            }
                                            else if (NoOfwafer[i] == "3")
                                            {
                                                picwafer.Image = Properties.Resources.waferA2full;

                                            }
                                            else if (NoOfwafer[i] == "4")
                                            {
                                                picwafer.Image = Properties.Resources.waferA3full;
                                            }
                                            else if (NoOfwafer[i] == "5")
                                            {
                                                picwafer.Image = Properties.Resources.waferA4full;
                                            }
                                            else if (NoOfwafer[i] == "6")
                                            {
                                                picwafer.Image = Properties.Resources.waferA5full;

                                            }
                                            else if (NoOfwafer[i] == "7")
                                            {
                                                picwafer.Image = Properties.Resources.waferA6full;

                                            }
                                            else if (NoOfwafer[i] == "8")
                                            {
                                                picwafer.Image = Properties.Resources.waferA7full;

                                            }
                                            else if (NoOfwafer[i] == "9")
                                            {
                                                picwafer.Image = Properties.Resources.waferA8full;

                                            }
                                            else if (NoOfwafer[i] == "10")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }
                                            else if (NoOfwafer[i] == "11")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "12")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "13")
                                            {
                                                picwafer.Image = Properties.Resources.waferA9full;

                                            }

                                            else if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer14.Visible = false;
                                            }

                                            else if (NoOfwafer[i] == "15")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer15.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "16")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer15.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "17")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer17.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "18")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer18.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "19")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer19.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "20")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer20.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "21")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer21.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "22")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer22.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "23")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer23.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "24")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer24.Visible = false;
                                            }
                                            else if (NoOfwafer[i] == "25")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA9full;
                                                picWafer25.Visible = false;
                                            }

                                            StartTime = DateTime.Now;




                                            await Task.Delay(2000);
                                            con.Open();

                                            string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                            SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                            cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "25");
                                            cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                            cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                            cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                            cmdwaferselection.ExecuteNonQuery();

                                            con.Close();

                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image.Tag = "waferA25mainpicture";

                                            await Task.Delay(1000);
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA25mainpicture")
                                        {
                                            // lblCassette.BackColor = Color.LimeGreen;
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassetteA25";
                                            label1.BackColor = Color.Blue;
                                            lblLoad.Text = "";
                                            lblLoad.BackColor = Color.Blue;
                                            lbl123.BackColor = Color.Blue;
                                            lblState.BackColor = Color.Blue;
                                            lblCassetteRecipename.BackColor = Color.Blue;
                                            lblmTorr.BackColor = Color.Blue;


                                            lblCassette.BackColor = Color.LimeGreen;

                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA25")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA25";

                                            lblwafer.Visible = true;
                                            lblwafer.Text = "A25";

                                            lblCassette.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA25")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA25";

                                            ovalShape1.Left += 70;
                                            ovalShape1.Top -= 85;
                                            lblwafer.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A25";
                                            lblwafer.Left += 70;
                                            lblwafer.Top -= 85;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA25")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                            picMain.Image.Tag = "picrobotintoAlignerWaferA25";
                                            lblCentralize.BackColor = Color.LimeGreen;
                                            ovalShape1.Left += 155;
                                            ovalShape1.Top += 0;
                                            lblwaferright.Visible = false;
                                            lblwaferaligner.Visible = true;
                                            lblwaferaligner.Text = "A25";
                                            lblwafer.Left += 155;
                                            lblwafer.Top += 0;

                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA25")
                                        {
                                            await Task.Delay(1000);
                                            picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                            picMain.Image.Tag = "picrobotAlignerWaferA25-2";

                                            lblwaferaligner.Visible = false;
                                            lblwaferright.Visible = true;
                                            lblwaferright.Text = "A25";
                                            ovalShape1.Left -= 155;
                                            ovalShape1.Top -= 0;
                                            lblwafer.Left -= 155;
                                            lblwafer.Top -= 0;
                                            lblCentralize.BackColor = Color.Blue;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA25-2")
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotAPMWafer;
                                            picMain.Image.Tag = "picrobotAPMWaferA25";
                                            lblwaferright.Visible = false;
                                            lblwaferup.Visible = true;
                                            lblwaferup.Text = "A25";
                                            ovalShape1.Left -= 82;
                                            ovalShape1.Top -= 76;
                                            lblwafer.Left -= 82;
                                            lblwafer.Top -= 76;
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA25" && picSV.Visible == true)
                                        {
                                            await Task.Delay(1000);


                                            picSV.Visible = false;  // open sv of chamber
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA25" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA25";

                                            lblwaferup.Visible = false;
                                            lblwaferAPM.Visible = true;
                                            lblwaferAPM.Text = "A25";
                                            ovalShape1.Top -= 145;
                                            ovalShape1.Left += 3;
                                            lblwafer.Top -= 145;
                                            lblwafer.Left += 3;



                                            lblChamber.BackColor = Color.LimeGreen;

                                            chamberload = "LimeGreen";
                                        }

                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA25")
                                        {
                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;

                                            //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picwaferinAPM;
                                            picMain.Image.Tag = "picwaferinAPMA25";
                                            ovalShape1.Left -= 1;
                                            ovalShape1.Left += 1;
                                            //  picMain.SendToBack();
                                            // ovalShape1.BringToFront();
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;


                                            //  pictRobot.Visible = true;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA25")

                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                            picSV.Visible = true;

                                            ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA25 into Chamber
                                            Chamber1 chamber1 = new Chamber1();
                                            chamber1.ShowDialog();

                                            lblRecipe.BackColor = Color.LimeGreen;
                                            lblStepName.BackColor = Color.LimeGreen;

                                            lblnum.BackColor = Color.LimeGreen;

                                            lblData.BackColor = Color.LimeGreen;
                                            lblData.Text = "";
                                            label2.BackColor = Color.LimeGreen;

                                            lblProcess.Text = "Processing";
                                            lblProcess.BackColor = Color.LimeGreen;
                                            lblProcessStep.Text = "Process Step";
                                            lblProcessStep.BackColor = Color.LimeGreen;



                                            con.Open();
                                            string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                            SqlCommand cmd = new SqlCommand(strSQL, con);
                                            cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                            SqlDataReader reader = cmd.ExecuteReader();
                                            while (reader.Read())
                                            {

                                                lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                            }

                                            con.Close();
                                            con.Open();
                                            string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                            SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                            cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                            SqlDataReader reader1 = cmd1.ExecuteReader();
                                            while (reader1.Read())
                                            {

                                                strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                            }

                                            con.Close();

                                            con.Open();
                                            string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                            SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                            cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                            cmd2.ExecuteNonQuery();



                                            for (int j = 0; j < strStepname1.Count(); j += 1)

                                            {

                                                //  await Task.Delay(1000);

                                                ListStepStartTime.Add(DateTime.Now);


                                                int count = j + 1;


                                                lblStepName.Text = strStepname1[j];
                                                lblnum.Text = "," + count + "/" + strStepname1.Count();


                                                con.Close();

                                                con.Open();
                                                string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                                SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                                cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                                SqlDataReader readerSec = cmdSec.ExecuteReader();


                                                while (readerSec.Read())
                                                {
                                                    mySec1 = readerSec["ProcessTime"].ToString();

                                                    Int32.TryParse(mySec1, out Sec1);

                                                }

                                                for (int k = 1; k <= Sec1; k++)
                                                {
                                                    lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                                    // await Task.Delay(1000);


                                                }
                                                ListStepEndTime.Add(DateTime.Now);

                                                con.Close();

                                                con.Open();

                                                string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                                SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                                cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                                cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                                cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "25");
                                                cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                                // cmdmodulerecipe.ExecuteNonQuery();

                                                con.Close();
                                                //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                                con.Open();

                                                string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                                SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                                cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                                cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                                SqlDataReader reader2 = cmd3.ExecuteReader();

                                                while (reader2.Read())
                                                {
                                                    CI2 = reader2["CI2"].ToString();
                                                    BCI3 = reader2["BCI3"].ToString();
                                                    SF6 = reader2["SF6"].ToString();
                                                    CHF3 = reader2["CHF3"].ToString();
                                                    Oxygen = reader2["Oxygen"].ToString();
                                                    Oxygen1 = reader2["Oxygen1"].ToString();
                                                    Nitrogen = reader2["Nitrogen"].ToString();
                                                    Argon = reader2["Argon"].ToString();



                                                }

                                                con.Close();

                                                ///////////////////////////////////////////////////////////////////////////////////////////////////
                                                con.Open();
                                                //  Chamber1 chamber1 = new Chamber1();

                                                string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                                    + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                                SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                                cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                                cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                                cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                                cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                                cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                                cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                                cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                                cmdparameter.Parameters.AddWithValue("@21", CI2);
                                                cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@23", SF6);
                                                cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@28", Argon);
                                                cmdparameter.Parameters.AddWithValue("@31", CI2);
                                                cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@33", SF6);
                                                cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@38", Argon);
                                                cmdparameter.Parameters.AddWithValue("@41", CI2);
                                                cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                                cmdparameter.Parameters.AddWithValue("@43", SF6);
                                                cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                                cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                                cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                                cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                                cmdparameter.Parameters.AddWithValue("@48", Argon);
                                                cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                                cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                                cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                                cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                                cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                                cmdparameter.ExecuteNonQuery();
                                                con.Close();

                                            }
                                            ///////////////////////////////////////////////


                                            strStepname1.Clear();
                                            ListStepStartTime.Clear();
                                            ListStepEndTime.Clear();

                                            // }






                                            picMain.Image.Tag = "finishchamberA25";




                                            /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                        }


                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA25" && picSV.Visible == true)
                                        {

                                            await Task.Delay(1000);
                                            picChamber.Image = Properties.Resources.ChamberWithA1;
                                            //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                            picSV.Visible = false;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA25" && picSV.Visible == false)
                                        {
                                            await Task.Delay(1000);

                                            picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                            picMain.Image = Properties.Resources.picrobotintochamber;
                                            picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                            picMain.Image.Tag = "picrobotintoAPMWaferA25-2";

                                            ovalShape1.Left += 1;
                                            ovalShape1.Left -= 1;
                                            picChamber.Width += 140;
                                            picChamber.Left -= 150;
                                            picChamber.Height += 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA25-2")
                                        {
                                            await Task.Delay(1000);
                                            label2.BackColor = Color.Blue;
                                            lblProcess.BackColor = Color.Blue;
                                            lblProcessStep.BackColor = Color.Blue;
                                            lblRecipe.BackColor = Color.Blue;
                                            lblStepName.BackColor = Color.Blue;
                                            lblData.BackColor = Color.Blue;
                                            lblnum.BackColor = Color.Blue;

                                            lblProcess.Text = "Idle";
                                            lblProcessStep.Text = "";
                                            lblRecipe.Text = "";
                                            lblStepName.Text = "";
                                            lblnum.Text = "";
                                            lblData.Text = "";


                                            // pictRobot.Visible = true;

                                            picChamber.Image = Properties.Resources.new_chamber1;
                                            picMain.Image = Properties.Resources.picrobotbotton;
                                            picMain.Image = Properties.Resources.picrobotAPMWafer;

                                            picMain.Image.Tag = "picrobotAPMWaferA25-2";

                                            lblwaferAPM.Visible = false;
                                            lblwaferup.Visible = true;

                                            ovalShape1.Top += 145;
                                            ovalShape1.Left -= 3;
                                            lblwafer.Top += 145;
                                            lblwafer.Left -= 3;

                                            lblChamber.BackColor = Color.Blue;
                                            chamberload = "Blue";
                                            picChamber.Width -= 140;
                                            picChamber.Left += 150;
                                            picChamber.Height -= 10;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA25-2" && picSV.Visible == false)
                                        {
                                            await Task.Delay(2000);
                                            picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                            // picMain.Image = Properties.Resources.robotrightA1;
                                            picSV.Visible = true;


                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA25-2" && picSV.Visible == true)
                                        {
                                            await Task.Delay(2000);

                                            // pictRobot.Height += 20;

                                            // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                            picMain.Image = Properties.Resources.mainpicture;
                                            picMain.Image = Properties.Resources.picrobotArmWafer;
                                            picMain.Image.Tag = "picrobotArmWaferA25-2";
                                            lblwaferup.Visible = false;
                                            lblwafer.Visible = true;
                                            ovalShape1.Top += 162;
                                            lblwafer.Top += 162;
                                            ovalShape1.Left += 12;
                                            lblwafer.Left += 12;
                                            await Task.Delay(2000);

                                            await Task.Delay(1000);
                                            picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                               // picMain.Image = Properties.Resources.robotgetwaferA1;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA25-2")
                                        {
                                            await Task.Delay(1000);

                                            lblCassette.BackColor = Color.LimeGreen;

                                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                            picMain.Image = Properties.Resources.picrobotintocassette;
                                            picMain.Image.Tag = "picrobotintocassettA25-2";
                                            lblwafer.Visible = false;
                                            lblwafer.Visible = false;
                                            ovalShape1.Visible = false;
                                            picCassette.Height += 220;
                                            picCassette.Width += 25;
                                            picCassette.Top -= 205;
                                        }
                                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA25-2")
                                        {
                                            await Task.Delay(2000);
                                            lblCassette.BackColor = Color.Blue;
                                            //  pictRobot.Visible = true;

                                            picMain.Image = Properties.Resources.mainpicture;
                                            picCassette.Image = Properties.Resources.cassette3;
                                            picCassette.Width -= 25;
                                            picCassette.Height -= 220;
                                            picCassette.Top += 205;
                                            await Task.Delay(2000);
                                            //  picMain.Image = Properties.Resources.mainpic;
                                            picCassette.Image = Properties.Resources.cassette;
                                            // picwafer.Image = Properties.Resources.waferfull;
                                            if (NoOfwafer[i] == "1")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA1full;
                                                picWafer1.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "2")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA2full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "3")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA3full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                            }
                                            if (NoOfwafer[i] == "4")
                                            {
                                                // picwafer.Image = Properties.Resources.waferA4full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "5")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "6")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "7")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "8")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "9")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "10")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "11")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "12")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "13")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "14")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;

                                            }
                                            if (NoOfwafer[i] == "15")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "16")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "17")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "18")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "19")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "20")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer20.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                                picWafer20.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "21")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer20.Visible = true;
                                                picWafer21.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                                picWafer20.Image = Properties.Resources.picWaferGreen;
                                                picWafer21.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "22")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer20.Visible = true;
                                                picWafer21.Visible = true;
                                                picWafer22.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                                picWafer20.Image = Properties.Resources.picWaferGreen;
                                                picWafer21.Image = Properties.Resources.picWaferGreen;
                                                picWafer22.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "23")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer20.Visible = true;
                                                picWafer21.Visible = true;
                                                picWafer22.Visible = true;
                                                picWafer23.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                                picWafer20.Image = Properties.Resources.picWaferGreen;
                                                picWafer21.Image = Properties.Resources.picWaferGreen;
                                                picWafer22.Image = Properties.Resources.picWaferGreen;
                                                picWafer23.Image = Properties.Resources.picWaferGreen;
                                            }

                                            if (NoOfwafer[i] == "24")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer20.Visible = true;
                                                picWafer21.Visible = true;
                                                picWafer22.Visible = true;
                                                picWafer23.Visible = true;
                                                picWafer24.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                                picWafer20.Image = Properties.Resources.picWaferGreen;
                                                picWafer21.Image = Properties.Resources.picWaferGreen;
                                                picWafer22.Image = Properties.Resources.picWaferGreen;
                                                picWafer23.Image = Properties.Resources.picWaferGreen;
                                                picWafer24.Image = Properties.Resources.picWaferGreen;
                                            }
                                            if (NoOfwafer[i] == "25")
                                            {
                                                //  picwafer.Image = Properties.Resources.waferA5full;
                                                picWafer1.Visible = true;
                                                picWafer2.Visible = true;
                                                picWafer3.Visible = true;
                                                picWafer4.Visible = true;
                                                picWafer5.Visible = true;
                                                picWafer6.Visible = true;
                                                picWafer7.Visible = true;
                                                picWafer8.Visible = true;
                                                picWafer9.Visible = true;
                                                picWafer10.Visible = true;
                                                picWafer11.Visible = true;
                                                picWafer12.Visible = true;
                                                picWafer13.Visible = true;
                                                picWafer14.Visible = true;
                                                picWafer15.Visible = true;
                                                picWafer16.Visible = true;
                                                picWafer17.Visible = true;
                                                picWafer18.Visible = true;
                                                picWafer19.Visible = true;
                                                picWafer20.Visible = true;
                                                picWafer21.Visible = true;
                                                picWafer22.Visible = true;
                                                picWafer23.Visible = true;
                                                picWafer24.Visible = true;
                                                picWafer25.Visible = true;
                                                picWafer2.Image = Properties.Resources.picWaferGreen;
                                                picWafer1.Image = Properties.Resources.picWaferGreen;
                                                picWafer3.Image = Properties.Resources.picWaferGreen;
                                                picWafer4.Image = Properties.Resources.picWaferGreen;
                                                picWafer5.Image = Properties.Resources.picWaferGreen;
                                                picWafer6.Image = Properties.Resources.picWaferGreen;
                                                picWafer7.Image = Properties.Resources.picWaferGreen;
                                                picWafer8.Image = Properties.Resources.picWaferGreen;
                                                picWafer9.Image = Properties.Resources.picWaferGreen;
                                                picWafer10.Image = Properties.Resources.picWaferGreen;
                                                picWafer11.Image = Properties.Resources.picWaferGreen;
                                                picWafer12.Image = Properties.Resources.picWaferGreen;
                                                picWafer13.Image = Properties.Resources.picWaferGreen;
                                                picWafer14.Image = Properties.Resources.picWaferGreen;
                                                picWafer15.Image = Properties.Resources.picWaferGreen;
                                                picWafer16.Image = Properties.Resources.picWaferGreen;
                                                picWafer17.Image = Properties.Resources.picWaferGreen;
                                                picWafer18.Image = Properties.Resources.picWaferGreen;
                                                picWafer19.Image = Properties.Resources.picWaferGreen;
                                                picWafer20.Image = Properties.Resources.picWaferGreen;
                                                picWafer21.Image = Properties.Resources.picWaferGreen;
                                                picWafer22.Image = Properties.Resources.picWaferGreen;
                                                picWafer23.Image = Properties.Resources.picWaferGreen;
                                                picWafer24.Image = Properties.Resources.picWaferGreen;
                                                picWafer25.Image = Properties.Resources.picWaferGreen;
                                            }


                                            //////////////////////////////////////////////////////////////////Save DataLog
                                            if (int.Parse(NoOfwafer[i]) == 25)
                                            {
                                                EndTime = DateTime.Now;


                                                con.Open();

                                                string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                                SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                                cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                                cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                                cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                                cmdinsertdatalog.ExecuteNonQuery();

                                                con.Close();

                                                lblState.Text = "Finished";



                                            }
                                            picMain.Image.Tag = "finishwaferA25";
                                            if (isStopRobot == true)
                                            {
                                                button2.Enabled = true;
                                                lblState.Text = "Stopping";
                                            }


                                        }
                                        /////////////////////////////////////////////////////////finish waferA25
                                    }




                                }
                            }
                            if(ispauserobot==true)

                            {
                                button3.Enabled = false;
                                button4.Enabled = false;
                                button5.Enabled = false;

                                return;

                           }
                            if(isStopRobot==true)
                            {

                               

                                return;
                                    
                                    }

                            if (iscancelrecipe == true)
                            {

                               
                                picMain.Image = Properties.Resources.mainpicture;

                                button3.Enabled = false;
                                button4.Enabled = false;
                                button5.Enabled = false;

                                lblwafer.Visible = false;
                                lblwaferup.Visible = false;
                                lblwaferaligner.Visible = false;
                                lblwaferright.Visible = false;
                                lblwaferAPM.Visible = false;

                                lblState.Text = "";
                                lblnum.Text = "";
                                lblStepName.Text = "";
                                lblRecipe.Text = "";
                                lblProcessStep.Text = "";
                                lblProcess.Text = "idle";

                                button2.Enabled = true;
                                button2.Tag = "";

                                picmap.Visible = false;
                                picmap1.Visible = false;
                                lbl123.Text = "";
                                lblCassetteRecipename.Text = "";

                                picWafer1.Visible = false;
                                picWafer2.Visible = false;
                                picWafer3.Visible = false;
                                picWafer4.Visible = false;
                                picWafer5.Visible = false;
                                picWafer6.Visible = false;
                                picWafer7.Visible = false;
                                picWafer8.Visible = false;
                                picWafer9.Visible = false;
                                picWafer10.Visible = false;
                                picWafer11.Visible = false;
                                picWafer12.Visible = false;
                                picWafer13.Visible = false;
                                picWafer14.Visible = false;
                                picWafer15.Visible = false;
                                picWafer16.Visible = false;
                                picWafer17.Visible = false;
                                picWafer18.Visible = false;
                                picWafer19.Visible = false;
                                picWafer20.Visible = false;
                                picWafer21.Visible = false;
                                picWafer22.Visible = false;
                                picWafer23.Visible = false;
                                picWafer24.Visible = false;
                                picWafer25.Visible = false;


                                lblProcess.Text = "Idle"; 
                                    lbltm.Text = "Idle";

                                //   lblLoad.Text = "Aborted";
                                lblLoad.Text = "Selected recipe:" + form2Msg;
                                picMain.Image.Tag = "mainpicture";

                                return;
                            }



                        }
                    }

                    else
                    {

                        MessageBox.Show("APM and TM are not idle");
                    }


                }
                else
                {
                    MessageBox.Show("Transport not in Automatic");

                }
            }
            if (button2.Tag.ToString() == "robotPause")
            {

                button3.Enabled = true;
                button4.Enabled = true;
                button5.Enabled = true;



                PauseAndStopRobot resumerobot = new PauseAndStopRobot();
                resumerobot.label1.Text = "Do you want to resume the recipe?";
                DialogResult dr = resumerobot.ShowDialog();

                if (dr == DialogResult.OK)

                {

                    scsb = new SqlConnectionStringBuilder();
                    scsb.DataSource = datasource;
                    scsb.InitialCatalog = "RecipeType";
                    scsb.IntegratedSecurity = true;
                    SqlConnection con = new SqlConnection(scsb.ToString());

                    con.Open();

                    SqlCommand cmdeventlog = new SqlCommand(strEvent,con);

                    cmdeventlog.Parameters.AddWithValue("@1",DateTime.Now);
                    cmdeventlog.Parameters.AddWithValue("@2", "Resume robot");
                    cmdeventlog.Parameters.AddWithValue("@3", "Resume robot");

                    cmdeventlog.ExecuteNonQuery();

                    con.Close();

                    ispauserobot = false;

                    isStopRobot = false;


                    restartrobot();

                    button2.Enabled = false;
                }
            }
            if(button2.Tag.ToString()== "robotRestart")
            {

                PauseAndStopRobot restartrobot1 = new PauseAndStopRobot();
                restartrobot1.label1.Text = "Do you want to restart the recipe?";
                DialogResult dr = restartrobot1.ShowDialog();

                

                if (dr == DialogResult.OK)

                {
                    scsb = new SqlConnectionStringBuilder();
                    scsb.DataSource = datasource;
                    scsb.InitialCatalog = "RecipeType";
                    scsb.IntegratedSecurity = true;
                    SqlConnection con = new SqlConnection(scsb.ToString());

                    con.Open();

                    SqlCommand cmdeventlog = new SqlCommand(strEvent, con);

                    cmdeventlog.Parameters.AddWithValue("@1", DateTime.Now);
                    cmdeventlog.Parameters.AddWithValue("@2", "Restart robot");
                    cmdeventlog.Parameters.AddWithValue("@3", "Restart robot");

                    cmdeventlog.ExecuteNonQuery();

                    con.Close();






                    ispauserobot = false;

                    isStopRobot = false;


                    restartrobot();

                    button2.Enabled = false;
                }




            }

        }



        private async void restartrobot()
        {
            //       pauseSignal = new ManualResetEvent(false);




            if (btnVCH.Text == "Control Mode: Automatic")

            {

                if (lblProcess.Text == "Idle" && lbltm.Text == "Idle")
                    
                {




                    scsb = new SqlConnectionStringBuilder();
                    scsb.DataSource = datasource;
                    scsb.InitialCatalog = "RecipeType";
                    scsb.IntegratedSecurity = true;
                    SqlConnection con = new SqlConnection(scsb.ToString());
                    con.Open();

                    button3.Enabled = true;
                    button4.Enabled = true;
                    button5.Enabled = true;

                    iscancelrecipe = false;
                    if (ispauserobot == false)
                    {

                        //   pauseSignal = new ManualResetEvent(true);
                        //   taskTimer = new Task(timerCallback);
                        //  taskTimer.Start();
                        //    await taskTimer;


                        button2.Enabled = false;
                        //  button2.Tag = "robotStart";


                        /*   con.Open();
                           string SQLeventlog = "insert into EventLog (Date,Event,Info) values(@1,@2,@3)";

                           SqlCommand cmdeventlog = new SqlCommand(SQLeventlog,con);
                           cmdeventlog.Parameters.AddWithValue("@1",DateTime.Now);
                           cmdeventlog.Parameters.AddWithValue("@2", "");
                           cmdeventlog.Parameters.AddWithValue("@3", "");
                           con.Close();*/

                        con.Open();
                        string SQLnoofwafer = "select noofwafers from cassettewafer where cassetterecipename like @searchcassetterecipename";
                        SqlCommand cmdnoofwafer = new SqlCommand(SQLnoofwafer, con);
                        cmdnoofwafer.Parameters.AddWithValue("@searchcassetterecipename", form2Msg);
                        SqlDataReader readernoofwafer = cmdnoofwafer.ExecuteReader();
                        while (readernoofwafer.Read())
                        {
                            NoOfwafer.Add(readernoofwafer["noofwafers"].ToString());

                        }
                        con.Close();
                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "mainpicture" && iscancelrecipe == false)
                        {
                            await Task.Delay(1000);

                            con.Open();

                            SqlCommand cmdevent = new SqlCommand(strEvent, con);
                            cmdevent.Parameters.AddWithValue("@1", DateTime.Now);
                            cmdevent.Parameters.AddWithValue("@2", "Machine robot reversal");
                            cmdevent.Parameters.AddWithValue("@3", "reverse the robot");

                            cmdevent.ExecuteNonQuery();

                            con.Close();

                            picMain.Image = Properties.Resources.picrobotbotton;
                            picMain.Image.Tag = "picrobotbotton";
                        }
                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotbotton" && iscancelrecipe == false)
                        {
                            await Task.Delay(1000);
                            /////////////////////////////////////////////////////////////////////////////////////開始掃描Wafers

                            picMain.Image = Properties.Resources.picrobotanalysis;
                            picMain.Image.Tag = "picrobotanalysis";

                            lblLoad.Text = "Loading";
                            lblLoad.BackColor = Color.LimeGreen;
                            lblmTorr.BackColor = Color.LimeGreen;
                            str123 = lot.getLotID();
                            lbl123.Text = lot.getLotID();
                            lbl123.BackColor = Color.LimeGreen;
                            lblCassetteRecipename.Text = form2Msg;
                            lblCassetteRecipename.BackColor = Color.LimeGreen;
                            lblState.Text = "Starting";
                            lblState.BackColor = Color.LimeGreen;
                            label1.BackColor = Color.LimeGreen;
                            //  label1.Text = "Analysising.....";
                            // label1.Font = new Font("微軟正黑體", 10);

                            await Task.Delay(1000);

                            picmap.Visible = true;

                            for (int i = 1; i <= 24; i++)
                            {
                                await Task.Delay(50);
                                picmap.Top -= 13;
                            }

                            picmap.Visible = false;

                            picmap.Top += 312;

                            await Task.Delay(1000);

                            picmap1.Visible = true;
                            for (int j = 1; j <= 24; j++)
                            {
                                await Task.Delay(50);
                                picmap1.Top += 13;
                            }
                            picmap1.Visible = false;
                            picmap1.Top -= 312;
                            await Task.Delay(1000);



                        }
                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotanalysis" && iscancelrecipe == false)
                        {
                            await Task.Delay(1000);

                            picMain.Image = Properties.Resources.picrobotbotton;
                            label1.Text = "";
                            picMain.Image.Tag = "picrobotbotton2";

                            //    picwafer.Image = Properties.Resources.waferfull;
                            //  picwafer.Image.Tag = "waferfull";

                            foreach (string i in NoOfwafer)
                            {
                                if (i == "1")
                                {

                                    //  picwafer.Image = Properties.Resources.waferA1full;
                                    picWafer1.Visible = false;
                                    picWafer2.Visible = false;
                                    picWafer3.Visible = false;
                                    picWafer4.Visible = false;
                                    picWafer5.Visible = false;
                                    picWafer6.Visible = false;
                                    picWafer7.Visible = false;
                                    picWafer8.Visible = false;
                                    picWafer9.Visible = false;
                                    picWafer10.Visible = false;
                                    picWafer11.Visible = false;
                                    picWafer12.Visible = false;
                                    picWafer13.Visible = false;
                                    picWafer14.Visible = false;
                                    picWafer15.Visible = false;
                                    picWafer16.Visible = false;
                                    picWafer17.Visible = false;
                                    picWafer18.Visible = false;
                                    picWafer19.Visible = false;
                                    picWafer20.Visible = false;
                                    picWafer21.Visible = false;
                                    picWafer22.Visible = false;
                                    picWafer23.Visible = false;
                                    picWafer24.Visible = false;
                                    picWafer25.Visible = false;



                                    picWafer1.Visible = true;

                                }

                                else if (i == "2")
                                {
                                    //    picwafer.Image = Properties.Resources.waferA2full;
                                    picWafer1.Visible = false;
                                    picWafer2.Visible = false;
                                    picWafer3.Visible = false;
                                    picWafer4.Visible = false;
                                    picWafer5.Visible = false;
                                    picWafer6.Visible = false;
                                    picWafer7.Visible = false;
                                    picWafer8.Visible = false;
                                    picWafer9.Visible = false;
                                    picWafer10.Visible = false;
                                    picWafer11.Visible = false;
                                    picWafer12.Visible = false;
                                    picWafer13.Visible = false;
                                    picWafer14.Visible = false;
                                    picWafer15.Visible = false;
                                    picWafer16.Visible = false;
                                    picWafer17.Visible = false;
                                    picWafer18.Visible = false;
                                    picWafer19.Visible = false;
                                    picWafer20.Visible = false;
                                    picWafer21.Visible = false;
                                    picWafer22.Visible = false;
                                    picWafer23.Visible = false;
                                    picWafer24.Visible = false;
                                    picWafer25.Visible = false;


                                    picWafer1.Visible = true;
                                    picWafer2.Visible = true;

                                }

                                else if (i == "3")
                                {
                                    // picwafer.Image = Properties.Resources.waferA3full;
                                    picWafer1.Visible = false;
                                    picWafer2.Visible = false;
                                    picWafer3.Visible = false;
                                    picWafer4.Visible = false;
                                    picWafer5.Visible = false;
                                    picWafer6.Visible = false;
                                    picWafer7.Visible = false;
                                    picWafer8.Visible = false;
                                    picWafer9.Visible = false;
                                    picWafer10.Visible = false;
                                    picWafer11.Visible = false;
                                    picWafer12.Visible = false;
                                    picWafer13.Visible = false;
                                    picWafer14.Visible = false;
                                    picWafer15.Visible = false;
                                    picWafer16.Visible = false;
                                    picWafer17.Visible = false;
                                    picWafer18.Visible = false;
                                    picWafer19.Visible = false;
                                    picWafer20.Visible = false;
                                    picWafer21.Visible = false;
                                    picWafer22.Visible = false;
                                    picWafer23.Visible = false;
                                    picWafer24.Visible = false;
                                    picWafer25.Visible = false;




                                    picWafer1.Visible = true;
                                    picWafer2.Visible = true;
                                    picWafer3.Visible = true;
                                }
                                else if (i == "4")
                                {
                                    //picwafer.Image = Properties.Resources.waferA4full;
                                    picWafer1.Visible = false;
                                    picWafer2.Visible = false;
                                    picWafer3.Visible = false;
                                    picWafer4.Visible = false;
                                    picWafer5.Visible = false;
                                    picWafer6.Visible = false;
                                    picWafer7.Visible = false;
                                    picWafer8.Visible = false;
                                    picWafer9.Visible = false;
                                    picWafer10.Visible = false;
                                    picWafer11.Visible = false;
                                    picWafer12.Visible = false;
                                    picWafer13.Visible = false;
                                    picWafer14.Visible = false;
                                    picWafer15.Visible = false;
                                    picWafer16.Visible = false;
                                    picWafer17.Visible = false;
                                    picWafer18.Visible = false;
                                    picWafer19.Visible = false;
                                    picWafer20.Visible = false;
                                    picWafer21.Visible = false;
                                    picWafer22.Visible = false;
                                    picWafer23.Visible = false;
                                    picWafer24.Visible = false;
                                    picWafer25.Visible = false;



                                    picWafer1.Visible = true;
                                    picWafer2.Visible = true;
                                    picWafer3.Visible = true;
                                    picWafer4.Visible = true;
                                }
                                else if (i == "5")
                                {
                                    // picwafer.Image = Properties.Resources.waferA5full;
                                    picWafer1.Visible = false;
                                    picWafer2.Visible = false;
                                    picWafer3.Visible = false;
                                    picWafer4.Visible = false;
                                    picWafer5.Visible = false;
                                    picWafer6.Visible = false;
                                    picWafer7.Visible = false;
                                    picWafer8.Visible = false;
                                    picWafer9.Visible = false;
                                    picWafer10.Visible = false;
                                    picWafer11.Visible = false;
                                    picWafer12.Visible = false;
                                    picWafer13.Visible = false;
                                    picWafer14.Visible = false;
                                    picWafer15.Visible = false;
                                    picWafer16.Visible = false;
                                    picWafer17.Visible = false;
                                    picWafer18.Visible = false;
                                    picWafer19.Visible = false;
                                    picWafer20.Visible = false;
                                    picWafer21.Visible = false;
                                    picWafer22.Visible = false;
                                    picWafer23.Visible = false;
                                    picWafer24.Visible = false;
                                    picWafer25.Visible = false;




                                    picWafer1.Visible = true;
                                    picWafer2.Visible = true;
                                    picWafer3.Visible = true;
                                    picWafer4.Visible = true;
                                    picWafer5.Visible = true;
                                }
                                else if (i == "6")
                                {
                                    //  picwafer.Image = Properties.Resources.waferA6full;
                                    picWafer1.Visible = false;
                                    picWafer2.Visible = false;
                                    picWafer3.Visible = false;
                                    picWafer4.Visible = false;
                                    picWafer5.Visible = false;
                                    picWafer6.Visible = false;
                                    picWafer7.Visible = false;
                                    picWafer8.Visible = false;
                                    picWafer9.Visible = false;
                                    picWafer10.Visible = false;
                                    picWafer11.Visible = false;
                                    picWafer12.Visible = false;
                                    picWafer13.Visible = false;
                                    picWafer14.Visible = false;
                                    picWafer15.Visible = false;
                                    picWafer16.Visible = false;
                                    picWafer17.Visible = false;
                                    picWafer18.Visible = false;
                                    picWafer19.Visible = false;
                                    picWafer20.Visible = false;
                                    picWafer21.Visible = false;
                                    picWafer22.Visible = false;
                                    picWafer23.Visible = false;
                                    picWafer24.Visible = false;
                                    picWafer25.Visible = false;





                                    picWafer1.Visible = true;
                                    picWafer2.Visible = true;
                                    picWafer3.Visible = true;
                                    picWafer4.Visible = true;
                                    picWafer5.Visible = true;
                                    picWafer6.Visible = true;
                                }
                                else if (i == "7")
                                {

                                    // picwafer.Image = Properties.Resources.waferA7full;

                                    picWafer1.Visible = false;
                                    picWafer2.Visible = false;
                                    picWafer3.Visible = false;
                                    picWafer4.Visible = false;
                                    picWafer5.Visible = false;
                                    picWafer6.Visible = false;
                                    picWafer7.Visible = false;
                                    picWafer8.Visible = false;
                                    picWafer9.Visible = false;
                                    picWafer10.Visible = false;
                                    picWafer11.Visible = false;
                                    picWafer12.Visible = false;
                                    picWafer13.Visible = false;
                                    picWafer14.Visible = false;
                                    picWafer15.Visible = false;
                                    picWafer16.Visible = false;
                                    picWafer17.Visible = false;
                                    picWafer18.Visible = false;
                                    picWafer19.Visible = false;
                                    picWafer20.Visible = false;
                                    picWafer21.Visible = false;
                                    picWafer22.Visible = false;
                                    picWafer23.Visible = false;
                                    picWafer24.Visible = false;
                                    picWafer25.Visible = false;




                                    picWafer1.Visible = true;
                                    picWafer2.Visible = true;
                                    picWafer3.Visible = true;
                                    picWafer4.Visible = true;
                                    picWafer5.Visible = true;
                                    picWafer6.Visible = true;
                                    picWafer7.Visible = true;
                                }
                                else if (i == "8")
                                {

                                    // picwafer.Image = Properties.Resources.waferA8full;
                                    picWafer1.Visible = false;
                                    picWafer2.Visible = false;
                                    picWafer3.Visible = false;
                                    picWafer4.Visible = false;
                                    picWafer5.Visible = false;
                                    picWafer6.Visible = false;
                                    picWafer7.Visible = false;
                                    picWafer8.Visible = false;
                                    picWafer9.Visible = false;
                                    picWafer10.Visible = false;
                                    picWafer11.Visible = false;
                                    picWafer12.Visible = false;
                                    picWafer13.Visible = false;
                                    picWafer14.Visible = false;
                                    picWafer15.Visible = false;
                                    picWafer16.Visible = false;
                                    picWafer17.Visible = false;
                                    picWafer18.Visible = false;
                                    picWafer19.Visible = false;
                                    picWafer20.Visible = false;
                                    picWafer21.Visible = false;
                                    picWafer22.Visible = false;
                                    picWafer23.Visible = false;
                                    picWafer24.Visible = false;
                                    picWafer25.Visible = false;




                                    picWafer1.Visible = true;
                                    picWafer2.Visible = true;
                                    picWafer3.Visible = true;
                                    picWafer4.Visible = true;
                                    picWafer5.Visible = true;
                                    picWafer6.Visible = true;
                                    picWafer7.Visible = true;
                                    picWafer8.Visible = true;

                                }
                                else if (i == "9")
                                {
                                    //  picwafer.Image = Properties.Resources.waferA9full;
                                    picWafer1.Visible = false;
                                    picWafer2.Visible = false;
                                    picWafer3.Visible = false;
                                    picWafer4.Visible = false;
                                    picWafer5.Visible = false;
                                    picWafer6.Visible = false;
                                    picWafer7.Visible = false;
                                    picWafer8.Visible = false;
                                    picWafer9.Visible = false;
                                    picWafer10.Visible = false;
                                    picWafer11.Visible = false;
                                    picWafer12.Visible = false;
                                    picWafer13.Visible = false;
                                    picWafer14.Visible = false;
                                    picWafer15.Visible = false;
                                    picWafer16.Visible = false;
                                    picWafer17.Visible = false;
                                    picWafer18.Visible = false;
                                    picWafer19.Visible = false;
                                    picWafer20.Visible = false;
                                    picWafer21.Visible = false;
                                    picWafer22.Visible = false;
                                    picWafer23.Visible = false;
                                    picWafer24.Visible = false;
                                    picWafer25.Visible = false;




                                    picWafer1.Visible = true;
                                    picWafer2.Visible = true;
                                    picWafer3.Visible = true;
                                    picWafer4.Visible = true;
                                    picWafer5.Visible = true;
                                    picWafer6.Visible = true;
                                    picWafer7.Visible = true;
                                    picWafer8.Visible = true;
                                    picWafer9.Visible = true;
                                }
                                else if (i == "10")
                                {
                                    // picwafer.Image = Properties.Resources.waferA10full;
                                    picWafer1.Visible = false;
                                    picWafer2.Visible = false;
                                    picWafer3.Visible = false;
                                    picWafer4.Visible = false;
                                    picWafer5.Visible = false;
                                    picWafer6.Visible = false;
                                    picWafer7.Visible = false;
                                    picWafer8.Visible = false;
                                    picWafer9.Visible = false;
                                    picWafer10.Visible = false;
                                    picWafer11.Visible = false;
                                    picWafer12.Visible = false;
                                    picWafer13.Visible = false;
                                    picWafer14.Visible = false;
                                    picWafer15.Visible = false;
                                    picWafer16.Visible = false;
                                    picWafer17.Visible = false;
                                    picWafer18.Visible = false;
                                    picWafer19.Visible = false;
                                    picWafer20.Visible = false;
                                    picWafer21.Visible = false;
                                    picWafer22.Visible = false;
                                    picWafer23.Visible = false;
                                    picWafer24.Visible = false;
                                    picWafer25.Visible = false;





                                    picWafer1.Visible = true;
                                    picWafer2.Visible = true;
                                    picWafer3.Visible = true;
                                    picWafer4.Visible = true;
                                    picWafer5.Visible = true;
                                    picWafer6.Visible = true;
                                    picWafer7.Visible = true;
                                    picWafer8.Visible = true;
                                    picWafer9.Visible = true;
                                    picWafer10.Visible = true;


                                }

                            }


                        }

                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotbotton2" && iscancelrecipe == false)
                        {
                            await Task.Delay(1000);

                            // pictRobot.Visible = true;
                            // picCassette.Image = Properties.Resources.cassette1;
                            // picCassette.Height -= 150;
                            // picCassette.Top += 150;
                            lblCassette.BackColor = Color.Blue;
                            lblCassette.Tag = "Blue";
                            // lblCassette.Text = "Cassette";

                        }

                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotbotton2" && lblCassette.Tag.ToString() == "Blue" && iscancelrecipe == false)
                        {
                            await Task.Delay(1000);

                            //pictRobot.Image = Properties.Resources.new_robot;
                            picMain.Image = Properties.Resources.mainpicture;
                            picMain.Image.Tag = "mainpicture2";

                        }
                        //  await Task.Delay(1000);

                        //   picCassette.Image = Properties.Resources.cassette3;//open cassette
                        // picMain.Image = Properties.Resources.mainpicCassetteopen;  
                        if (ispauserobot == false && picMain.Image.Tag.ToString() == "mainpicture2" && iscancelrecipe == false)
                        {
                            await Task.Delay(1000);

                            picMain.Image = Properties.Resources.picrobotintocassette;
                            picMain.Image.Tag = "picrobotintocassette";
                            picCassette.Image = Properties.Resources.robot_into_cassetteA1;

                            picCassette.Width += 25;
                            picCassette.Height += 220;
                            picCassette.Top -= 205;
                            picCassette.Image.Tag = "robot_into_cassetteA1";
                            picCassette.Left += 5;
                            label1.BackColor = Color.Blue;
                            lblLoad.Text = "";
                            lblLoad.BackColor = Color.Blue;
                            lbl123.BackColor = Color.Blue;
                            lblState.BackColor = Color.Blue;
                            lblCassetteRecipename.BackColor = Color.Blue;
                            lblmTorr.BackColor = Color.Blue;


                            lblCassette.BackColor = Color.LimeGreen;
                        }


                        await Task.Delay(1000);

                        for (int i = 0; i < NoOfwafer.Count; i++)

                        {


                            if (int.Parse(NoOfwafer[i]) >= 1)
                            {
                                /////////////////////////////////////////////////////////start WaferA1

                                nooftherecipe = "1";


                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassette" && iscancelrecipe == false)
                                {
                                    picCassette.Image = Properties.Resources.cassette;
                                    await Task.Delay(1000);
                                    if (NoOfwafer[i] == "1")
                                    {
                                        // picwafer.Image = Properties.Resources.wafer;
                                        // picwafer.Image.Tag = "wafer";
                                        picWafer1.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.wafermapA2;
                                        picWafer1.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA3fullA1;
                                        picWafer1.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA4fullA1;
                                        picWafer1.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA5fullA1;
                                        picWafer1.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "6")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA5fullA1;
                                        picWafer1.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "7")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA5fullA1;
                                        picWafer1.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "8")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA5fullA1;
                                        picWafer1.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "9")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA5fullA1;
                                        picWafer1.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "10")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA5fullA1;
                                        picWafer1.Visible = false;
                                    }


                                    StartTime = DateTime.Now;


                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "1");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("Logname", lbl123.Text);
                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();












                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA1";
                                    // panel1.Visible = true;
                                    //  ovalShape1.Visible = true;
                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A1";
                                    lblCassette.BackColor = Color.Blue;

                                    picCassette.Image = Properties.Resources.cassette3;

                                    // picMain.Image = Properties.Resources.mainpicCassetteopen;
                                    picCassette.Height -= 220;
                                    picCassette.Width -= 25;
                                    picCassette.Top += 205;
                                    picCassette.Image.Tag = "cassette";
                                    picCassette.Left -= 5;
                                    //  await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA1" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);



                                    // pictRobot.Image = Properties.Resources.robotleft_A1;
                                    //   picMain.Image = Properties.Resources.picrobotcentralized;
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA1";
                                    //  ovalShape1.Visible = true;
                                    // lblwafer.Visible = true;
                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A1";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;
                                    // panel1.Visible = false;



                                    //   await Task.Delay(2000);
                                    //  picCentralize.Image = Properties.Resources.centralize2;//open centralize
                                    //  picMain.Image = Properties.Resources.robotleftA1opencentralize;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA1" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);






                                    // picCentralize.Image = Properties.Resources.robot_into_centralizeA1;

                                    //  picMain.Image = Properties.Resources.picrobotintocentralized;
                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA1";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A1";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA1" && iscancelrecipe == false)
                                {
                                    ////////////////////////////////////////////////////////////////////////////////////
                                    await Task.Delay(2000);
                                    // pictRobot.Visible = true;
                                    // picCentralize.Image = Properties.Resources.centralize2;
                                    // picMain.Image = Properties.Resources.picrobotcentralized;
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA1-2";
                                    // ovalShape1.Visible = true;
                                    //picwafer.Visible = true;
                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A1";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;

                                    // await Task.Delay(2000);
                                    // picCentralize.Image = Properties.Resources.centralize;//close centralize
                                    // picMain.Image = Properties.Resources.robotleftA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA1-2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    //   picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA1";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A1";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;



                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA1" && picSV.Visible == true && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    // picChamber.Image = Properties.Resources.new_chamber1;//open chamber
                                    // picMain.Image = Properties.Resources.robotrightA1openchamber;
                                    picSV.Visible = false;  // open sv of chamber

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA1" && picSV.Visible == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    //pictRobot.Visible = false;
                                    //picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    //  picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA1";
                                    // picChamber.Width += 140;
                                    //picChamber.Left -= 150;
                                    //picChamber.Height += 10;
                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A1";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";

                                    // loaddata();
                                    // loadchamber1( sender, e);
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA1" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA1";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA1" && picSV.Visible == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA1 into Chamber
                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.form1 = this;
                                    chamber1.ShowDialog();

                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {


                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        //     await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            //     await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,Logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", nooftherecipe);
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        //  cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        //  Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate,logid,NoOfRecipe) values(@11,@21,@31,@41,@51,@61,@71,@81,@91,@101),(@12,@22,@32,@42,@52,@62,@72,@82,@92,@102),(@13,@23,@33,@43,@53,@63,@73,@83,@93,@103)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84,@94,@104),(@15,@25,@35,@45,@55,@65,@75,@85,@95,@105),(@16,@26,@36,@46,@56,@66,@76,@86,@96,@106),(@17,@27,@37,@47,@57,@67,@77,@87,@97,@107),(@18,@28,@38,@48,@58,@68,@78,@88,@98,@108)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@91", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@92", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@93", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@94", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@95", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@96", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@97", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@98", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@101", nooftherecipe);
                                        cmdparameter.Parameters.AddWithValue("@102", nooftherecipe);
                                        cmdparameter.Parameters.AddWithValue("@103", nooftherecipe);
                                        cmdparameter.Parameters.AddWithValue("@104", nooftherecipe);
                                        cmdparameter.Parameters.AddWithValue("@105", nooftherecipe);
                                        cmdparameter.Parameters.AddWithValue("@106", nooftherecipe);
                                        cmdparameter.Parameters.AddWithValue("@107", nooftherecipe);
                                        cmdparameter.Parameters.AddWithValue("@108", nooftherecipe);


                                        //   cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }





                                    picMain.Image.Tag = "A1finishChamber";

                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "A1finishChamber" && picSV.Visible == true)
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "A1finishChamber" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA1-2";

                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA1-2")
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA1-2";
                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A1";
                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA1-2" && picSV.Visible == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA1-2" && picSV.Visible == true && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA1-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA1-2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassette2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassette2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "mainpicture3";
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "mainpicture3" && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    //   picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {

                                        //   picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = false;
                                        picWafer2.Visible = false;
                                        picWafer3.Visible = false;
                                        picWafer4.Visible = false;
                                        picWafer5.Visible = false;
                                        picWafer6.Visible = false;
                                        picWafer7.Visible = false;
                                        picWafer8.Visible = false;
                                        picWafer9.Visible = false;
                                        picWafer10.Visible = false;
                                        picWafer11.Visible = false;
                                        picWafer12.Visible = false;
                                        picWafer13.Visible = false;
                                        picWafer14.Visible = false;
                                        picWafer15.Visible = false;
                                        picWafer16.Visible = false;
                                        picWafer17.Visible = false;
                                        picWafer18.Visible = false;
                                        picWafer19.Visible = false;
                                        picWafer20.Visible = false;
                                        picWafer21.Visible = false;
                                        picWafer22.Visible = false;
                                        picWafer23.Visible = false;
                                        picWafer24.Visible = false;
                                        picWafer25.Visible = false;



                                        picWafer1.Visible = true;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;

                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = false;
                                        picWafer2.Visible = false;
                                        picWafer3.Visible = false;
                                        picWafer4.Visible = false;
                                        picWafer5.Visible = false;
                                        picWafer6.Visible = false;
                                        picWafer7.Visible = false;
                                        picWafer8.Visible = false;
                                        picWafer9.Visible = false;
                                        picWafer10.Visible = false;
                                        picWafer11.Visible = false;
                                        picWafer12.Visible = false;
                                        picWafer13.Visible = false;
                                        picWafer14.Visible = false;
                                        picWafer15.Visible = false;
                                        picWafer16.Visible = false;
                                        picWafer17.Visible = false;
                                        picWafer18.Visible = false;
                                        picWafer19.Visible = false;
                                        picWafer20.Visible = false;
                                        picWafer21.Visible = false;
                                        picWafer22.Visible = false;
                                        picWafer23.Visible = false;
                                        picWafer24.Visible = false;
                                        picWafer25.Visible = false;




                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        //   picwafer.Image = Properties.Resources.waferA3full;

                                        picWafer1.Visible = false;
                                        picWafer2.Visible = false;
                                        picWafer3.Visible = false;
                                        picWafer4.Visible = false;
                                        picWafer5.Visible = false;
                                        picWafer6.Visible = false;
                                        picWafer7.Visible = false;
                                        picWafer8.Visible = false;
                                        picWafer9.Visible = false;
                                        picWafer10.Visible = false;
                                        picWafer11.Visible = false;
                                        picWafer12.Visible = false;
                                        picWafer13.Visible = false;
                                        picWafer14.Visible = false;
                                        picWafer15.Visible = false;
                                        picWafer16.Visible = false;
                                        picWafer17.Visible = false;
                                        picWafer18.Visible = false;
                                        picWafer19.Visible = false;
                                        picWafer20.Visible = false;
                                        picWafer21.Visible = false;
                                        picWafer22.Visible = false;
                                        picWafer23.Visible = false;
                                        picWafer24.Visible = false;
                                        picWafer25.Visible = false;



                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = false;
                                        picWafer2.Visible = false;
                                        picWafer3.Visible = false;
                                        picWafer4.Visible = false;
                                        picWafer5.Visible = false;
                                        picWafer6.Visible = false;
                                        picWafer7.Visible = false;
                                        picWafer8.Visible = false;
                                        picWafer9.Visible = false;
                                        picWafer10.Visible = false;
                                        picWafer11.Visible = false;
                                        picWafer12.Visible = false;
                                        picWafer13.Visible = false;
                                        picWafer14.Visible = false;
                                        picWafer15.Visible = false;
                                        picWafer16.Visible = false;
                                        picWafer17.Visible = false;
                                        picWafer18.Visible = false;
                                        picWafer19.Visible = false;
                                        picWafer20.Visible = false;
                                        picWafer21.Visible = false;
                                        picWafer22.Visible = false;
                                        picWafer23.Visible = false;
                                        picWafer24.Visible = false;
                                        picWafer25.Visible = false;



                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;

                                        picWafer1.Visible = false;
                                        picWafer2.Visible = false;
                                        picWafer3.Visible = false;
                                        picWafer4.Visible = false;
                                        picWafer5.Visible = false;
                                        picWafer6.Visible = false;
                                        picWafer7.Visible = false;
                                        picWafer8.Visible = false;
                                        picWafer9.Visible = false;
                                        picWafer10.Visible = false;
                                        picWafer11.Visible = false;
                                        picWafer12.Visible = false;
                                        picWafer13.Visible = false;
                                        picWafer14.Visible = false;
                                        picWafer15.Visible = false;
                                        picWafer16.Visible = false;
                                        picWafer17.Visible = false;
                                        picWafer18.Visible = false;
                                        picWafer19.Visible = false;
                                        picWafer20.Visible = false;
                                        picWafer21.Visible = false;
                                        picWafer22.Visible = false;
                                        picWafer23.Visible = false;
                                        picWafer24.Visible = false;
                                        picWafer25.Visible = false;



                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                    }


                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 1)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();


                                        lblState.Text = "Finished";



                                    }

                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;

                                        lblState.Text = "stopping";
                                    }

                                    picMain.Image.Tag = "finishWaferA1";


                                }

                                /////////////////////////////////////////////////////////finish waferA1
                            }












                            if (int.Parse(NoOfwafer[i]) >= 2)
                            {
                                nooftherecipe = "2";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA1" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    /////////////////////////////////////////////////////////start WaferA2
                                    lblState.Text = "starting";

                                    await Task.Delay(1000);


                                    //pictRobot.Image = Properties.Resources.new_robot;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "A2mainpicture";
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "A2mainpicture")
                                {
                                    await Task.Delay(1000);

                                    //   picCassette.Image = Properties.Resources.cassette3;//open cassette
                                    // picMain.Image = Properties.Resources.mainpicCassetteopen;  
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA2";
                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;

                                    picCassette.Width += 25;
                                    picCassette.Height += 220;
                                    picCassette.Top -= 205;
                                    picCassette.Image.Tag = "robot_into_cassetteA1";
                                    picCassette.Left += 5;
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;
                                    await Task.Delay(1000);


                                    picCassette.Image = Properties.Resources.cassette;
                                    await Task.Delay(1000);

                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.wafer;
                                        //picwafer.Image.Tag = "wafer";
                                        picWafer2.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA1full;

                                        picWafer2.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        //   picwafer.Image = Properties.Resources.waferA3fullA2;
                                        picWafer2.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA4fullA2;
                                        picWafer2.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA5fullA2;
                                        picWafer2.Visible = false;
                                    }

                                    StartTime = DateTime.Now;


                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "2");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);
                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA2";
                                    // panel1.Visible = true;
                                    //  ovalShape1.Visible = true;
                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A2";
                                    lblCassette.BackColor = Color.Blue;

                                    picCassette.Image = Properties.Resources.cassette3;

                                    // picMain.Image = Properties.Resources.mainpicCassetteopen;
                                    picCassette.Height -= 220;
                                    picCassette.Width -= 25;
                                    picCassette.Top += 205;
                                    picCassette.Image.Tag = "cassette";
                                    picCassette.Left -= 5;
                                    //  await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA2")
                                {
                                    await Task.Delay(1000);



                                    // pictRobot.Image = Properties.Resources.robotleft_A1;
                                    //   picMain.Image = Properties.Resources.picrobotcentralized;
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA2";
                                    //  ovalShape1.Visible = true;
                                    // lblwafer.Visible = true;
                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A2";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;
                                    // panel1.Visible = false;



                                    //   await Task.Delay(2000);
                                    //  picCentralize.Image = Properties.Resources.centralize2;//open centralize
                                    //  picMain.Image = Properties.Resources.robotleftA1opencentralize;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);






                                    // picCentralize.Image = Properties.Resources.robot_into_centralizeA1;

                                    //  picMain.Image = Properties.Resources.picrobotintocentralized;
                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA2";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A2";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA2" && iscancelrecipe == false)
                                {
                                    ////////////////////////////////////////////////////////////////////////////////////
                                    await Task.Delay(2000);
                                    // pictRobot.Visible = true;
                                    // picCentralize.Image = Properties.Resources.centralize2;
                                    // picMain.Image = Properties.Resources.picrobotcentralized;
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA2-2";
                                    // ovalShape1.Visible = true;
                                    //picwafer.Visible = true;
                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A2";

                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;

                                    // await Task.Delay(2000);
                                    // picCentralize.Image = Properties.Resources.centralize;//close centralize
                                    // picMain.Image = Properties.Resources.robotleftA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA2-2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    //   picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA2";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A2";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;



                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA2" && picSV.Visible == true && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    // picChamber.Image = Properties.Resources.new_chamber1;//open chamber
                                    // picMain.Image = Properties.Resources.robotrightA1openchamber;
                                    picSV.Visible = false;  // open sv of chamber
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA2" && picSV.Visible == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    //pictRobot.Visible = false;
                                    //picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    //  picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA2";
                                    // picChamber.Width += 140;
                                    //picChamber.Left -= 150;
                                    //picChamber.Height += 10;
                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A2";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";

                                    // loaddata();
                                    // loadchamber1( sender, e);
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA2";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA2" && picSV.Visible == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA2 into Chamber

                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.form1 = this;
                                    chamber1.ShowDialog();

                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        // await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            //    await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,Logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "2");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);
                                        // cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();

                                        //   Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate,logid,noofrecipe) values(@11,@21,@31,@41,@51,@61,@71,@81,@91,@101),(@12,@22,@32,@42,@52,@62,@72,@82,@92,@102),(@13,@23,@33,@43,@53,@63,@73,@83,@93,@103)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84,@94,@104),(@15,@25,@35,@45,@55,@65,@75,@85,@95,@105),(@16,@26,@36,@46,@56,@66,@76,@86,@96,@106),(@17,@27,@37,@47,@57,@67,@77,@87,@97,@107),(@18,@28,@38,@48,@58,@68,@78,@88,@98,@108)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@91", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@92", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@93", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@94", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@95", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@96", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@97", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@98", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@101", "2");
                                        cmdparameter.Parameters.AddWithValue("@102", "2");
                                        cmdparameter.Parameters.AddWithValue("@103", "2");
                                        cmdparameter.Parameters.AddWithValue("@104", "2");
                                        cmdparameter.Parameters.AddWithValue("@105", "2");
                                        cmdparameter.Parameters.AddWithValue("@106", "2");
                                        cmdparameter.Parameters.AddWithValue("@107", "2");
                                        cmdparameter.Parameters.AddWithValue("@108", "2");
                                        //  cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }











                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA2" && picSV.Visible == true && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                    picMain.Image.Tag = "waferA2finishChamber";
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA2finishChamber" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA2-2";
                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA2-2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA2-2";
                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA2-2" && picSV.Visible == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA2-2" && picSV.Visible == true && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA2-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA2-2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "A2picrobotintocassette2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "A2picrobotintocassette2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    //  picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = false;
                                        picWafer2.Visible = false;
                                        picWafer3.Visible = false;
                                        picWafer4.Visible = false;
                                        picWafer5.Visible = false;
                                        picWafer6.Visible = false;
                                        picWafer7.Visible = false;
                                        picWafer8.Visible = false;
                                        picWafer9.Visible = false;
                                        picWafer10.Visible = false;
                                        picWafer11.Visible = false;
                                        picWafer12.Visible = false;
                                        picWafer13.Visible = false;
                                        picWafer14.Visible = false;
                                        picWafer15.Visible = false;
                                        picWafer16.Visible = false;
                                        picWafer17.Visible = false;
                                        picWafer18.Visible = false;
                                        picWafer19.Visible = false;
                                        picWafer20.Visible = false;
                                        picWafer21.Visible = false;
                                        picWafer22.Visible = false;
                                        picWafer23.Visible = false;
                                        picWafer24.Visible = false;
                                        picWafer25.Visible = false;

                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;

                                        picWafer1.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = false;
                                        picWafer2.Visible = false;
                                        picWafer3.Visible = false;
                                        picWafer4.Visible = false;
                                        picWafer5.Visible = false;
                                        picWafer6.Visible = false;
                                        picWafer7.Visible = false;
                                        picWafer8.Visible = false;
                                        picWafer9.Visible = false;
                                        picWafer10.Visible = false;
                                        picWafer11.Visible = false;
                                        picWafer12.Visible = false;
                                        picWafer13.Visible = false;
                                        picWafer14.Visible = false;
                                        picWafer15.Visible = false;
                                        picWafer16.Visible = false;
                                        picWafer17.Visible = false;
                                        picWafer18.Visible = false;
                                        picWafer19.Visible = false;
                                        picWafer20.Visible = false;
                                        picWafer21.Visible = false;
                                        picWafer22.Visible = false;
                                        picWafer23.Visible = false;
                                        picWafer24.Visible = false;
                                        picWafer25.Visible = false;


                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer1.Visible = false;
                                        picWafer2.Visible = false;
                                        picWafer3.Visible = false;
                                        picWafer4.Visible = false;
                                        picWafer5.Visible = false;
                                        picWafer6.Visible = false;
                                        picWafer7.Visible = false;
                                        picWafer8.Visible = false;
                                        picWafer9.Visible = false;
                                        picWafer10.Visible = false;
                                        picWafer11.Visible = false;
                                        picWafer12.Visible = false;
                                        picWafer13.Visible = false;
                                        picWafer14.Visible = false;
                                        picWafer15.Visible = false;
                                        picWafer16.Visible = false;
                                        picWafer17.Visible = false;
                                        picWafer18.Visible = false;
                                        picWafer19.Visible = false;
                                        picWafer20.Visible = false;
                                        picWafer21.Visible = false;
                                        picWafer22.Visible = false;
                                        picWafer23.Visible = false;
                                        picWafer24.Visible = false;
                                        picWafer25.Visible = false;

                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;


                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = false;
                                        picWafer2.Visible = false;
                                        picWafer3.Visible = false;
                                        picWafer4.Visible = false;
                                        picWafer5.Visible = false;
                                        picWafer6.Visible = false;
                                        picWafer7.Visible = false;
                                        picWafer8.Visible = false;
                                        picWafer9.Visible = false;
                                        picWafer10.Visible = false;
                                        picWafer11.Visible = false;
                                        picWafer12.Visible = false;
                                        picWafer13.Visible = false;
                                        picWafer14.Visible = false;
                                        picWafer15.Visible = false;
                                        picWafer16.Visible = false;
                                        picWafer17.Visible = false;
                                        picWafer18.Visible = false;
                                        picWafer19.Visible = false;
                                        picWafer20.Visible = false;
                                        picWafer21.Visible = false;
                                        picWafer22.Visible = false;
                                        picWafer23.Visible = false;
                                        picWafer24.Visible = false;
                                        picWafer25.Visible = false;

                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;


                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = false;
                                        picWafer2.Visible = false;
                                        picWafer3.Visible = false;
                                        picWafer4.Visible = false;
                                        picWafer5.Visible = false;
                                        picWafer6.Visible = false;
                                        picWafer7.Visible = false;
                                        picWafer8.Visible = false;
                                        picWafer9.Visible = false;
                                        picWafer10.Visible = false;
                                        picWafer11.Visible = false;
                                        picWafer12.Visible = false;
                                        picWafer13.Visible = false;
                                        picWafer14.Visible = false;
                                        picWafer15.Visible = false;
                                        picWafer16.Visible = false;
                                        picWafer17.Visible = false;
                                        picWafer18.Visible = false;
                                        picWafer19.Visible = false;
                                        picWafer20.Visible = false;
                                        picWafer21.Visible = false;
                                        picWafer22.Visible = false;
                                        picWafer23.Visible = false;
                                        picWafer24.Visible = false;
                                        picWafer25.Visible = false;

                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;


                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                    }

                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 2)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();



                                        lblState.Text = "Finished";




                                    }

                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;
                                        lblState.Text = "Stopping";
                                    }
                                    picMain.Image.Tag = "finishWaferA2";
                                }
                                /////////////////////////////////////////////////////////finish waferA2
                            }












                            if (int.Parse(NoOfwafer[i]) >= 3)
                            {
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA2" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    /////////////////////////////////////////////////////////start WaferA3
                                    nooftherecipe = "3";

                                    await Task.Delay(1000);

                                    //pictRobot.Image = Properties.Resources.new_robot;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "A3mainpicture";
                                    await Task.Delay(1000);

                                    //   picCassette.Image = Properties.Resources.cassette3;//open cassette
                                    // picMain.Image = Properties.Resources.mainpicCassetteopen;  
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "A3mainpicture" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA3";
                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;

                                    picCassette.Width += 25;
                                    picCassette.Height += 220;
                                    picCassette.Top -= 205;
                                    picCassette.Image.Tag = "robot_into_cassetteA1";
                                    picCassette.Left += 5;
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA3" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);




                                    picCassette.Image = Properties.Resources.cassette;
                                    await Task.Delay(1000);

                                    if (NoOfwafer[i] == "1")
                                    {
                                        // picwafer.Image = Properties.Resources.wafer;
                                        //  picwafer.Image.Tag = "wafer";
                                        picWafer3.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer3.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer3.Visible = false;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA4fullA3;
                                        picWafer3.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        //   picwafer.Image = Properties.Resources.waferA5fullA3;
                                        picWafer3.Visible = false;
                                    }

                                    StartTime = DateTime.Now;


                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "3");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);
                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();




                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA3";
                                    // panel1.Visible = true;
                                    //  ovalShape1.Visible = true;
                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A3";

                                    lblCassette.BackColor = Color.Blue;

                                    picCassette.Image = Properties.Resources.cassette3;

                                    // picMain.Image = Properties.Resources.mainpicCassetteopen;
                                    picCassette.Height -= 220;
                                    picCassette.Width -= 25;
                                    picCassette.Top += 205;
                                    picCassette.Image.Tag = "cassette";
                                    picCassette.Left -= 5;
                                    //  await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA3" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);



                                    // pictRobot.Image = Properties.Resources.robotleft_A1;
                                    //   picMain.Image = Properties.Resources.picrobotcentralized;
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA3";
                                    //  ovalShape1.Visible = true;
                                    // lblwafer.Visible = true;
                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A3";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;
                                    // panel1.Visible = false;



                                    //   await Task.Delay(2000);
                                    //  picCentralize.Image = Properties.Resources.centralize2;//open centralize
                                    //  picMain.Image = Properties.Resources.robotleftA1opencentralize;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA3" && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);






                                    // picCentralize.Image = Properties.Resources.robot_into_centralizeA1;

                                    //  picMain.Image = Properties.Resources.picrobotintocentralized;
                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA3";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A3";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;


                                    ////////////////////////////////////////////////////////////////////////////////////
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA3" && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);
                                    // pictRobot.Visible = true;
                                    // picCentralize.Image = Properties.Resources.centralize2;
                                    // picMain.Image = Properties.Resources.picrobotcentralized;
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;

                                    picMain.Image.Tag = "picrobotAlignerWaferA3-2";
                                    // ovalShape1.Visible = true;
                                    //picwafer.Visible = true;
                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A3";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;

                                    // await Task.Delay(2000);
                                    // picCentralize.Image = Properties.Resources.centralize;//close centralize
                                    // picMain.Image = Properties.Resources.robotleftA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA3-2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    //   picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA3";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A3";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;



                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA3" && picSV.Visible == true && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    // picChamber.Image = Properties.Resources.new_chamber1;//open chamber
                                    // picMain.Image = Properties.Resources.robotrightA1openchamber;
                                    picSV.Visible = false;  // open sv of chamber
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA3" && picSV.Visible == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    //pictRobot.Visible = false;
                                    //picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    //  picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA3";
                                    // picChamber.Width += 140;
                                    //picChamber.Left -= 150;
                                    //picChamber.Height += 10;
                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A3";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";

                                    // loaddata();
                                    // loadchamber1( sender, e);
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA3" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA3";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA3" && picSV.Visible == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA3 into Chamber

                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.ShowDialog();


                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {


                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {


                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));




                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        // await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            //     await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "3");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        //      cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        //  Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate,logid,NoOfRecipe) values(@11,@21,@31,@41,@51,@61,@71,@81,@91,@101),(@12,@22,@32,@42,@52,@62,@72,@82,@92,@102),(@13,@23,@33,@43,@53,@63,@73,@83,@93,@103)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84,@94,@104),(@15,@25,@35,@45,@55,@65,@75,@85,@95,@105),(@16,@26,@36,@46,@56,@66,@76,@86,@96,@106),(@17,@27,@37,@47,@57,@67,@77,@87,@97,@107),(@18,@28,@38,@48,@58,@68,@78,@88,@98,@108)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@91", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@92", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@93", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@94", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@95", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@96", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@97", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@98", lbl123.Text);
                                        cmdparameter.Parameters.AddWithValue("@101", nooftherecipe);
                                        cmdparameter.Parameters.AddWithValue("@102", nooftherecipe);
                                        cmdparameter.Parameters.AddWithValue("@103", nooftherecipe);
                                        cmdparameter.Parameters.AddWithValue("@104", nooftherecipe);
                                        cmdparameter.Parameters.AddWithValue("@105", nooftherecipe);
                                        cmdparameter.Parameters.AddWithValue("@106", nooftherecipe);
                                        cmdparameter.Parameters.AddWithValue("@107", nooftherecipe);
                                        cmdparameter.Parameters.AddWithValue("@108", nooftherecipe);




                                        //   cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }











                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA3" && picSV.Visible == true && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                    picMain.Image.Tag = "A3finishChamber";
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "A3finishChamber" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA3-2";
                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA3-2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA3-2";
                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;
                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA3-2" && picSV.Visible == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA3-2" && picSV.Visible == true && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA3-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;

                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA3-2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "A3picrobotintocassette-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "A3picrobotintocassette-2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "A3mainpicture-2";
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "A3mainpicture-2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;

                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;

                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;

                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;

                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;

                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                    }


                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 3)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();



                                        lblState.Text = "Finished";


                                    }

                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;
                                        lblState.Text = "Stopping";
                                    }
                                    picMain.Image.Tag = "finishWaferA3";
                                }
                                /////////////////////////////////////////////////////////finish waferA3
                            }









                            if (int.Parse(NoOfwafer[i]) >= 4)
                            {
                                /////////////////////////////////////////////////////////start WaferA4
                                nooftherecipe = "4";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA3" && isStopRobot == false && iscancelrecipe == false)
                                    await Task.Delay(1000);

                                //pictRobot.Image = Properties.Resources.new_robot;
                                picMain.Image = Properties.Resources.mainpicture;
                                picMain.Image.Tag = "mainpictureA4";
                                await Task.Delay(1000);

                                //   picCassette.Image = Properties.Resources.cassette3;//open cassette
                                // picMain.Image = Properties.Resources.mainpicCassetteopen;  
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "mainpictureA4")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA4";
                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;

                                    picCassette.Width += 25;
                                    picCassette.Height += 220;
                                    picCassette.Top -= 205;
                                    picCassette.Image.Tag = "robot_into_cassetteA1";
                                    picCassette.Left += 5;
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;
                                    await Task.Delay(1000);




                                    picCassette.Image = Properties.Resources.cassette;

                                    await Task.Delay(1000);

                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.wafer;
                                        //  picwafer.Image.Tag = "wafer";
                                        picWafer4.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer4.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer4.Visible = false;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        //   picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer4.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        //   picwafer.Image = Properties.Resources.waferA5fullA4;
                                        picWafer4.Visible = false;
                                    }

                                    StartTime = DateTime.Now;


                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "4");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);
                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();





                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA4" && iscancelrecipe == false)
                                {

                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA4";
                                    // panel1.Visible = true;
                                    //  ovalShape1.Visible = true;
                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A4";

                                    lblCassette.BackColor = Color.Blue;

                                    picCassette.Image = Properties.Resources.cassette3;

                                    // picMain.Image = Properties.Resources.mainpicCassetteopen;
                                    picCassette.Height -= 220;
                                    picCassette.Width -= 25;
                                    picCassette.Top += 205;
                                    picCassette.Image.Tag = "cassette";
                                    picCassette.Left -= 5;
                                    //  await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA4" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);



                                    // pictRobot.Image = Properties.Resources.robotleft_A1;
                                    //   picMain.Image = Properties.Resources.picrobotcentralized;
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA4";
                                    //  ovalShape1.Visible = true;
                                    // lblwafer.Visible = true;
                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A4";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;
                                    // panel1.Visible = false;



                                    //   await Task.Delay(2000);
                                    //  picCentralize.Image = Properties.Resources.centralize2;//open centralize
                                    //  picMain.Image = Properties.Resources.robotleftA1opencentralize;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA4" && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);






                                    // picCentralize.Image = Properties.Resources.robot_into_centralizeA1;

                                    //  picMain.Image = Properties.Resources.picrobotintocentralized;
                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA4";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A4";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA4" && iscancelrecipe == false)
                                {
                                    ////////////////////////////////////////////////////////////////////////////////////
                                    await Task.Delay(2000);
                                    // pictRobot.Visible = true;
                                    // picCentralize.Image = Properties.Resources.centralize2;
                                    // picMain.Image = Properties.Resources.picrobotcentralized;
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA4-2";
                                    // ovalShape1.Visible = true;
                                    //picwafer.Visible = true;
                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A4";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA4-2" && iscancelrecipe == false)
                                {
                                    // await Task.Delay(2000);
                                    // picCentralize.Image = Properties.Resources.centralize;//close centralize
                                    // picMain.Image = Properties.Resources.robotleftA1;
                                    await Task.Delay(2000);

                                    //   picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA4";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A4";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA4" && iscancelrecipe == false)
                                {

                                    await Task.Delay(1000);

                                    // picChamber.Image = Properties.Resources.new_chamber1;//open chamber
                                    // picMain.Image = Properties.Resources.robotrightA1openchamber;
                                    picSV.Visible = false;  // open sv of chamber
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA4" && picSV.Visible == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    //pictRobot.Visible = false;
                                    //picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    //  picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA4";
                                    // picChamber.Width += 140;
                                    //picChamber.Left -= 150;
                                    //picChamber.Height += 10;
                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A4";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";

                                    // loaddata();
                                    // loadchamber1( sender, e);

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA4" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;


                                    picMain.Image.Tag = "picwaferinAPMA4";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA4" && picSV.Visible == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    //////////////////////////////////////////////////////////////////////////////////////////// ///////////WaferA4 into Chamber
                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.ShowDialog();

                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        //  await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            // await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "4");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        // cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        //  Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                        cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }






                                    picMain.Image.Tag = "finishchamberA4";




                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }


                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA4" && picSV.Visible == true && iscancelrecipe == false)
                                {

                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA4" && picSV.Visible == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA4-2";

                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA4-2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;

                                    picMain.Image.Tag = "picrobotAPMWaferA4-2";

                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA4-2" && picSV.Visible == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA4-2" && picSV.Visible == true && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA4-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA4-2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassettA4-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA4-2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                    }

                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 4)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();

                                        lblState.Text = "Finished";



                                    }
                                    picMain.Image.Tag = "finishwaferA4";
                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;
                                        lblState.Text = "Stopping";
                                    }


                                }
                                /////////////////////////////////////////////////////////finish waferA4
                            }













                            if (int.Parse(NoOfwafer[i]) >= 5)
                            {
                                /////////////////////////////////////////////////////////start WaferA5
                                nooftherecipe = "5";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishwaferA4" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    //pictRobot.Image = Properties.Resources.new_robot;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "mainpictureA5";

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "mainpictureA5" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    //   picCassette.Image = Properties.Resources.cassette3;//open cassette
                                    // picMain.Image = Properties.Resources.mainpicCassetteopen;  
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA5";
                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;

                                    picCassette.Width += 25;
                                    picCassette.Height += 220;
                                    picCassette.Top -= 205;
                                    picCassette.Image.Tag = "robot_into_cassetteA1";
                                    picCassette.Left += 5;
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;
                                    await Task.Delay(1000);


                                    picCassette.Image = Properties.Resources.cassette;
                                    await Task.Delay(1000);

                                    if (NoOfwafer[i] == "1")
                                    {
                                        // picwafer.Image = Properties.Resources.wafer;
                                        //  picwafer.Image.Tag = "wafer";
                                        picWafer5.Visible = true;
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer5.Visible = true;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        //   picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer5.Visible = true;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        //   picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer5.Visible = true;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer5.Visible = false;
                                    }

                                    StartTime = DateTime.Now;


                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "5");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);
                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();


                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA5" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA5";                                       // panel1.Visible = true;
                                                                                                                    //  ovalShape1.Visible = true;
                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A5";

                                    lblCassette.BackColor = Color.Blue;

                                    picCassette.Image = Properties.Resources.cassette3;

                                    // picMain.Image = Properties.Resources.mainpicCassetteopen;
                                    picCassette.Height -= 220;
                                    picCassette.Width -= 25;
                                    picCassette.Top += 205;
                                    picCassette.Image.Tag = "cassette";
                                    picCassette.Left -= 5;
                                    //  await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA5" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);



                                    // pictRobot.Image = Properties.Resources.robotleft_A1;
                                    //   picMain.Image = Properties.Resources.picrobotcentralized;
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA5";
                                    //  ovalShape1.Visible = true;
                                    // lblwafer.Visible = true;
                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A5";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;
                                    // panel1.Visible = false;



                                    //   await Task.Delay(2000);
                                    //  picCentralize.Image = Properties.Resources.centralize2;//open centralize
                                    //  picMain.Image = Properties.Resources.robotleftA1opencentralize;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA5" && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);






                                    // picCentralize.Image = Properties.Resources.robot_into_centralizeA1;

                                    //  picMain.Image = Properties.Resources.picrobotintocentralized;
                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA5";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A5";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA5" && iscancelrecipe == false)
                                {
                                    ////////////////////////////////////////////////////////////////////////////////////
                                    await Task.Delay(2000);
                                    // pictRobot.Visible = true;
                                    // picCentralize.Image = Properties.Resources.centralize2;
                                    // picMain.Image = Properties.Resources.picrobotcentralized;
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA5-2";
                                    // ovalShape1.Visible = true;
                                    //picwafer.Visible = true;
                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A5";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;

                                    // await Task.Delay(2000);
                                    // picCentralize.Image = Properties.Resources.centralize;//close centralize
                                    // picMain.Image = Properties.Resources.robotleftA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA5-2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    //   picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA5";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A5";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;



                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA5" && picSV.Visible == true && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    // picChamber.Image = Properties.Resources.new_chamber1;//open chamber
                                    // picMain.Image = Properties.Resources.robotrightA1openchamber;
                                    picSV.Visible = false;  // open sv of chamber
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA5" && picSV.Visible == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    //pictRobot.Visible = false;
                                    //picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    //  picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA5";
                                    // picChamber.Width += 140;
                                    //picChamber.Left -= 150;
                                    //picChamber.Height += 10;
                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A5";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";

                                    // loaddata();
                                    // loadchamber1( sender, e);
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA5" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;

                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA5";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA5" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA5 into Chamber


                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "5");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        //   cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                        // cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }











                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                    await Task.Delay(1000);


                                    picMain.Image.Tag = "finishchamberA5";

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA5" && picSV.Visible == true && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA5" && picSV.Visible == true && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA5-2";
                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA5-2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;

                                    picMain.Image.Tag = "picrobotAPMWaferA5-2";
                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA5-2" && picSV.Visible == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA5-2" && picSV.Visible == true && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA5-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA5-2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA5-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA5-2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        picwafer.Image = Properties.Resources.waferA1full;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        picwafer.Image = Properties.Resources.waferA2full;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        picwafer.Image = Properties.Resources.waferA3full;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        picwafer.Image = Properties.Resources.waferA4full;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;

                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                    }

                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 5)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();

                                        /////////////////////////////////////////////////////////finish waferA5
                                        lblState.Text = "Finished";
                                    }
                                    picMain.Image.Tag = "finishwaferA5";

                                }
                            }




                            if (int.Parse(NoOfwafer[i]) >= 6)
                            {
                                /////////////////////////////////////////////////////////start WaferA6

                                nooftherecipe = "6";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishwaferA5" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    picCassette.Image = Properties.Resources.cassette;
                                    await Task.Delay(1000);
                                    //  picMain.Image.Tag = "waferA6";

                                    if (NoOfwafer[i] == "1")
                                    {
                                        picwafer.Image = Properties.Resources.wafer;
                                        picwafer.Image.Tag = "wafer";
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        picwafer.Image = Properties.Resources.waferA1full;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        picwafer.Image = Properties.Resources.waferA2full;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        picwafer.Image = Properties.Resources.waferA3full;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        picwafer.Image = Properties.Resources.waferA4full;
                                    }
                                    else if (NoOfwafer[i] == "6")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer6.Visible = false;
                                    }
                                    StartTime = DateTime.Now;


                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "6");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();









                                    await Task.Delay(1000);

                                    //pictRobot.Image = Properties.Resources.new_robot;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "waferA6mainpicture";
                                    await Task.Delay(1000);

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA6mainpicture" && iscancelrecipe == false)
                                {

                                    //   picCassette.Image = Properties.Resources.cassette3;//open cassette
                                    // picMain.Image = Properties.Resources.mainpicCassetteopen;  
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA6";
                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;

                                    picCassette.Width += 25;
                                    picCassette.Height += 220;
                                    picCassette.Top -= 205;
                                    picCassette.Image.Tag = "robot_into_cassetteA1";
                                    picCassette.Left += 5;
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA6" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    //  pictRobot.Visible = true;

                                    //  picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA6";                                           // panel1.Visible = true;
                                                                                                                        //  ovalShape1.Visible = true;
                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A5";

                                    lblCassette.BackColor = Color.Blue;

                                    picCassette.Image = Properties.Resources.cassette3;

                                    // picMain.Image = Properties.Resources.mainpicCassetteopen;
                                    picCassette.Height -= 220;
                                    picCassette.Width -= 25;
                                    picCassette.Top += 205;
                                    picCassette.Image.Tag = "cassette";
                                    picCassette.Left -= 5;
                                    //  await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA6" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);



                                    // pictRobot.Image = Properties.Resources.robotleft_A1;
                                    //   picMain.Image = Properties.Resources.picrobotcentralized;
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    //  ovalShape1.Visible = true;
                                    // lblwafer.Visible = true;
                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A5";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;
                                    // panel1.Visible = false;

                                    picMain.Image.Tag = "picrobotAlignerWaferA6";

                                    //   await Task.Delay(2000);
                                    //  picCentralize.Image = Properties.Resources.centralize2;//open centralize
                                    //  picMain.Image = Properties.Resources.robotleftA1opencentralize;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA6" && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);






                                    // picCentralize.Image = Properties.Resources.robot_into_centralizeA1;

                                    //  picMain.Image = Properties.Resources.picrobotintocentralized;
                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA6";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A6";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA6" && iscancelrecipe == false)
                                {
                                    ////////////////////////////////////////////////////////////////////////////////////
                                    await Task.Delay(2000);
                                    // pictRobot.Visible = true;
                                    // picCentralize.Image = Properties.Resources.centralize2;
                                    // picMain.Image = Properties.Resources.picrobotcentralized;
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA6-2";
                                    // ovalShape1.Visible = true;
                                    //picwafer.Visible = true;
                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A6";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;

                                    // await Task.Delay(2000);
                                    // picCentralize.Image = Properties.Resources.centralize;//close centralize
                                    // picMain.Image = Properties.Resources.robotleftA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA6-2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    //   picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA6";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A6";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;



                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA6" && picSV.Visible == true && iscancelrecipe == false)
                                {

                                    await Task.Delay(1000);

                                    // picChamber.Image = Properties.Resources.new_chamber1;//open chamber
                                    // picMain.Image = Properties.Resources.robotrightA1openchamber;
                                    picSV.Visible = false;  // open sv of chamber

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA6" && picSV.Visible == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    //pictRobot.Visible = false;
                                    //picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    //  picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA6";
                                    // picChamber.Width += 140;
                                    //picChamber.Left -= 150;
                                    //picChamber.Height += 10;
                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A6";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA6" && iscancelrecipe == false)
                                {
                                    // loaddata();
                                    // loadchamber1( sender, e);
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA6";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA6" && iscancelrecipe == false)
                                {

                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA6 into Chamber


                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "6");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname) values(@11,@21,@31,@41,@51,@61,@71),(@12,@22,@32,@42,@52,@62,@72),(@13,@23,@33,@43,@53,@63,@73)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74),(@15,@25,@35,@45,@55,@65,@75),(@16,@26,@36,@46,@56,@66,@76),(@17,@27,@37,@47,@57,@67,@77),(@18,@28,@38,@48,@58,@68,@78)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);


                                        cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }











                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                    picMain.Image.Tag = "A6finishChamber";
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "A6finishChamber" && picSV.Visible == true && iscancelrecipe == false)

                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "A6finishChamber" && picSV.Visible == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Aborted";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "???????????";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA6-2";
                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA6-2" && picSV.Visible == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA6-2" && picSV.Visible == true && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA6-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;

                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA6-2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA6-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Tag.ToString() == "picrobotintocassetteA6-2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "mainpictureA6-2";
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                }
                                if (ispauserobot == false && picMain.Tag.ToString() == "mainpictureA6-2" && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        picwafer.Image = Properties.Resources.waferA1full;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        picwafer.Image = Properties.Resources.waferA2full;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        picwafer.Image = Properties.Resources.waferA3full;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        picwafer.Image = Properties.Resources.waferA4full;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        picwafer.Image = Properties.Resources.waferA5full;
                                    }
                                    if (NoOfwafer[i] == "6")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA6full;
                                        picWafer1.Visible = false;
                                        picWafer2.Visible = false;
                                        picWafer3.Visible = false;
                                        picWafer4.Visible = false;
                                        picWafer5.Visible = false;
                                        picWafer6.Visible = false;

                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;

                                    }

                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 6)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();


                                    }

                                    //////////////////////////////////////////////////////////////////////////finish waferA6
                                    picMain.Image.Tag = "finishWaferA6";
                                }
                            }


                            if (int.Parse(NoOfwafer[i]) >= 7)
                            {
                                //////////////////////////////////////////////////////////////////////////start waferA7
                                nooftherecipe = "7";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA6" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    picCassette.Image = Properties.Resources.cassette1;

                                    if (NoOfwafer[i] == "1")
                                    {
                                        picwafer.Image = Properties.Resources.wafer;
                                        picwafer.Image.Tag = "wafer";
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        picwafer.Image = Properties.Resources.waferA1full;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        picwafer.Image = Properties.Resources.waferA2full;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        picwafer.Image = Properties.Resources.waferA3full;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        picwafer.Image = Properties.Resources.waferA4full;
                                    }
                                    else if (NoOfwafer[i] == "6")
                                    {
                                        picwafer.Image = Properties.Resources.waferA5full;

                                    }
                                    else if (NoOfwafer[i] == "7")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA6full;
                                        picWafer7.Visible = false;
                                    }


                                    StartTime = DateTime.Now;




                                    await Task.Delay(2000);
                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "7");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();

                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "waferA7mainpicture";

                                    await Task.Delay(1000);
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA7mainpicture")
                                {
                                    // lblCassette.BackColor = Color.LimeGreen;
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA7";
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA7")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA7";

                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A7";

                                    lblCassette.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA7")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA7";

                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A7";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA7")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA7";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A7";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA7")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA7-2";

                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A7";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA7-2")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA7";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A7";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA7" && picSV.Visible == true)
                                {
                                    await Task.Delay(1000);


                                    picSV.Visible = false;  // open sv of chamber
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA7" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA7";

                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A7";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA7")
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;

                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA7";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA7")

                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA7 into Chamber
                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.ShowDialog();

                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        //  await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            // await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "7");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        // cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        //  Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                        cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }






                                    picMain.Image.Tag = "finishchamberA7";




                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }


                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA7" && picSV.Visible == true)
                                {

                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA7" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA7-2";

                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA7-2")
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;

                                    picMain.Image.Tag = "picrobotAPMWaferA7-2";

                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA7-2" && picSV.Visible == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA7-2" && picSV.Visible == true)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA7-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA7-2")
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassettA7-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA7-2")
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "6")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "7")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                    }




                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 7)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();

                                        lblState.Text = "Finished";



                                    }
                                    picMain.Image.Tag = "finishwaferA7";
                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;
                                        lblState.Text = "Stopping";
                                    }


                                }
                                /////////////////////////////////////////////////////////finish waferA7
                            }



                            if (int.Parse(NoOfwafer[i]) >= 8)
                            {
                                //////////////////////////////////////////////////////////////////////////start waferA8
                                nooftherecipe = "8";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA7" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    picCassette.Image = Properties.Resources.cassette1;

                                    if (NoOfwafer[i] == "1")
                                    {
                                        picwafer.Image = Properties.Resources.wafer;
                                        picwafer.Image.Tag = "wafer";
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        picwafer.Image = Properties.Resources.waferA1full;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        picwafer.Image = Properties.Resources.waferA2full;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        picwafer.Image = Properties.Resources.waferA3full;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        picwafer.Image = Properties.Resources.waferA4full;
                                    }
                                    else if (NoOfwafer[i] == "6")
                                    {
                                        picwafer.Image = Properties.Resources.waferA5full;

                                    }
                                    else if (NoOfwafer[i] == "7")
                                    {
                                        picwafer.Image = Properties.Resources.waferA6full;

                                    }
                                    else if (NoOfwafer[i] == "8")
                                    {
                                        //    picwafer.Image = Properties.Resources.waferA7full;
                                        picWafer8.Visible = false;

                                    }


                                    StartTime = DateTime.Now;




                                    await Task.Delay(2000);
                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "8");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();

                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "waferA8mainpicture";

                                    await Task.Delay(1000);
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA8mainpicture")
                                {
                                    // lblCassette.BackColor = Color.LimeGreen;
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA8";
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA8")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA8";

                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A8";

                                    lblCassette.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA8")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA8";

                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A8";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA8")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA8";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A8";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA8")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA8-2";

                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A8";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA8-2")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA8";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A8";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA8" && picSV.Visible == true)
                                {
                                    await Task.Delay(1000);


                                    picSV.Visible = false;  // open sv of chamber
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA8" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA8";

                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A8";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA8")
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;

                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA8";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA8")

                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA8 into Chamber
                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.ShowDialog();

                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        //  await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            // await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "8");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        // cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        //  Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                        cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }






                                    picMain.Image.Tag = "finishchamberA8";




                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }


                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA8" && picSV.Visible == true)
                                {

                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA8" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA8-2";

                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA8-2")
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;

                                    picMain.Image.Tag = "picrobotAPMWaferA8-2";

                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA8-2" && picSV.Visible == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA8-2" && picSV.Visible == true)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA8-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA8-2")
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassettA8-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA8-2")
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "6")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "7")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "8")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                    }





                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 8)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();

                                        lblState.Text = "Finished";



                                    }
                                    picMain.Image.Tag = "finishwaferA8";
                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;
                                        lblState.Text = "Stopping";
                                    }


                                }
                                /////////////////////////////////////////////////////////finish waferA8
                            }


                            if (int.Parse(NoOfwafer[i]) >= 9)
                            {
                                //////////////////////////////////////////////////////////////////////////start waferA9
                                nooftherecipe = "9";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA8" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    picCassette.Image = Properties.Resources.cassette1;

                                    if (NoOfwafer[i] == "1")
                                    {
                                        picwafer.Image = Properties.Resources.wafer;
                                        picwafer.Image.Tag = "wafer";
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        picwafer.Image = Properties.Resources.waferA1full;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        picwafer.Image = Properties.Resources.waferA2full;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        picwafer.Image = Properties.Resources.waferA3full;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        picwafer.Image = Properties.Resources.waferA4full;
                                    }
                                    else if (NoOfwafer[i] == "6")
                                    {
                                        picwafer.Image = Properties.Resources.waferA5full;

                                    }
                                    else if (NoOfwafer[i] == "7")
                                    {
                                        picwafer.Image = Properties.Resources.waferA6full;

                                    }
                                    else if (NoOfwafer[i] == "8")
                                    {
                                        picwafer.Image = Properties.Resources.waferA7full;

                                    }
                                    else if (NoOfwafer[i] == "9")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA8full;
                                        picWafer9.Visible = false;
                                    }


                                    StartTime = DateTime.Now;




                                    await Task.Delay(2000);
                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "9");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();

                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "waferA9mainpicture";

                                    await Task.Delay(1000);
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA9mainpicture")
                                {
                                    // lblCassette.BackColor = Color.LimeGreen;
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA9";
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA9")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA9";

                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A9";

                                    lblCassette.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA9")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA9";

                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A9";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA9")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA9";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A9";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA9")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA9-2";

                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A9";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA9-2")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA9";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A9";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA9" && picSV.Visible == true)
                                {
                                    await Task.Delay(1000);


                                    picSV.Visible = false;  // open sv of chamber
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA9" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA9";

                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A9";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA9")
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;

                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA9";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA9")

                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA9 into Chamber
                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.ShowDialog();

                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        //  await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            // await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "9");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        // cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        //  Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                        cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }






                                    picMain.Image.Tag = "finishchamberA9";




                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }


                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA9" && picSV.Visible == true)
                                {

                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA9" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA9-2";

                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA9-2")
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;

                                    picMain.Image.Tag = "picrobotAPMWaferA9-2";

                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA9-2" && picSV.Visible == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA9-2" && picSV.Visible == true)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA9-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA9-2")
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassettA9-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA9-2")
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "6")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "7")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "8")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "9")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                    }




                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 9)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();

                                        lblState.Text = "Finished";



                                    }
                                    picMain.Image.Tag = "finishwaferA9";
                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;
                                        lblState.Text = "Stopping";
                                    }


                                }
                                /////////////////////////////////////////////////////////finish waferA9
                            }
                            if (int.Parse(NoOfwafer[i]) >= 10)
                            {
                                //////////////////////////////////////////////////////////////////////////start waferA10
                                nooftherecipe = "10";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA9" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    picCassette.Image = Properties.Resources.cassette1;

                                    if (NoOfwafer[i] == "1")
                                    {
                                        picwafer.Image = Properties.Resources.wafer;
                                        picwafer.Image.Tag = "wafer";
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        picwafer.Image = Properties.Resources.waferA1full;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        picwafer.Image = Properties.Resources.waferA2full;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        picwafer.Image = Properties.Resources.waferA3full;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        picwafer.Image = Properties.Resources.waferA4full;
                                    }
                                    else if (NoOfwafer[i] == "6")
                                    {
                                        picwafer.Image = Properties.Resources.waferA5full;

                                    }
                                    else if (NoOfwafer[i] == "7")
                                    {
                                        picwafer.Image = Properties.Resources.waferA6full;

                                    }
                                    else if (NoOfwafer[i] == "8")
                                    {
                                        picwafer.Image = Properties.Resources.waferA7full;

                                    }
                                    else if (NoOfwafer[i] == "9")
                                    {
                                        picwafer.Image = Properties.Resources.waferA8full;

                                    }
                                    else if (NoOfwafer[i] == "10")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer10.Visible = false;
                                    }


                                    StartTime = DateTime.Now;




                                    await Task.Delay(2000);
                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "10");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();

                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "waferA10mainpicture";

                                    await Task.Delay(1000);
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA10mainpicture")
                                {
                                    // lblCassette.BackColor = Color.LimeGreen;
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA10";
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA10")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA10";

                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A10";

                                    lblCassette.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA10")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA10";

                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A10";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA10")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA10";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A10";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA10")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA10-2";

                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A10";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA10-2")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA10";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A10";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA10" && picSV.Visible == true)
                                {
                                    await Task.Delay(1000);


                                    picSV.Visible = false;  // open sv of chamber
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA10" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA10";

                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A10";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA10")
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;

                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA10";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA10")

                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA10 into Chamber
                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.ShowDialog();

                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        //  await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            // await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "10");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        // cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        //  Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                        cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }






                                    picMain.Image.Tag = "finishchamberA10";




                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }


                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA10" && picSV.Visible == true)
                                {

                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA10" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA10-2";

                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA10-2")
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;

                                    picMain.Image.Tag = "picrobotAPMWaferA10-2";

                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA10-2" && picSV.Visible == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA10-2" && picSV.Visible == true)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA10-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA10-2")
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassettA10-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA10-2")
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "6")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "7")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "8")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "9")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "10")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }




                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 10)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();

                                        lblState.Text = "Finished";



                                    }
                                    picMain.Image.Tag = "finishwaferA10";
                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;
                                        lblState.Text = "Stopping";
                                    }


                                }
                                /////////////////////////////////////////////////////////finish waferA10
                            }


                            if (int.Parse(NoOfwafer[i]) >= 11)
                            {
                                //////////////////////////////////////////////////////////////////////////start waferA11
                                nooftherecipe = "11";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA10" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    picCassette.Image = Properties.Resources.cassette1;

                                    if (NoOfwafer[i] == "1")
                                    {
                                        picwafer.Image = Properties.Resources.wafer;
                                        picwafer.Image.Tag = "wafer";
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        picwafer.Image = Properties.Resources.waferA1full;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        picwafer.Image = Properties.Resources.waferA2full;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        picwafer.Image = Properties.Resources.waferA3full;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        picwafer.Image = Properties.Resources.waferA4full;
                                    }
                                    else if (NoOfwafer[i] == "6")
                                    {
                                        picwafer.Image = Properties.Resources.waferA5full;

                                    }
                                    else if (NoOfwafer[i] == "7")
                                    {
                                        picwafer.Image = Properties.Resources.waferA6full;

                                    }
                                    else if (NoOfwafer[i] == "8")
                                    {
                                        picwafer.Image = Properties.Resources.waferA7full;

                                    }
                                    else if (NoOfwafer[i] == "9")
                                    {
                                        picwafer.Image = Properties.Resources.waferA8full;

                                    }
                                    else if (NoOfwafer[i] == "10")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }
                                    else if (NoOfwafer[i] == "11")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer11.Visible = false;
                                    }



                                    StartTime = DateTime.Now;




                                    await Task.Delay(2000);
                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "11");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();

                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "waferA11mainpicture";

                                    await Task.Delay(1000);
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA11mainpicture")
                                {
                                    // lblCassette.BackColor = Color.LimeGreen;
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA11";
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA11")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA11";

                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A11";

                                    lblCassette.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA11")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA11";

                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A11";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA11")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA11";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A11";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA11")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA11-2";

                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A10";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA11-2")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA11";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A11";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA11" && picSV.Visible == true)
                                {
                                    await Task.Delay(1000);


                                    picSV.Visible = false;  // open sv of chamber
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA11" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA11";

                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A11";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA11")
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;

                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA11";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA11")

                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA11 into Chamber
                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.ShowDialog();

                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        //  await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            // await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "11");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        // cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        //  Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                        cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }






                                    picMain.Image.Tag = "finishchamberA11";




                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }


                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA11" && picSV.Visible == true)
                                {

                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA11" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA11-2";

                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA11-2")
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;

                                    picMain.Image.Tag = "picrobotAPMWaferA11-2";

                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA11-2" && picSV.Visible == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA11-2" && picSV.Visible == true)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA11-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA11-2")
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassettA11-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA11-2")
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "6")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "7")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "8")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "9")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "10")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "11")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                    }




                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 11)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();

                                        lblState.Text = "Finished";



                                    }
                                    picMain.Image.Tag = "finishwaferA11";
                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;
                                        lblState.Text = "Stopping";
                                    }


                                }
                                /////////////////////////////////////////////////////////finish waferA11
                            }

                            if (int.Parse(NoOfwafer[i]) >= 12)
                            {
                                //////////////////////////////////////////////////////////////////////////start waferA12
                                nooftherecipe = "12";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA11" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    picCassette.Image = Properties.Resources.cassette1;

                                    if (NoOfwafer[i] == "1")
                                    {
                                        picwafer.Image = Properties.Resources.wafer;
                                        picwafer.Image.Tag = "wafer";
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        picwafer.Image = Properties.Resources.waferA1full;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        picwafer.Image = Properties.Resources.waferA2full;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        picwafer.Image = Properties.Resources.waferA3full;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        picwafer.Image = Properties.Resources.waferA4full;
                                    }
                                    else if (NoOfwafer[i] == "6")
                                    {
                                        picwafer.Image = Properties.Resources.waferA5full;

                                    }
                                    else if (NoOfwafer[i] == "7")
                                    {
                                        picwafer.Image = Properties.Resources.waferA6full;

                                    }
                                    else if (NoOfwafer[i] == "8")
                                    {
                                        picwafer.Image = Properties.Resources.waferA7full;

                                    }
                                    else if (NoOfwafer[i] == "9")
                                    {
                                        picwafer.Image = Properties.Resources.waferA8full;

                                    }
                                    else if (NoOfwafer[i] == "10")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }
                                    else if (NoOfwafer[i] == "11")
                                    {
                                        picwafer.Image = Properties.Resources.waferA10full;

                                    }

                                    else if (NoOfwafer[i] == "12")
                                    {
                                        picWafer12.Visible = false;

                                    }



                                    StartTime = DateTime.Now;




                                    await Task.Delay(2000);
                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "12");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();

                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "waferA12mainpicture";

                                    await Task.Delay(1000);
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA12mainpicture")
                                {
                                    // lblCassette.BackColor = Color.LimeGreen;
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA12";
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA12")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA12";

                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A12";

                                    lblCassette.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA12")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA12";

                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A12";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA12")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA12";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A12";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA12")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA12-2";

                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A12";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA12-2")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA12";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A12";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA12" && picSV.Visible == true)
                                {
                                    await Task.Delay(1000);


                                    picSV.Visible = false;  // open sv of chamber
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA12" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA12";

                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A12";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA12")
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;

                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA12";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA12")

                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA12 into Chamber
                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.ShowDialog();

                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        //  await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            // await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "12");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        // cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        //  Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                        cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }






                                    picMain.Image.Tag = "finishchamberA12";




                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }


                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA12" && picSV.Visible == true)
                                {

                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA12" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA12-2";

                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA12-2")
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;

                                    picMain.Image.Tag = "picrobotAPMWaferA12-2";

                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA12-2" && picSV.Visible == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA12-2" && picSV.Visible == true)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA12-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA12-2")
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassettA12-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA12-2")
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "6")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "7")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "8")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "9")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "10")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "11")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "12")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                    }




                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 12)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();

                                        lblState.Text = "Finished";



                                    }
                                    picMain.Image.Tag = "finishwaferA12";
                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;
                                        lblState.Text = "Stopping";
                                    }


                                }
                                /////////////////////////////////////////////////////////finish waferA12
                            }

                            if (int.Parse(NoOfwafer[i]) >= 13)
                            {
                                //////////////////////////////////////////////////////////////////////////start waferA13
                                nooftherecipe = "13";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA12" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    picCassette.Image = Properties.Resources.cassette1;

                                    if (NoOfwafer[i] == "1")
                                    {
                                        picwafer.Image = Properties.Resources.wafer;
                                        picwafer.Image.Tag = "wafer";
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        picwafer.Image = Properties.Resources.waferA1full;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        picwafer.Image = Properties.Resources.waferA2full;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        picwafer.Image = Properties.Resources.waferA3full;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        picwafer.Image = Properties.Resources.waferA4full;
                                    }
                                    else if (NoOfwafer[i] == "6")
                                    {
                                        picwafer.Image = Properties.Resources.waferA5full;

                                    }
                                    else if (NoOfwafer[i] == "7")
                                    {
                                        picwafer.Image = Properties.Resources.waferA6full;

                                    }
                                    else if (NoOfwafer[i] == "8")
                                    {
                                        picwafer.Image = Properties.Resources.waferA7full;

                                    }
                                    else if (NoOfwafer[i] == "9")
                                    {
                                        picwafer.Image = Properties.Resources.waferA8full;

                                    }
                                    else if (NoOfwafer[i] == "10")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }
                                    else if (NoOfwafer[i] == "11")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }
                                    else if (NoOfwafer[i] == "12")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }
                                    else if (NoOfwafer[i] == "13")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer13.Visible = false;

                                    }


                                    StartTime = DateTime.Now;




                                    await Task.Delay(2000);
                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "13");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();

                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "waferA13mainpicture";

                                    await Task.Delay(1000);
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA13mainpicture")
                                {
                                    // lblCassette.BackColor = Color.LimeGreen;
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA13";
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA13")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA13";

                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A13";

                                    lblCassette.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA13")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA13";

                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A13";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA13")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA13";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A13";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA13")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA13-2";

                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A13";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA13-2")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA13";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A13";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA13" && picSV.Visible == true)
                                {
                                    await Task.Delay(1000);


                                    picSV.Visible = false;  // open sv of chamber
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA13" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA13";

                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A13";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA13")
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;

                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA13";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA13")

                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA13 into Chamber
                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.ShowDialog();

                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        //  await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            // await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "13");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        // cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        //  Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                        cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }






                                    picMain.Image.Tag = "finishchamberA13";




                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }


                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA13" && picSV.Visible == true)
                                {

                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA13" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA13-2";

                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA13-2")
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;

                                    picMain.Image.Tag = "picrobotAPMWaferA13-2";

                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA13-2" && picSV.Visible == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA13-2" && picSV.Visible == true)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA13-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA13-2")
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassettA13-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA13-2")
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "6")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "7")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "8")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "9")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "10")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "11")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "12")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "13")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                    }




                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 13)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();

                                        lblState.Text = "Finished";



                                    }
                                    picMain.Image.Tag = "finishwaferA13";
                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;
                                        lblState.Text = "Stopping";
                                    }


                                }
                                /////////////////////////////////////////////////////////finish waferA13
                            }

                            if (int.Parse(NoOfwafer[i]) >= 14)
                            {
                                //////////////////////////////////////////////////////////////////////////start waferA14
                                nooftherecipe = "14";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA13" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    picCassette.Image = Properties.Resources.cassette1;

                                    if (NoOfwafer[i] == "1")
                                    {
                                        picwafer.Image = Properties.Resources.wafer;
                                        picwafer.Image.Tag = "wafer";
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        picwafer.Image = Properties.Resources.waferA1full;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        picwafer.Image = Properties.Resources.waferA2full;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        picwafer.Image = Properties.Resources.waferA3full;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        picwafer.Image = Properties.Resources.waferA4full;
                                    }
                                    else if (NoOfwafer[i] == "6")
                                    {
                                        picwafer.Image = Properties.Resources.waferA5full;

                                    }
                                    else if (NoOfwafer[i] == "7")
                                    {
                                        picwafer.Image = Properties.Resources.waferA6full;

                                    }
                                    else if (NoOfwafer[i] == "8")
                                    {
                                        picwafer.Image = Properties.Resources.waferA7full;

                                    }
                                    else if (NoOfwafer[i] == "9")
                                    {
                                        picwafer.Image = Properties.Resources.waferA8full;

                                    }
                                    else if (NoOfwafer[i] == "10")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }
                                    else if (NoOfwafer[i] == "11")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "12")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "13")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer14.Visible = false;
                                    }



                                    StartTime = DateTime.Now;




                                    await Task.Delay(2000);
                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "14");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();

                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "waferA14mainpicture";

                                    await Task.Delay(1000);
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA14mainpicture")
                                {
                                    // lblCassette.BackColor = Color.LimeGreen;
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA14";
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA14")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA14";

                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A14";

                                    lblCassette.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA14")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA14";

                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A14";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA14")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA14";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A14";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA14")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA14-2";

                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A14";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA14-2")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA14";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A14";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA14" && picSV.Visible == true)
                                {
                                    await Task.Delay(1000);


                                    picSV.Visible = false;  // open sv of chamber
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA14" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA14";

                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A14";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA14")
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;

                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA14";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA14")

                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA14 into Chamber
                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.ShowDialog();

                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        //  await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            // await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "14");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        // cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        //  Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                        cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }






                                    picMain.Image.Tag = "finishchamberA14";




                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }


                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA14" && picSV.Visible == true)
                                {

                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA14" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA14-2";

                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA14-2")
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;

                                    picMain.Image.Tag = "picrobotAPMWaferA14-2";

                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA14-2" && picSV.Visible == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA14-2" && picSV.Visible == true)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA14-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA14-2")
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassettA14-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA14-2")
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "6")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "7")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "8")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "9")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "10")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "11")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "12")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "13")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;

                                    }





                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 14)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();

                                        lblState.Text = "Finished";



                                    }
                                    picMain.Image.Tag = "finishwaferA14";
                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;
                                        lblState.Text = "Stopping";
                                    }


                                }
                                /////////////////////////////////////////////////////////finish waferA14
                            }

                            if (int.Parse(NoOfwafer[i]) >= 15)
                            {
                                //////////////////////////////////////////////////////////////////////////start waferA15
                                nooftherecipe = "15";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA14" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    picCassette.Image = Properties.Resources.cassette1;

                                    if (NoOfwafer[i] == "1")
                                    {
                                        picwafer.Image = Properties.Resources.wafer;
                                        picwafer.Image.Tag = "wafer";
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        picwafer.Image = Properties.Resources.waferA1full;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        picwafer.Image = Properties.Resources.waferA2full;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        picwafer.Image = Properties.Resources.waferA3full;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        picwafer.Image = Properties.Resources.waferA4full;
                                    }
                                    else if (NoOfwafer[i] == "6")
                                    {
                                        picwafer.Image = Properties.Resources.waferA5full;

                                    }
                                    else if (NoOfwafer[i] == "7")
                                    {
                                        picwafer.Image = Properties.Resources.waferA6full;

                                    }
                                    else if (NoOfwafer[i] == "8")
                                    {
                                        picwafer.Image = Properties.Resources.waferA7full;

                                    }
                                    else if (NoOfwafer[i] == "9")
                                    {
                                        picwafer.Image = Properties.Resources.waferA8full;

                                    }
                                    else if (NoOfwafer[i] == "10")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }
                                    else if (NoOfwafer[i] == "11")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "12")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "13")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer14.Visible = false;
                                    }

                                    else if (NoOfwafer[i] == "15")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer15.Visible = false;
                                    }



                                    StartTime = DateTime.Now;




                                    await Task.Delay(2000);
                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "15");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();

                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "waferA15mainpicture";

                                    await Task.Delay(1000);
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA15mainpicture")
                                {
                                    // lblCassette.BackColor = Color.LimeGreen;
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA15";
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA15")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA15";

                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A15";

                                    lblCassette.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA15")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA15";

                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A15";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA15")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA15";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A15";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA15")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA15-2";

                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A15";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA15-2")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA15";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A15";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA15" && picSV.Visible == true)
                                {
                                    await Task.Delay(1000);


                                    picSV.Visible = false;  // open sv of chamber
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA15" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA15";

                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A15";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA15")
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;

                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA15";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA15")

                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA15 into Chamber
                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.ShowDialog();

                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        //  await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            // await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "15");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        // cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        //  Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                        cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }






                                    picMain.Image.Tag = "finishchamberA15";




                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }


                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA15" && picSV.Visible == true)
                                {

                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA15" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA15-2";

                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA15-2")
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;

                                    picMain.Image.Tag = "picrobotAPMWaferA15-2";

                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA15-2" && picSV.Visible == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA15-2" && picSV.Visible == true)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA15-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA15-2")
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassettA15-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA15-2")
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "6")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "7")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "8")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "9")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "10")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "11")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "12")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "13")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;

                                    }
                                    if (NoOfwafer[i] == "15")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                    }




                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 15)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();

                                        lblState.Text = "Finished";



                                    }
                                    picMain.Image.Tag = "finishwaferA15";
                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;
                                        lblState.Text = "Stopping";
                                    }


                                }
                                /////////////////////////////////////////////////////////finish waferA15
                            }

                            if (int.Parse(NoOfwafer[i]) >= 16)
                            {
                                //////////////////////////////////////////////////////////////////////////start waferA16
                                nooftherecipe = "16";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA15" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    picCassette.Image = Properties.Resources.cassette1;

                                    if (NoOfwafer[i] == "1")
                                    {
                                        picwafer.Image = Properties.Resources.wafer;
                                        picwafer.Image.Tag = "wafer";
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        picwafer.Image = Properties.Resources.waferA1full;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        picwafer.Image = Properties.Resources.waferA2full;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        picwafer.Image = Properties.Resources.waferA3full;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        picwafer.Image = Properties.Resources.waferA4full;
                                    }
                                    else if (NoOfwafer[i] == "6")
                                    {
                                        picwafer.Image = Properties.Resources.waferA5full;

                                    }
                                    else if (NoOfwafer[i] == "7")
                                    {
                                        picwafer.Image = Properties.Resources.waferA6full;

                                    }
                                    else if (NoOfwafer[i] == "8")
                                    {
                                        picwafer.Image = Properties.Resources.waferA7full;

                                    }
                                    else if (NoOfwafer[i] == "9")
                                    {
                                        picwafer.Image = Properties.Resources.waferA8full;

                                    }
                                    else if (NoOfwafer[i] == "10")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }
                                    else if (NoOfwafer[i] == "11")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "12")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "13")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer14.Visible = false;
                                    }

                                    else if (NoOfwafer[i] == "15")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer15.Visible = false;
                                    }

                                    else if (NoOfwafer[i] == "16")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer16.Visible = false;
                                    }

                                    StartTime = DateTime.Now;




                                    await Task.Delay(2000);
                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "16");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();

                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "waferA16mainpicture";

                                    await Task.Delay(1000);
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA16mainpicture")
                                {
                                    // lblCassette.BackColor = Color.LimeGreen;
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA16";
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA16")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA16";

                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A16";

                                    lblCassette.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA16")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA16";

                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A16";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA16")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA16";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A16";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA16")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA16-2";

                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A16";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA16-2")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA16";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A16";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA16" && picSV.Visible == true)
                                {
                                    await Task.Delay(1000);


                                    picSV.Visible = false;  // open sv of chamber
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA16" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA16";

                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A16";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA16")
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;

                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA16";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA16")

                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA16 into Chamber
                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.ShowDialog();

                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        //  await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            // await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "16");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        // cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        //  Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                        cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }






                                    picMain.Image.Tag = "finishchamberA16";




                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }


                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA16" && picSV.Visible == true)
                                {

                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA16" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA16-2";

                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA16-2")
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;

                                    picMain.Image.Tag = "picrobotAPMWaferA16-2";

                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA16-2" && picSV.Visible == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA16-2" && picSV.Visible == true)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA16-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA16-2")
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassettA16-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA16-2")
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "6")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "7")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "8")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "9")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "10")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "11")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "12")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "13")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;

                                    }
                                    if (NoOfwafer[i] == "15")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "16")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                    }




                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 16)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();

                                        lblState.Text = "Finished";



                                    }
                                    picMain.Image.Tag = "finishwaferA16";
                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;
                                        lblState.Text = "Stopping";
                                    }


                                }
                                /////////////////////////////////////////////////////////finish waferA16
                            }

                            if (int.Parse(NoOfwafer[i]) >= 17)
                            {
                                //////////////////////////////////////////////////////////////////////////start waferA17
                                nooftherecipe = "17";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA17" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    picCassette.Image = Properties.Resources.cassette1;

                                    if (NoOfwafer[i] == "1")
                                    {
                                        picwafer.Image = Properties.Resources.wafer;
                                        picwafer.Image.Tag = "wafer";
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        picwafer.Image = Properties.Resources.waferA1full;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        picwafer.Image = Properties.Resources.waferA2full;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        picwafer.Image = Properties.Resources.waferA3full;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        picwafer.Image = Properties.Resources.waferA4full;
                                    }
                                    else if (NoOfwafer[i] == "6")
                                    {
                                        picwafer.Image = Properties.Resources.waferA5full;

                                    }
                                    else if (NoOfwafer[i] == "7")
                                    {
                                        picwafer.Image = Properties.Resources.waferA6full;

                                    }
                                    else if (NoOfwafer[i] == "8")
                                    {
                                        picwafer.Image = Properties.Resources.waferA7full;

                                    }
                                    else if (NoOfwafer[i] == "9")
                                    {
                                        picwafer.Image = Properties.Resources.waferA8full;

                                    }
                                    else if (NoOfwafer[i] == "10")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }
                                    else if (NoOfwafer[i] == "11")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "12")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "13")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer14.Visible = false;
                                    }

                                    else if (NoOfwafer[i] == "15")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer15.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "16")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer15.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "17")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer17.Visible = false;
                                    }



                                    StartTime = DateTime.Now;




                                    await Task.Delay(2000);
                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "17");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();

                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "waferA17mainpicture";

                                    await Task.Delay(1000);
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA17mainpicture")
                                {
                                    // lblCassette.BackColor = Color.LimeGreen;
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA17";
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA17")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA17";

                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A17";

                                    lblCassette.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA17")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA17";

                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A17";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA17")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA17";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A17";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA17")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA17-2";

                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A17";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA17-2")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA17";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A17";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA17" && picSV.Visible == true)
                                {
                                    await Task.Delay(1000);


                                    picSV.Visible = false;  // open sv of chamber
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA17" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA17";

                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A17";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA17")
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;

                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA17";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA17")

                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA17 into Chamber
                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.ShowDialog();

                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        //  await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            // await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "17");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        // cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        //  Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                        cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }






                                    picMain.Image.Tag = "finishchamberA17";




                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }


                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA17" && picSV.Visible == true)
                                {

                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA17" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA17-2";

                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA17-2")
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;

                                    picMain.Image.Tag = "picrobotAPMWaferA17-2";

                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA17-2" && picSV.Visible == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA17-2" && picSV.Visible == true)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA17-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA17-2")
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassettA17-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA17-2")
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "6")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "7")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "8")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "9")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "10")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "11")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "12")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "13")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;

                                    }
                                    if (NoOfwafer[i] == "15")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "16")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "17")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                    }




                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 17)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();

                                        lblState.Text = "Finished";



                                    }
                                    picMain.Image.Tag = "finishwaferA17";
                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;
                                        lblState.Text = "Stopping";
                                    }


                                }
                                /////////////////////////////////////////////////////////finish waferA17
                            }

                            if (int.Parse(NoOfwafer[i]) >= 18)
                            {
                                //////////////////////////////////////////////////////////////////////////start waferA18
                                nooftherecipe = "18";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA18" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    picCassette.Image = Properties.Resources.cassette1;

                                    if (NoOfwafer[i] == "1")
                                    {
                                        picwafer.Image = Properties.Resources.wafer;
                                        picwafer.Image.Tag = "wafer";
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        picwafer.Image = Properties.Resources.waferA1full;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        picwafer.Image = Properties.Resources.waferA2full;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        picwafer.Image = Properties.Resources.waferA3full;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        picwafer.Image = Properties.Resources.waferA4full;
                                    }
                                    else if (NoOfwafer[i] == "6")
                                    {
                                        picwafer.Image = Properties.Resources.waferA5full;

                                    }
                                    else if (NoOfwafer[i] == "7")
                                    {
                                        picwafer.Image = Properties.Resources.waferA6full;

                                    }
                                    else if (NoOfwafer[i] == "8")
                                    {
                                        picwafer.Image = Properties.Resources.waferA7full;

                                    }
                                    else if (NoOfwafer[i] == "9")
                                    {
                                        picwafer.Image = Properties.Resources.waferA8full;

                                    }
                                    else if (NoOfwafer[i] == "10")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }
                                    else if (NoOfwafer[i] == "11")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "12")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "13")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer14.Visible = false;
                                    }

                                    else if (NoOfwafer[i] == "15")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer15.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "16")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer15.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "17")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer17.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "18")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer18.Visible = false;
                                    }



                                    StartTime = DateTime.Now;




                                    await Task.Delay(2000);
                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "18");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();

                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "waferA18mainpicture";

                                    await Task.Delay(1000);
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA18mainpicture")
                                {
                                    // lblCassette.BackColor = Color.LimeGreen;
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA18";
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA18")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA18";

                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A18";

                                    lblCassette.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA18")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA18";

                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A18";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA18")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA18";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A18";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA18")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA18-2";

                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A18";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA18-2")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA18";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A18";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA18" && picSV.Visible == true)
                                {
                                    await Task.Delay(1000);


                                    picSV.Visible = false;  // open sv of chamber
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA18" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA18";

                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A18";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA18")
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;

                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA18";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA18")

                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA18 into Chamber
                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.ShowDialog();

                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        //  await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            // await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "18");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        // cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        //  Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                        cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }






                                    picMain.Image.Tag = "finishchamberA18";




                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }


                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA18" && picSV.Visible == true)
                                {

                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA18" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA18-2";

                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA18-2")
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;

                                    picMain.Image.Tag = "picrobotAPMWaferA18-2";

                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA18-2" && picSV.Visible == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA18-2" && picSV.Visible == true)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA18-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA18-2")
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassettA18-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA18-2")
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "6")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "7")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "8")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "9")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "10")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "11")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "12")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "13")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;

                                    }
                                    if (NoOfwafer[i] == "15")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "16")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "17")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "18")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                    }



                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 18)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();

                                        lblState.Text = "Finished";



                                    }
                                    picMain.Image.Tag = "finishwaferA18";
                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;
                                        lblState.Text = "Stopping";
                                    }


                                }
                                /////////////////////////////////////////////////////////finish waferA18
                            }


                            if (int.Parse(NoOfwafer[i]) >= 19)
                            {
                                //////////////////////////////////////////////////////////////////////////start waferA19
                                nooftherecipe = "19";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA19" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    picCassette.Image = Properties.Resources.cassette1;

                                    if (NoOfwafer[i] == "1")
                                    {
                                        picwafer.Image = Properties.Resources.wafer;
                                        picwafer.Image.Tag = "wafer";
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        picwafer.Image = Properties.Resources.waferA1full;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        picwafer.Image = Properties.Resources.waferA2full;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        picwafer.Image = Properties.Resources.waferA3full;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        picwafer.Image = Properties.Resources.waferA4full;
                                    }
                                    else if (NoOfwafer[i] == "6")
                                    {
                                        picwafer.Image = Properties.Resources.waferA5full;

                                    }
                                    else if (NoOfwafer[i] == "7")
                                    {
                                        picwafer.Image = Properties.Resources.waferA6full;

                                    }
                                    else if (NoOfwafer[i] == "8")
                                    {
                                        picwafer.Image = Properties.Resources.waferA7full;

                                    }
                                    else if (NoOfwafer[i] == "9")
                                    {
                                        picwafer.Image = Properties.Resources.waferA8full;

                                    }
                                    else if (NoOfwafer[i] == "10")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }
                                    else if (NoOfwafer[i] == "11")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "12")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "13")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer14.Visible = false;
                                    }

                                    else if (NoOfwafer[i] == "15")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer15.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "16")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer15.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "17")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer17.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "18")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer18.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "19")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer19.Visible = false;
                                    }


                                    StartTime = DateTime.Now;




                                    await Task.Delay(2000);
                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "19");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();

                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "waferA19mainpicture";

                                    await Task.Delay(1000);
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA19mainpicture")
                                {
                                    // lblCassette.BackColor = Color.LimeGreen;
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA19";
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA19")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA19";

                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A19";

                                    lblCassette.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA19")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA19";

                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A19";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA19")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA19";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A19";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA19")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA19-2";

                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A19";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA19-2")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA19";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A19";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA19" && picSV.Visible == true)
                                {
                                    await Task.Delay(1000);


                                    picSV.Visible = false;  // open sv of chamber
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA19" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA19";

                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A19";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA19")
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;

                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA19";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA19")

                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA19 into Chamber
                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.ShowDialog();

                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        //  await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            // await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "19");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        // cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        //  Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                        cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }






                                    picMain.Image.Tag = "finishchamberA19";




                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }


                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA19" && picSV.Visible == true)
                                {

                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA19" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA19-2";

                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA19-2")
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;

                                    picMain.Image.Tag = "picrobotAPMWaferA19-2";

                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA19-2" && picSV.Visible == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA19-2" && picSV.Visible == true)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA19-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA19-2")
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassettA19-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA19-2")
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "6")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "7")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "8")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "9")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "10")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "11")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "12")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "13")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;

                                    }
                                    if (NoOfwafer[i] == "15")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "16")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "17")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "18")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "19")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                    }


                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 19)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();

                                        lblState.Text = "Finished";



                                    }
                                    picMain.Image.Tag = "finishwaferA19";
                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;
                                        lblState.Text = "Stopping";
                                    }


                                }
                                /////////////////////////////////////////////////////////finish waferA19
                            }

                            if (int.Parse(NoOfwafer[i]) >= 20)
                            {
                                //////////////////////////////////////////////////////////////////////////start waferA20
                                nooftherecipe = "20";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA20" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    picCassette.Image = Properties.Resources.cassette1;

                                    if (NoOfwafer[i] == "1")
                                    {
                                        picwafer.Image = Properties.Resources.wafer;
                                        picwafer.Image.Tag = "wafer";
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        picwafer.Image = Properties.Resources.waferA1full;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        picwafer.Image = Properties.Resources.waferA2full;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        picwafer.Image = Properties.Resources.waferA3full;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        picwafer.Image = Properties.Resources.waferA4full;
                                    }
                                    else if (NoOfwafer[i] == "6")
                                    {
                                        picwafer.Image = Properties.Resources.waferA5full;

                                    }
                                    else if (NoOfwafer[i] == "7")
                                    {
                                        picwafer.Image = Properties.Resources.waferA6full;

                                    }
                                    else if (NoOfwafer[i] == "8")
                                    {
                                        picwafer.Image = Properties.Resources.waferA7full;

                                    }
                                    else if (NoOfwafer[i] == "9")
                                    {
                                        picwafer.Image = Properties.Resources.waferA8full;

                                    }
                                    else if (NoOfwafer[i] == "10")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }
                                    else if (NoOfwafer[i] == "11")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "12")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "13")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer14.Visible = false;
                                    }

                                    else if (NoOfwafer[i] == "15")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer15.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "16")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer15.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "17")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer17.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "18")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer18.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "19")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer19.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "20")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer20.Visible = false;
                                    }

                                    StartTime = DateTime.Now;




                                    await Task.Delay(2000);
                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "20");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();

                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "waferA20mainpicture";

                                    await Task.Delay(1000);
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA20mainpicture")
                                {
                                    // lblCassette.BackColor = Color.LimeGreen;
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA20";
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA20")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA20";

                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A20";

                                    lblCassette.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA20")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA20";

                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A20";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA20")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA20";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A20";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA20")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA20-2";

                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A20";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA20-2")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA20";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A20";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA20" && picSV.Visible == true)
                                {
                                    await Task.Delay(1000);


                                    picSV.Visible = false;  // open sv of chamber
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA20" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA20";

                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A20";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA20")
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;

                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA20";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA20")

                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA20 into Chamber
                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.ShowDialog();

                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        //  await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            // await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "20");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        // cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        //  Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                        cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }






                                    picMain.Image.Tag = "finishchamberA20";




                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }


                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA20" && picSV.Visible == true)
                                {

                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA20" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA20-2";

                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA20-2")
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;

                                    picMain.Image.Tag = "picrobotAPMWaferA20-2";

                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA20-2" && picSV.Visible == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA20-2" && picSV.Visible == true)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA20-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA20-2")
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassettA20-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA20-2")
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "6")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "7")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "8")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "9")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "10")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "11")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "12")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "13")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;

                                    }
                                    if (NoOfwafer[i] == "15")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "16")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "17")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "18")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "19")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "20")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer20.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                        picWafer20.Image = Properties.Resources.picWaferGreen;
                                    }

                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 20)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();

                                        lblState.Text = "Finished";



                                    }
                                    picMain.Image.Tag = "finishwaferA20";
                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;
                                        lblState.Text = "Stopping";
                                    }


                                }
                                /////////////////////////////////////////////////////////finish waferA20
                            }

                            if (int.Parse(NoOfwafer[i]) >= 21)
                            {
                                //////////////////////////////////////////////////////////////////////////start waferA21
                                nooftherecipe = "21";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA21" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    picCassette.Image = Properties.Resources.cassette1;

                                    if (NoOfwafer[i] == "1")
                                    {
                                        picwafer.Image = Properties.Resources.wafer;
                                        picwafer.Image.Tag = "wafer";
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        picwafer.Image = Properties.Resources.waferA1full;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        picwafer.Image = Properties.Resources.waferA2full;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        picwafer.Image = Properties.Resources.waferA3full;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        picwafer.Image = Properties.Resources.waferA4full;
                                    }
                                    else if (NoOfwafer[i] == "6")
                                    {
                                        picwafer.Image = Properties.Resources.waferA5full;

                                    }
                                    else if (NoOfwafer[i] == "7")
                                    {
                                        picwafer.Image = Properties.Resources.waferA6full;

                                    }
                                    else if (NoOfwafer[i] == "8")
                                    {
                                        picwafer.Image = Properties.Resources.waferA7full;

                                    }
                                    else if (NoOfwafer[i] == "9")
                                    {
                                        picwafer.Image = Properties.Resources.waferA8full;

                                    }
                                    else if (NoOfwafer[i] == "10")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }
                                    else if (NoOfwafer[i] == "11")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "12")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "13")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer14.Visible = false;
                                    }

                                    else if (NoOfwafer[i] == "15")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer15.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "16")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer15.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "17")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer17.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "18")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer18.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "19")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer19.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "20")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer20.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "21")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer21.Visible = false;
                                    }
                                    StartTime = DateTime.Now;




                                    await Task.Delay(2000);
                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "21");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();

                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "waferA21mainpicture";

                                    await Task.Delay(1000);
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA21mainpicture")
                                {
                                    // lblCassette.BackColor = Color.LimeGreen;
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA21";
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA21")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA21";

                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A21";

                                    lblCassette.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA21")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA21";

                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A21";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA21")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA21";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A21";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA21")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA21-2";

                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A21";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA21-2")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA21";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A21";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA21" && picSV.Visible == true)
                                {
                                    await Task.Delay(1000);


                                    picSV.Visible = false;  // open sv of chamber
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA21" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA21";

                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A21";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA21")
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;

                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA21";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA21")

                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA21 into Chamber
                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.ShowDialog();

                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        //  await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            // await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "21");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        // cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        //  Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                        cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }






                                    picMain.Image.Tag = "finishchamberA21";




                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }


                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA21" && picSV.Visible == true)
                                {

                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA21" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA21-2";

                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA21-2")
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;

                                    picMain.Image.Tag = "picrobotAPMWaferA21-2";

                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA21-2" && picSV.Visible == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA21-2" && picSV.Visible == true)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA21-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA21-2")
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassettA21-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA21-2")
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "6")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "7")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "8")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "9")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "10")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "11")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "12")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "13")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;

                                    }
                                    if (NoOfwafer[i] == "15")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "16")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "17")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "18")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "19")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "20")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer20.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                        picWafer20.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "21")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer20.Visible = true;
                                        picWafer21.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                        picWafer20.Image = Properties.Resources.picWaferGreen;
                                        picWafer21.Image = Properties.Resources.picWaferGreen;
                                    }

                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 21)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();

                                        lblState.Text = "Finished";



                                    }
                                    picMain.Image.Tag = "finishwaferA21";
                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;
                                        lblState.Text = "Stopping";
                                    }


                                }
                                /////////////////////////////////////////////////////////finish waferA21
                            }

                            if (int.Parse(NoOfwafer[i]) >= 22)
                            {
                                //////////////////////////////////////////////////////////////////////////start waferA22
                                nooftherecipe = "22";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA21" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    picCassette.Image = Properties.Resources.cassette1;

                                    if (NoOfwafer[i] == "1")
                                    {
                                        picwafer.Image = Properties.Resources.wafer;
                                        picwafer.Image.Tag = "wafer";
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        picwafer.Image = Properties.Resources.waferA1full;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        picwafer.Image = Properties.Resources.waferA2full;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        picwafer.Image = Properties.Resources.waferA3full;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        picwafer.Image = Properties.Resources.waferA4full;
                                    }
                                    else if (NoOfwafer[i] == "6")
                                    {
                                        picwafer.Image = Properties.Resources.waferA5full;

                                    }
                                    else if (NoOfwafer[i] == "7")
                                    {
                                        picwafer.Image = Properties.Resources.waferA6full;

                                    }
                                    else if (NoOfwafer[i] == "8")
                                    {
                                        picwafer.Image = Properties.Resources.waferA7full;

                                    }
                                    else if (NoOfwafer[i] == "9")
                                    {
                                        picwafer.Image = Properties.Resources.waferA8full;

                                    }
                                    else if (NoOfwafer[i] == "10")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }
                                    else if (NoOfwafer[i] == "11")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "12")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "13")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer14.Visible = false;
                                    }

                                    else if (NoOfwafer[i] == "15")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer15.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "16")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer15.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "17")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer17.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "18")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer18.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "19")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer19.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "20")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer20.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "21")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer21.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "22")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer22.Visible = false;
                                    }
                                    StartTime = DateTime.Now;




                                    await Task.Delay(2000);
                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "22");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();

                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "waferA22mainpicture";

                                    await Task.Delay(1000);
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA22mainpicture")
                                {
                                    // lblCassette.BackColor = Color.LimeGreen;
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA22";
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA22")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA22";

                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A22";

                                    lblCassette.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA22")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA22";

                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A22";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA22")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA22";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A22";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA22")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA22-2";

                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A22";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA22-2")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA22";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A22";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA22" && picSV.Visible == true)
                                {
                                    await Task.Delay(1000);


                                    picSV.Visible = false;  // open sv of chamber
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA22" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA22";

                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A22";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA22")
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;

                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA22";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA22")

                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA22 into Chamber
                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.ShowDialog();

                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        //  await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            // await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "22");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        // cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        //  Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                        cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }






                                    picMain.Image.Tag = "finishchamberA22";




                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }


                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA22" && picSV.Visible == true)
                                {

                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA22" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA22-2";

                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA22-2")
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;

                                    picMain.Image.Tag = "picrobotAPMWaferA22-2";

                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA22-2" && picSV.Visible == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA22-2" && picSV.Visible == true)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA22-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA22-2")
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassettA22-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA22-2")
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "6")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "7")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "8")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "9")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "10")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "11")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "12")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "13")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;

                                    }
                                    if (NoOfwafer[i] == "15")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "16")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "17")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "18")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "19")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "20")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer20.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                        picWafer20.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "21")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer20.Visible = true;
                                        picWafer21.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                        picWafer20.Image = Properties.Resources.picWaferGreen;
                                        picWafer21.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "22")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer20.Visible = true;
                                        picWafer21.Visible = true;
                                        picWafer22.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                        picWafer20.Image = Properties.Resources.picWaferGreen;
                                        picWafer21.Image = Properties.Resources.picWaferGreen;
                                        picWafer22.Image = Properties.Resources.picWaferGreen;
                                    }

                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 22)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();

                                        lblState.Text = "Finished";



                                    }
                                    picMain.Image.Tag = "finishwaferA22";
                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;
                                        lblState.Text = "Stopping";
                                    }


                                }
                                /////////////////////////////////////////////////////////finish waferA22
                            }


                            if (int.Parse(NoOfwafer[i]) >= 23)
                            {
                                //////////////////////////////////////////////////////////////////////////start waferA23
                                nooftherecipe = "23";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA22" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    picCassette.Image = Properties.Resources.cassette1;

                                    if (NoOfwafer[i] == "1")
                                    {
                                        picwafer.Image = Properties.Resources.wafer;
                                        picwafer.Image.Tag = "wafer";
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        picwafer.Image = Properties.Resources.waferA1full;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        picwafer.Image = Properties.Resources.waferA2full;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        picwafer.Image = Properties.Resources.waferA3full;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        picwafer.Image = Properties.Resources.waferA4full;
                                    }
                                    else if (NoOfwafer[i] == "6")
                                    {
                                        picwafer.Image = Properties.Resources.waferA5full;

                                    }
                                    else if (NoOfwafer[i] == "7")
                                    {
                                        picwafer.Image = Properties.Resources.waferA6full;

                                    }
                                    else if (NoOfwafer[i] == "8")
                                    {
                                        picwafer.Image = Properties.Resources.waferA7full;

                                    }
                                    else if (NoOfwafer[i] == "9")
                                    {
                                        picwafer.Image = Properties.Resources.waferA8full;

                                    }
                                    else if (NoOfwafer[i] == "10")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }
                                    else if (NoOfwafer[i] == "11")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "12")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "13")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer14.Visible = false;
                                    }

                                    else if (NoOfwafer[i] == "15")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer15.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "16")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer15.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "17")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer17.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "18")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer18.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "19")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer19.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "20")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer20.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "21")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer21.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "22")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer22.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "23")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer22.Visible = false;
                                    }
                                    StartTime = DateTime.Now;




                                    await Task.Delay(2000);
                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "23");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();

                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "waferA23mainpicture";

                                    await Task.Delay(1000);
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA23mainpicture")
                                {
                                    // lblCassette.BackColor = Color.LimeGreen;
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA23";
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA23")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA23";

                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A23";

                                    lblCassette.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA23")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA23";

                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A23";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA23")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA23";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A23";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA23")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA23-2";

                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A23";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA23-2")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA23";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A23";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA23" && picSV.Visible == true)
                                {
                                    await Task.Delay(1000);


                                    picSV.Visible = false;  // open sv of chamber
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA23" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA23";

                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A23";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA23")
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;

                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA23";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA23")

                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA23 into Chamber
                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.ShowDialog();

                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        //  await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            // await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "23");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        // cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        //  Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                        cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }






                                    picMain.Image.Tag = "finishchamberA23";




                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }


                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA23" && picSV.Visible == true)
                                {

                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA23" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA23-2";

                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA23-2")
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;

                                    picMain.Image.Tag = "picrobotAPMWaferA23-2";

                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA23-2" && picSV.Visible == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA23-2" && picSV.Visible == true)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA23-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA23-2")
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassettA23-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA23-2")
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "6")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "7")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "8")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "9")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "10")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "11")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "12")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "13")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;

                                    }
                                    if (NoOfwafer[i] == "15")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "16")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "17")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "18")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "19")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "20")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer20.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                        picWafer20.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "21")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer20.Visible = true;
                                        picWafer21.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                        picWafer20.Image = Properties.Resources.picWaferGreen;
                                        picWafer21.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "22")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer20.Visible = true;
                                        picWafer21.Visible = true;
                                        picWafer22.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                        picWafer20.Image = Properties.Resources.picWaferGreen;
                                        picWafer21.Image = Properties.Resources.picWaferGreen;
                                        picWafer22.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "23")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer20.Visible = true;
                                        picWafer21.Visible = true;
                                        picWafer22.Visible = true;
                                        picWafer23.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                        picWafer20.Image = Properties.Resources.picWaferGreen;
                                        picWafer21.Image = Properties.Resources.picWaferGreen;
                                        picWafer22.Image = Properties.Resources.picWaferGreen;
                                        picWafer23.Image = Properties.Resources.picWaferGreen;
                                    }

                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 23)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();

                                        lblState.Text = "Finished";



                                    }
                                    picMain.Image.Tag = "finishwaferA23";
                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;
                                        lblState.Text = "Stopping";
                                    }


                                }
                                /////////////////////////////////////////////////////////finish waferA23
                            }

                            if (int.Parse(NoOfwafer[i]) >= 24)
                            {
                                //////////////////////////////////////////////////////////////////////////start waferA24
                                nooftherecipe = "24";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA23" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    picCassette.Image = Properties.Resources.cassette1;

                                    if (NoOfwafer[i] == "1")
                                    {
                                        picwafer.Image = Properties.Resources.wafer;
                                        picwafer.Image.Tag = "wafer";
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        picwafer.Image = Properties.Resources.waferA1full;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        picwafer.Image = Properties.Resources.waferA2full;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        picwafer.Image = Properties.Resources.waferA3full;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        picwafer.Image = Properties.Resources.waferA4full;
                                    }
                                    else if (NoOfwafer[i] == "6")
                                    {
                                        picwafer.Image = Properties.Resources.waferA5full;

                                    }
                                    else if (NoOfwafer[i] == "7")
                                    {
                                        picwafer.Image = Properties.Resources.waferA6full;

                                    }
                                    else if (NoOfwafer[i] == "8")
                                    {
                                        picwafer.Image = Properties.Resources.waferA7full;

                                    }
                                    else if (NoOfwafer[i] == "9")
                                    {
                                        picwafer.Image = Properties.Resources.waferA8full;

                                    }
                                    else if (NoOfwafer[i] == "10")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }
                                    else if (NoOfwafer[i] == "11")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "12")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "13")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer14.Visible = false;
                                    }

                                    else if (NoOfwafer[i] == "15")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer15.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "16")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer15.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "17")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer17.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "18")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer18.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "19")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer19.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "20")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer20.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "21")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer21.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "22")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer22.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "23")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer23.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "24")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer24.Visible = false;
                                    }

                                    StartTime = DateTime.Now;




                                    await Task.Delay(2000);
                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "24");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();

                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "waferA24mainpicture";

                                    await Task.Delay(1000);
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA24mainpicture")
                                {
                                    // lblCassette.BackColor = Color.LimeGreen;
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA24";
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA24")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA24";

                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A24";

                                    lblCassette.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA24")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA24";

                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A24";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA24")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA24";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A24";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA24")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA24-2";

                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A24";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA24-2")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA24";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A24";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA24" && picSV.Visible == true)
                                {
                                    await Task.Delay(1000);


                                    picSV.Visible = false;  // open sv of chamber
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA24" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA24";

                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A24";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA24")
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;

                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA24";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA24")

                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA24 into Chamber
                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.ShowDialog();

                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        //  await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            // await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "24");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        // cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        //  Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                        cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }






                                    picMain.Image.Tag = "finishchamberA24";




                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }


                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA24" && picSV.Visible == true)
                                {

                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA24" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA24-2";

                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA24-2")
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;

                                    picMain.Image.Tag = "picrobotAPMWaferA24-2";

                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA24-2" && picSV.Visible == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA24-2" && picSV.Visible == true)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA24-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA24-2")
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassettA24-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA24-2")
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "6")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "7")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "8")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "9")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "10")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "11")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "12")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "13")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;

                                    }
                                    if (NoOfwafer[i] == "15")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "16")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "17")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "18")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "19")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "20")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer20.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                        picWafer20.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "21")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer20.Visible = true;
                                        picWafer21.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                        picWafer20.Image = Properties.Resources.picWaferGreen;
                                        picWafer21.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "22")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer20.Visible = true;
                                        picWafer21.Visible = true;
                                        picWafer22.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                        picWafer20.Image = Properties.Resources.picWaferGreen;
                                        picWafer21.Image = Properties.Resources.picWaferGreen;
                                        picWafer22.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "23")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer20.Visible = true;
                                        picWafer21.Visible = true;
                                        picWafer22.Visible = true;
                                        picWafer23.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                        picWafer20.Image = Properties.Resources.picWaferGreen;
                                        picWafer21.Image = Properties.Resources.picWaferGreen;
                                        picWafer22.Image = Properties.Resources.picWaferGreen;
                                        picWafer23.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "24")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer20.Visible = true;
                                        picWafer21.Visible = true;
                                        picWafer22.Visible = true;
                                        picWafer23.Visible = true;
                                        picWafer24.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                        picWafer20.Image = Properties.Resources.picWaferGreen;
                                        picWafer21.Image = Properties.Resources.picWaferGreen;
                                        picWafer22.Image = Properties.Resources.picWaferGreen;
                                        picWafer23.Image = Properties.Resources.picWaferGreen;
                                        picWafer24.Image = Properties.Resources.picWaferGreen;
                                    }


                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 24)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();

                                        lblState.Text = "Finished";



                                    }
                                    picMain.Image.Tag = "finishwaferA24";
                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;
                                        lblState.Text = "Stopping";
                                    }


                                }
                                /////////////////////////////////////////////////////////finish waferA24
                            }

                            if (int.Parse(NoOfwafer[i]) >= 25)
                            {
                                //////////////////////////////////////////////////////////////////////////start waferA25
                                nooftherecipe = "25";
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishWaferA24" && isStopRobot == false && iscancelrecipe == false)
                                {
                                    await Task.Delay(2000);

                                    picCassette.Image = Properties.Resources.cassette1;

                                    if (NoOfwafer[i] == "1")
                                    {
                                        picwafer.Image = Properties.Resources.wafer;
                                        picwafer.Image.Tag = "wafer";
                                    }
                                    else if (NoOfwafer[i] == "2")
                                    {
                                        picwafer.Image = Properties.Resources.waferA1full;
                                    }
                                    else if (NoOfwafer[i] == "3")
                                    {
                                        picwafer.Image = Properties.Resources.waferA2full;

                                    }
                                    else if (NoOfwafer[i] == "4")
                                    {
                                        picwafer.Image = Properties.Resources.waferA3full;
                                    }
                                    else if (NoOfwafer[i] == "5")
                                    {
                                        picwafer.Image = Properties.Resources.waferA4full;
                                    }
                                    else if (NoOfwafer[i] == "6")
                                    {
                                        picwafer.Image = Properties.Resources.waferA5full;

                                    }
                                    else if (NoOfwafer[i] == "7")
                                    {
                                        picwafer.Image = Properties.Resources.waferA6full;

                                    }
                                    else if (NoOfwafer[i] == "8")
                                    {
                                        picwafer.Image = Properties.Resources.waferA7full;

                                    }
                                    else if (NoOfwafer[i] == "9")
                                    {
                                        picwafer.Image = Properties.Resources.waferA8full;

                                    }
                                    else if (NoOfwafer[i] == "10")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }
                                    else if (NoOfwafer[i] == "11")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "12")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "13")
                                    {
                                        picwafer.Image = Properties.Resources.waferA9full;

                                    }

                                    else if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer14.Visible = false;
                                    }

                                    else if (NoOfwafer[i] == "15")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer15.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "16")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer15.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "17")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer17.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "18")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer18.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "19")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer19.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "20")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer20.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "21")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer21.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "22")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer22.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "23")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer23.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "24")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer24.Visible = false;
                                    }
                                    else if (NoOfwafer[i] == "25")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA9full;
                                        picWafer25.Visible = false;
                                    }

                                    StartTime = DateTime.Now;




                                    await Task.Delay(2000);
                                    con.Open();

                                    string strWaferSelection = "insert into WaferSelection(NoOfWafers,StartTime,CassetteRecipeName,Logname) values(@NoOfWafer,@StartTime,@CassetteRecipeName,@Logname)";
                                    SqlCommand cmdwaferselection = new SqlCommand(strWaferSelection, con);
                                    cmdwaferselection.Parameters.AddWithValue("@NoOfWafer", "25");
                                    cmdwaferselection.Parameters.AddWithValue("@StartTime", StartTime);
                                    cmdwaferselection.Parameters.AddWithValue("@CassetteRecipeName", form2Msg);
                                    cmdwaferselection.Parameters.AddWithValue("@Logname", lbl123.Text);

                                    cmdwaferselection.ExecuteNonQuery();

                                    con.Close();

                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image.Tag = "waferA25mainpicture";

                                    await Task.Delay(1000);
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "waferA25mainpicture")
                                {
                                    // lblCassette.BackColor = Color.LimeGreen;
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassetteA25";
                                    label1.BackColor = Color.Blue;
                                    lblLoad.Text = "";
                                    lblLoad.BackColor = Color.Blue;
                                    lbl123.BackColor = Color.Blue;
                                    lblState.BackColor = Color.Blue;
                                    lblCassetteRecipename.BackColor = Color.Blue;
                                    lblmTorr.BackColor = Color.Blue;


                                    lblCassette.BackColor = Color.LimeGreen;

                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassetteA25")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA25";

                                    lblwafer.Visible = true;
                                    lblwafer.Text = "A25";

                                    lblCassette.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA25")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA25";

                                    ovalShape1.Left += 70;
                                    ovalShape1.Top -= 85;
                                    lblwafer.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A25";
                                    lblwafer.Left += 70;
                                    lblwafer.Top -= 85;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA25")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAlignerWafer;
                                    picMain.Image.Tag = "picrobotintoAlignerWaferA25";
                                    lblCentralize.BackColor = Color.LimeGreen;
                                    ovalShape1.Left += 155;
                                    ovalShape1.Top += 0;
                                    lblwaferright.Visible = false;
                                    lblwaferaligner.Visible = true;
                                    lblwaferaligner.Text = "A25";
                                    lblwafer.Left += 155;
                                    lblwafer.Top += 0;

                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAlignerWaferA25")
                                {
                                    await Task.Delay(1000);
                                    picMain.Image = Properties.Resources.picrobotAlignerWafer;
                                    picMain.Image.Tag = "picrobotAlignerWaferA25-2";

                                    lblwaferaligner.Visible = false;
                                    lblwaferright.Visible = true;
                                    lblwaferright.Text = "A25";
                                    ovalShape1.Left -= 155;
                                    ovalShape1.Top -= 0;
                                    lblwafer.Left -= 155;
                                    lblwafer.Top -= 0;
                                    lblCentralize.BackColor = Color.Blue;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAlignerWaferA25-2")
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotAPMWafer;
                                    picMain.Image.Tag = "picrobotAPMWaferA25";
                                    lblwaferright.Visible = false;
                                    lblwaferup.Visible = true;
                                    lblwaferup.Text = "A25";
                                    ovalShape1.Left -= 82;
                                    ovalShape1.Top -= 76;
                                    lblwafer.Left -= 82;
                                    lblwafer.Top -= 76;
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA25" && picSV.Visible == true)
                                {
                                    await Task.Delay(1000);


                                    picSV.Visible = false;  // open sv of chamber
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA25" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA25";

                                    lblwaferup.Visible = false;
                                    lblwaferAPM.Visible = true;
                                    lblwaferAPM.Text = "A25";
                                    ovalShape1.Top -= 145;
                                    ovalShape1.Left += 3;
                                    lblwafer.Top -= 145;
                                    lblwafer.Left += 3;



                                    lblChamber.BackColor = Color.LimeGreen;

                                    chamberload = "LimeGreen";
                                }

                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA25")
                                {
                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;

                                    //   picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picwaferinAPM;
                                    picMain.Image.Tag = "picwaferinAPMA25";
                                    ovalShape1.Left -= 1;
                                    ovalShape1.Left += 1;
                                    //  picMain.SendToBack();
                                    // ovalShape1.BringToFront();
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;


                                    //  pictRobot.Visible = true;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picwaferinAPMA25")

                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.ChamberWithA1Close;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1close;
                                    picSV.Visible = true;

                                    ///////////////////////////////////////////////////////////////////////////////////////////////////////WaferA25 into Chamber
                                    Chamber1 chamber1 = new Chamber1();
                                    chamber1.ShowDialog();

                                    lblRecipe.BackColor = Color.LimeGreen;
                                    lblStepName.BackColor = Color.LimeGreen;

                                    lblnum.BackColor = Color.LimeGreen;

                                    lblData.BackColor = Color.LimeGreen;
                                    lblData.Text = "";
                                    label2.BackColor = Color.LimeGreen;

                                    lblProcess.Text = "Processing";
                                    lblProcess.BackColor = Color.LimeGreen;
                                    lblProcessStep.Text = "Process Step";
                                    lblProcessStep.BackColor = Color.LimeGreen;



                                    con.Open();
                                    string strSQL = "select WaferRecipe from CassetteWafer  where CassetterecipeName = @NewWaferRecipe";

                                    SqlCommand cmd = new SqlCommand(strSQL, con);
                                    cmd.Parameters.AddWithValue("@NewWaferRecipe", Form1.form2Msg);
                                    SqlDataReader reader = cmd.ExecuteReader();
                                    while (reader.Read())
                                    {

                                        lblRecipe.Text = string.Format("{0}", reader["WaferRecipe"]);



                                    }

                                    con.Close();
                                    con.Open();
                                    string strSQL1 = "select stepname from newrecipe where recipename = @Myrecipename";

                                    SqlCommand cmd1 = new SqlCommand(strSQL1, con);
                                    cmd1.Parameters.AddWithValue("@Myrecipename", lblRecipe.Text);
                                    SqlDataReader reader1 = cmd1.ExecuteReader();
                                    while (reader1.Read())
                                    {

                                        strStepname1.Add(string.Format("{0}", reader1["StepName"]));


                                    }

                                    con.Close();

                                    con.Open();
                                    string strSQL2 = "select StepName from newrecipe inner join CassetteWafer on newrecipe.recipename = cassettewafer.waferRecipe where cassettewafer.waferRecipe = @Newrecipename";
                                    SqlCommand cmd2 = new SqlCommand(strSQL2, con);
                                    cmd2.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);

                                    cmd2.ExecuteNonQuery();



                                    for (int j = 0; j < strStepname1.Count(); j += 1)

                                    {

                                        //  await Task.Delay(1000);

                                        ListStepStartTime.Add(DateTime.Now);


                                        int count = j + 1;


                                        lblStepName.Text = strStepname1[j];
                                        lblnum.Text = "," + count + "/" + strStepname1.Count();


                                        con.Close();

                                        con.Open();
                                        string strSQLStepSec = "select * from newrecipe where stepname = @NewSec";

                                        SqlCommand cmdSec = new SqlCommand(strSQLStepSec, con);
                                        cmdSec.Parameters.AddWithValue("@NewSec", lblStepName.Text);

                                        SqlDataReader readerSec = cmdSec.ExecuteReader();


                                        while (readerSec.Read())
                                        {
                                            mySec1 = readerSec["ProcessTime"].ToString();

                                            Int32.TryParse(mySec1, out Sec1);

                                        }

                                        for (int k = 1; k <= Sec1; k++)
                                        {
                                            lblData.Text = k.ToString() + "/" + mySec1.ToString() + " Sec";
                                            // await Task.Delay(1000);


                                        }
                                        ListStepEndTime.Add(DateTime.Now);

                                        con.Close();

                                        con.Open();

                                        string strModuleRecipe = "insert into ModuleRecipe(RecipeName,StepName,StartTime,EndTime,noofrecipe,logname) values(@recipename,@stepname,@starttime,@endtime,@noofrecipe,@Logname)";

                                        SqlCommand cmdmodulerecipe = new SqlCommand(strModuleRecipe, con);

                                        cmdmodulerecipe.Parameters.AddWithValue("@recipename", lblRecipe.Text);
                                        cmdmodulerecipe.Parameters.AddWithValue("@stepname", strStepname1[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@starttime", ListStepStartTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@endtime", ListStepEndTime[j]);
                                        cmdmodulerecipe.Parameters.AddWithValue("@noofrecipe", "25");
                                        cmdmodulerecipe.Parameters.AddWithValue("@Logname", lbl123.Text);

                                        // cmdmodulerecipe.ExecuteNonQuery();

                                        con.Close();
                                        //////////////////////////////////////////////////////////////////////////////////////////////////////get parameter value

                                        con.Open();

                                        string strSQL3 = "select * from newrecipe where stepname = @Newstepname and recipename = @Newrecipename";

                                        SqlCommand cmd3 = new SqlCommand(strSQL3, con);
                                        cmd3.Parameters.AddWithValue("@Newstepname", lblStepName.Text);
                                        cmd3.Parameters.AddWithValue("@Newrecipename", lblRecipe.Text);
                                        SqlDataReader reader2 = cmd3.ExecuteReader();

                                        while (reader2.Read())
                                        {
                                            CI2 = reader2["CI2"].ToString();
                                            BCI3 = reader2["BCI3"].ToString();
                                            SF6 = reader2["SF6"].ToString();
                                            CHF3 = reader2["CHF3"].ToString();
                                            Oxygen = reader2["Oxygen"].ToString();
                                            Oxygen1 = reader2["Oxygen1"].ToString();
                                            Nitrogen = reader2["Nitrogen"].ToString();
                                            Argon = reader2["Argon"].ToString();



                                        }

                                        con.Close();

                                        ///////////////////////////////////////////////////////////////////////////////////////////////////
                                        con.Open();
                                        //  Chamber1 chamber1 = new Chamber1();

                                        string strParameter = "insert into valueselection(parameter,Minimum,Maximum,Average,Units,recipename,stepname,valuedate) values(@11,@21,@31,@41,@51,@61,@71,@81),(@12,@22,@32,@42,@52,@62,@72,@82),(@13,@23,@33,@43,@53,@63,@73,@83)"
                                            + ",(@14,@24,@34,@44,@54,@64,@74,@84),(@15,@25,@35,@45,@55,@65,@75,@85),(@16,@26,@36,@46,@56,@66,@76,@86),(@17,@27,@37,@47,@57,@67,@77,@87),(@18,@28,@38,@48,@58,@68,@78,@88)";
                                        SqlCommand cmdparameter = new SqlCommand(strParameter, con);
                                        cmdparameter.Parameters.AddWithValue("@11", "CI2");
                                        cmdparameter.Parameters.AddWithValue("@12", "BCI3");
                                        cmdparameter.Parameters.AddWithValue("@13", "SF6");
                                        cmdparameter.Parameters.AddWithValue("@14", "CHF3");
                                        cmdparameter.Parameters.AddWithValue("@15", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@16", "Oxygen");
                                        cmdparameter.Parameters.AddWithValue("@17", "Nitrogen");
                                        cmdparameter.Parameters.AddWithValue("@18", "Argon");
                                        cmdparameter.Parameters.AddWithValue("@21", CI2);
                                        cmdparameter.Parameters.AddWithValue("@22", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@23", SF6);
                                        cmdparameter.Parameters.AddWithValue("@24", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@25", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@26", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@27", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@28", Argon);
                                        cmdparameter.Parameters.AddWithValue("@31", CI2);
                                        cmdparameter.Parameters.AddWithValue("@32", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@33", SF6);
                                        cmdparameter.Parameters.AddWithValue("@34", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@35", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@36", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@37", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@38", Argon);
                                        cmdparameter.Parameters.AddWithValue("@41", CI2);
                                        cmdparameter.Parameters.AddWithValue("@42", BCI3);
                                        cmdparameter.Parameters.AddWithValue("@43", SF6);
                                        cmdparameter.Parameters.AddWithValue("@44", CHF3);
                                        cmdparameter.Parameters.AddWithValue("@45", Oxygen);
                                        cmdparameter.Parameters.AddWithValue("@46", Oxygen1);
                                        cmdparameter.Parameters.AddWithValue("@47", Nitrogen);
                                        cmdparameter.Parameters.AddWithValue("@48", Argon);
                                        cmdparameter.Parameters.AddWithValue("@51", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@52", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@53", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@54", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@55", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@56", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@57", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@58", "sccm");
                                        cmdparameter.Parameters.AddWithValue("@61", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@62", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@63", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@64", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@65", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@66", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@67", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@68", lblRecipe.Text);
                                        cmdparameter.Parameters.AddWithValue("@71", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@72", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@73", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@74", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@75", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@76", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@77", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@78", strStepname1[j]);
                                        cmdparameter.Parameters.AddWithValue("@81", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@82", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@83", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@84", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@85", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@86", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@87", DateTime.Now);
                                        cmdparameter.Parameters.AddWithValue("@88", DateTime.Now);


                                        cmdparameter.ExecuteNonQuery();
                                        con.Close();

                                    }
                                    ///////////////////////////////////////////////


                                    strStepname1.Clear();
                                    ListStepStartTime.Clear();
                                    ListStepEndTime.Clear();

                                    // }






                                    picMain.Image.Tag = "finishchamberA25";




                                    /////////////////////////////////////////////////////////////////////////////////////////////////// 
                                }


                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA25" && picSV.Visible == true)
                                {

                                    await Task.Delay(1000);
                                    picChamber.Image = Properties.Resources.ChamberWithA1;
                                    //picMain.Image = Properties.Resources.robotintochamberwithA1;
                                    picSV.Visible = false;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "finishchamberA25" && picSV.Visible == false)
                                {
                                    await Task.Delay(1000);

                                    picChamber.Image = Properties.Resources.robot_into_chamberA11;
                                    picMain.Image = Properties.Resources.picrobotintochamber;
                                    picMain.Image = Properties.Resources.picrobotintoAPMWafer;
                                    picMain.Image.Tag = "picrobotintoAPMWaferA25-2";

                                    ovalShape1.Left += 1;
                                    ovalShape1.Left -= 1;
                                    picChamber.Width += 140;
                                    picChamber.Left -= 150;
                                    picChamber.Height += 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintoAPMWaferA25-2")
                                {
                                    await Task.Delay(1000);
                                    label2.BackColor = Color.Blue;
                                    lblProcess.BackColor = Color.Blue;
                                    lblProcessStep.BackColor = Color.Blue;
                                    lblRecipe.BackColor = Color.Blue;
                                    lblStepName.BackColor = Color.Blue;
                                    lblData.BackColor = Color.Blue;
                                    lblnum.BackColor = Color.Blue;

                                    lblProcess.Text = "Idle";
                                    lblProcessStep.Text = "";
                                    lblRecipe.Text = "";
                                    lblStepName.Text = "";
                                    lblnum.Text = "";
                                    lblData.Text = "";


                                    // pictRobot.Visible = true;

                                    picChamber.Image = Properties.Resources.new_chamber1;
                                    picMain.Image = Properties.Resources.picrobotbotton;
                                    picMain.Image = Properties.Resources.picrobotAPMWafer;

                                    picMain.Image.Tag = "picrobotAPMWaferA25-2";

                                    lblwaferAPM.Visible = false;
                                    lblwaferup.Visible = true;

                                    ovalShape1.Top += 145;
                                    ovalShape1.Left -= 3;
                                    lblwafer.Top += 145;
                                    lblwafer.Left -= 3;

                                    lblChamber.BackColor = Color.Blue;
                                    chamberload = "Blue";
                                    picChamber.Width -= 140;
                                    picChamber.Left += 150;
                                    picChamber.Height -= 10;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA25-2" && picSV.Visible == false)
                                {
                                    await Task.Delay(2000);
                                    picChamber.Image = Properties.Resources.new_chamber;//close chamber

                                    // picMain.Image = Properties.Resources.robotrightA1;
                                    picSV.Visible = true;


                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotAPMWaferA25-2" && picSV.Visible == true)
                                {
                                    await Task.Delay(2000);

                                    // pictRobot.Height += 20;

                                    // picMain.Image = Properties.Resources.robotgetwaferA1cassetteclose;
                                    picMain.Image = Properties.Resources.mainpicture;
                                    picMain.Image = Properties.Resources.picrobotArmWafer;
                                    picMain.Image.Tag = "picrobotArmWaferA25-2";
                                    lblwaferup.Visible = false;
                                    lblwafer.Visible = true;
                                    ovalShape1.Top += 162;
                                    lblwafer.Top += 162;
                                    ovalShape1.Left += 12;
                                    lblwafer.Left += 12;
                                    await Task.Delay(2000);

                                    await Task.Delay(1000);
                                    picCassette.Image = Properties.Resources.cassette3;//open cassette
                                                                                       // picMain.Image = Properties.Resources.robotgetwaferA1;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotArmWaferA25-2")
                                {
                                    await Task.Delay(1000);

                                    lblCassette.BackColor = Color.LimeGreen;

                                    picCassette.Image = Properties.Resources.robot_into_cassetteA1;
                                    picMain.Image = Properties.Resources.picrobotintocassette;
                                    picMain.Image.Tag = "picrobotintocassettA25-2";
                                    lblwafer.Visible = false;
                                    lblwafer.Visible = false;
                                    ovalShape1.Visible = false;
                                    picCassette.Height += 220;
                                    picCassette.Width += 25;
                                    picCassette.Top -= 205;
                                }
                                if (ispauserobot == false && picMain.Image.Tag.ToString() == "picrobotintocassettA25-2")
                                {
                                    await Task.Delay(2000);
                                    lblCassette.BackColor = Color.Blue;
                                    //  pictRobot.Visible = true;

                                    picMain.Image = Properties.Resources.mainpicture;
                                    picCassette.Image = Properties.Resources.cassette3;
                                    picCassette.Width -= 25;
                                    picCassette.Height -= 220;
                                    picCassette.Top += 205;
                                    await Task.Delay(2000);
                                    //  picMain.Image = Properties.Resources.mainpic;
                                    picCassette.Image = Properties.Resources.cassette;
                                    // picwafer.Image = Properties.Resources.waferfull;
                                    if (NoOfwafer[i] == "1")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA1full;
                                        picWafer1.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "2")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA2full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "3")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA3full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                    }
                                    if (NoOfwafer[i] == "4")
                                    {
                                        // picwafer.Image = Properties.Resources.waferA4full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "5")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "6")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "7")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "8")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "9")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "10")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "11")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "12")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "13")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "14")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;

                                    }
                                    if (NoOfwafer[i] == "15")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "16")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "17")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "18")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "19")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "20")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer20.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                        picWafer20.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "21")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer20.Visible = true;
                                        picWafer21.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                        picWafer20.Image = Properties.Resources.picWaferGreen;
                                        picWafer21.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "22")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer20.Visible = true;
                                        picWafer21.Visible = true;
                                        picWafer22.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                        picWafer20.Image = Properties.Resources.picWaferGreen;
                                        picWafer21.Image = Properties.Resources.picWaferGreen;
                                        picWafer22.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "23")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer20.Visible = true;
                                        picWafer21.Visible = true;
                                        picWafer22.Visible = true;
                                        picWafer23.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                        picWafer20.Image = Properties.Resources.picWaferGreen;
                                        picWafer21.Image = Properties.Resources.picWaferGreen;
                                        picWafer22.Image = Properties.Resources.picWaferGreen;
                                        picWafer23.Image = Properties.Resources.picWaferGreen;
                                    }

                                    if (NoOfwafer[i] == "24")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer20.Visible = true;
                                        picWafer21.Visible = true;
                                        picWafer22.Visible = true;
                                        picWafer23.Visible = true;
                                        picWafer24.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                        picWafer20.Image = Properties.Resources.picWaferGreen;
                                        picWafer21.Image = Properties.Resources.picWaferGreen;
                                        picWafer22.Image = Properties.Resources.picWaferGreen;
                                        picWafer23.Image = Properties.Resources.picWaferGreen;
                                        picWafer24.Image = Properties.Resources.picWaferGreen;
                                    }
                                    if (NoOfwafer[i] == "25")
                                    {
                                        //  picwafer.Image = Properties.Resources.waferA5full;
                                        picWafer1.Visible = true;
                                        picWafer2.Visible = true;
                                        picWafer3.Visible = true;
                                        picWafer4.Visible = true;
                                        picWafer5.Visible = true;
                                        picWafer6.Visible = true;
                                        picWafer7.Visible = true;
                                        picWafer8.Visible = true;
                                        picWafer9.Visible = true;
                                        picWafer10.Visible = true;
                                        picWafer11.Visible = true;
                                        picWafer12.Visible = true;
                                        picWafer13.Visible = true;
                                        picWafer14.Visible = true;
                                        picWafer15.Visible = true;
                                        picWafer16.Visible = true;
                                        picWafer17.Visible = true;
                                        picWafer18.Visible = true;
                                        picWafer19.Visible = true;
                                        picWafer20.Visible = true;
                                        picWafer21.Visible = true;
                                        picWafer22.Visible = true;
                                        picWafer23.Visible = true;
                                        picWafer24.Visible = true;
                                        picWafer25.Visible = true;
                                        picWafer2.Image = Properties.Resources.picWaferGreen;
                                        picWafer1.Image = Properties.Resources.picWaferGreen;
                                        picWafer3.Image = Properties.Resources.picWaferGreen;
                                        picWafer4.Image = Properties.Resources.picWaferGreen;
                                        picWafer5.Image = Properties.Resources.picWaferGreen;
                                        picWafer6.Image = Properties.Resources.picWaferGreen;
                                        picWafer7.Image = Properties.Resources.picWaferGreen;
                                        picWafer8.Image = Properties.Resources.picWaferGreen;
                                        picWafer9.Image = Properties.Resources.picWaferGreen;
                                        picWafer10.Image = Properties.Resources.picWaferGreen;
                                        picWafer11.Image = Properties.Resources.picWaferGreen;
                                        picWafer12.Image = Properties.Resources.picWaferGreen;
                                        picWafer13.Image = Properties.Resources.picWaferGreen;
                                        picWafer14.Image = Properties.Resources.picWaferGreen;
                                        picWafer15.Image = Properties.Resources.picWaferGreen;
                                        picWafer16.Image = Properties.Resources.picWaferGreen;
                                        picWafer17.Image = Properties.Resources.picWaferGreen;
                                        picWafer18.Image = Properties.Resources.picWaferGreen;
                                        picWafer19.Image = Properties.Resources.picWaferGreen;
                                        picWafer20.Image = Properties.Resources.picWaferGreen;
                                        picWafer21.Image = Properties.Resources.picWaferGreen;
                                        picWafer22.Image = Properties.Resources.picWaferGreen;
                                        picWafer23.Image = Properties.Resources.picWaferGreen;
                                        picWafer24.Image = Properties.Resources.picWaferGreen;
                                        picWafer25.Image = Properties.Resources.picWaferGreen;
                                    }


                                    //////////////////////////////////////////////////////////////////Save DataLog
                                    if (int.Parse(NoOfwafer[i]) == 25)
                                    {
                                        EndTime = DateTime.Now;


                                        con.Open();

                                        string strinsertdatalog = "insert into DataLogger(logname,cassetterecipename,starttime) values(@1,@2,@3) ";
                                        SqlCommand cmdinsertdatalog = new SqlCommand(strinsertdatalog, con);

                                        cmdinsertdatalog.Parameters.AddWithValue("@1", lbl123.Text);
                                        cmdinsertdatalog.Parameters.AddWithValue("@2", form2Msg);
                                        cmdinsertdatalog.Parameters.AddWithValue("@3", StartTime);

                                        cmdinsertdatalog.ExecuteNonQuery();

                                        con.Close();

                                        lblState.Text = "Finished";



                                    }
                                    picMain.Image.Tag = "finishwaferA25";
                                    if (isStopRobot == true)
                                    {
                                        button2.Enabled = true;
                                        lblState.Text = "Stopping";
                                    }


                                }
                                /////////////////////////////////////////////////////////finish waferA25
                            }


                        }





                        }
                        if (ispauserobot == true)

                    {
                        button3.Enabled = false;
                        button4.Enabled = false;
                        button5.Enabled = false;

                        return;

                    }
                    if (isStopRobot == true)
                    {



                        return;

                    }

                    if (iscancelrecipe == true)
                    {


                        picMain.Image = Properties.Resources.mainpicture;

                        button3.Enabled = false;
                        button4.Enabled = false;
                        button5.Enabled = false;

                        lblwafer.Visible = false;
                        lblwaferup.Visible = false;
                        lblwaferaligner.Visible = false;
                        lblwaferright.Visible = false;
                        lblwaferAPM.Visible = false;

                        lblState.Text = "";
                        lblnum.Text = "";
                        lblStepName.Text = "";
                        lblRecipe.Text = "";
                        lblProcessStep.Text = "";
                        lblProcess.Text = "idle";

                        button2.Enabled = true;
                        button2.Tag = "";

                        picmap.Visible = false;
                        picmap1.Visible = false;
                        lbl123.Text = "";
                        lblCassetteRecipename.Text = "";

                        picWafer1.Visible = false;
                        picWafer2.Visible = false;
                        picWafer3.Visible = false;
                        picWafer4.Visible = false;
                        picWafer5.Visible = false;
                        picWafer6.Visible = false;
                        picWafer7.Visible = false;
                        picWafer8.Visible = false;
                        picWafer9.Visible = false;
                        picWafer10.Visible = false;
                        picWafer11.Visible = false;
                        picWafer12.Visible = false;
                        picWafer13.Visible = false;
                        picWafer14.Visible = false;
                        picWafer15.Visible = false;
                        picWafer16.Visible = false;
                        picWafer17.Visible = false;
                        picWafer18.Visible = false;
                        picWafer19.Visible = false;
                        picWafer20.Visible = false;
                        picWafer21.Visible = false;
                        picWafer22.Visible = false;
                        picWafer23.Visible = false;
                        picWafer24.Visible = false;
                        picWafer25.Visible = false;


                        lblProcess.Text = "Idle";
                        lbltm.Text = "Idle";

                        //   lblLoad.Text = "Aborted";
                        lblLoad.Text = "Selected recipe:" + form2Msg;
                        picMain.Image.Tag = "mainpicture";

                        return;
                    }


















                }

                else
            {

                MessageBox.Show("APM and TM are not idle");
            }

        }
            
            else
            {
                MessageBox.Show("Transport not in Automatic");

            }
    

    
        }





        private void button3_Click(object sender, EventArgs e)
        {
            // pauseSignal = new ManualResetEvent(true);
            //pauseSignal.Reset();
            // manu.Set();
            //////////////////////////////////////////////////////////
            /*     button4.Enabled = true;
                 button3.Enabled = false;
                 stopandstart1.start();*/
            //  t.Resume();
            //      manu.Set();
            // pauseSignal.Set();
            // myResetEvent.Set();

            /*   FlagStop = !FlagStop;
               if (FlagStop == true)

               {

                   MTestTdEvent.Reset();

               }

               else

               {

                   MTestTdEvent.Set();

               }*/

            //  taskwait = false;
            // pauseSignal.Set();
            // MessageBox.Show("7777");
            // ispauserobot = false;
            //  button2_Click(sender, e);
            // restartrobot();


            /*    while (picMain.Image.Tag.ToString() != "finishWaferA1")
                {

                    stoptherobot();
                    if (picMain.Image.Tag.ToString() == "finishWaferA1")
                    {
                        break;
                    }

                }*/
            PauseAndStopRobot stoprobot = new PauseAndStopRobot();
            stoprobot.label1.Text = "Do you want to stop this recipe?";
            DialogResult dr = stoprobot.ShowDialog();

            if (dr == DialogResult.OK)
            {

                isStopRobot = true;

                //  button2.Enabled = true;
                button2.Tag = "robotRestart";

                button3.Enabled = false;
                button4.Enabled = false;
                button5.Enabled = false;

            }
        }

        private void stoptherobot()
        {

          


            if (picMain.Image.Tag.ToString() == "finishWaferA1" || picMain.Image.Tag.ToString() == "finishWaferA2" || picMain.Image.Tag.ToString() == "finishWaferA3" || picMain.Image.Tag.ToString() == "finishwaferA4")
            {
                ispauserobot = true;
                

            }


        }

        /*public async void 暫停() {



        }*/

        private void button1_Click(object sender, EventArgs e)
        {


            Form2 form2 = new Form2();
            DialogResult dr = form2.ShowDialog();
            if (dr == DialogResult.OK)
            {

                form2Msg = form2.GetMsg();
                button2.Enabled = true;

                lblLoad.Text = "Selected recipe:" + form2Msg;


            }



        }

        private void button7_Click(object sender, EventArgs e)
        {
            //tabControl1.Visible = false;



        }

        private void button8_Click(object sender, EventArgs e)
        {
            // tabControl1.Visible = false;

        }

        private void button9_Click(object sender, EventArgs e)
        {
            //tabControl1.Visible = false;
        }

        private void btnRecipe_Click(object sender, EventArgs e)
        {

            RecipeType rt = new RecipeType();
            rt.ShowDialog();
            rt.Dispose();



        }

        private void btni2L_Click(object sender, EventArgs e)
        {
            i2L019 i2L019 = new i2L019();
            i2L019.ShowDialog();




        }

        private void button9_Click_1(object sender, EventArgs e)
        {

            cassette cassette = new cassette();
            cassette.Show();




        }

        private void button10_Click(object sender, EventArgs e)
        {
            Chamber1 chamber1 = new Chamber1();
            chamber1.ShowDialog();
        }

        private void button8_Click_1(object sender, EventArgs e)
        {
            Centralize centralize = new Centralize();
            centralize.ShowDialog();

        }

        private void btnVCH_Click(object sender, EventArgs e)
        {


            StateControlOfVCH VCH = new StateControlOfVCH();

            VCH.form1 = this;


            DialogResult dr = VCH.ShowDialog();











        }

        private void btnLog_Click(object sender, EventArgs e)
        {

            DataLogger datalogger = new DataLogger();
            datalogger.ShowDialog();




        }

        class stopandstart
        {
            private bool stopornot = false;

            public void stop()
            {
                stopornot = true;
                while (stopornot)
                {


                    System.Threading.Thread.Sleep(100);
                    // Application.DoEvents();
                }

            }
            public void start()
            {
                stopornot = false;

            }

        }
        stopandstart stopandstart1 = new stopandstart();


        private  void button4_Click(object sender, EventArgs e)
        {
            //manu = new ManualResetEvent(false);
            //manu.WaitOne();
            //   manu.Reset();
            //  manu1 = new AutoResetEvent(false);
            //  manu1.WaitOne();
            // manu.Reset();
            // await Task.Delay();

            // manu.WaitOne();
            // manu.Reset();
            //////////////////////////////////////////////////////////////////////////////////////
            /* button4.Enabled = false;
             button3.Enabled = true;
             stopandstart1.stop();*/
            /////////////////////////////////////////////////////////////////////////////////////

            //  Application.DoEvents();


            /*       picMain.Image = Properties.Resources.mainpicture;
                ispauserobot = true;
                picMain.Image.Tag = "mainpicture";*/


            PauseAndStopRobot cancelrecipe = new PauseAndStopRobot();
            cancelrecipe.label1.Text = "Do you want to cancel this recipe?";
            DialogResult dr = cancelrecipe.ShowDialog();
            if (dr == DialogResult.OK)
            {
                iscancelrecipe = true;

            }


        }

        private void OvalShapeVisible(bool visible)
        {
            if (visible == true)
            {
                ovalShape1.Visible = true;
            }
            if (visible == false)
            {
                ovalShape1.Visible = false;
            }
        }


        private void btnRobotAction_Click(object sender, EventArgs e)
        {

            ActionArm actionArm = new ActionArm();
            actionArm.form1 = this;
            actionArm.ShowDialog();

            Rotate rotate = new Rotate();
            rotate.myform1 = this;
        }

        private void button11_Click(object sender, EventArgs e)
        {

            btnRobotAction.Visible = false;

            btnChamberValve.Visible = false;



        }

        private void btnChamberValve_Click(object sender, EventArgs e)
        {
            SlotValve slotValve = new SlotValve();
            slotValve.form1 = this;
            slotValve.ShowDialog();




        }

        private void btnCassetteControl_Click(object sender, EventArgs e)
        {
            if (picMain.Image.Tag.ToString() == "picrobotintocassette")


            {

                Wafer_Transfer_and_Flag_Operation wafer = new Wafer_Transfer_and_Flag_Operation();
                wafer.form1 = this;
                wafer.ShowDialog();

            }

            else
            {

                cassettemap cassettemap = new cassettemap();
                cassettemap.form1 = this;
                cassettemap.ShowDialog();


            }

        }

        private  void button5_Click(object sender, EventArgs e)
        {
            //  await Task.Delay(7000);
            //  t.Suspend();
            //   pauseSignal.Reset();
            //manu.WaitOne();
            //manu.Set();

            //  myResetEvent.WaitOne();
            //  MessageBox.Show("123");
            //  Monitor.Wait();


            //   MTestTdEvent.WaitOne();
            // MTestTdEvent.Reset();
            //  MTestTdEvent.Set();


            //  delayTask.Wait();
            // taskwait = true;





            /*
            if (button5.Image.Tag.ToString() == "Pause")
            {
                taskTimer = new Task(Tasktest);
                taskTimer.Start();

                pauseSignal.WaitOne();
                pauseSignal.Reset();

               

                button5.Image = Properties.Resources.play;
                button5.Image.Tag = "Play";
            }
            else
            {
                pauseSignal.Set();
                button5.Image = Properties.Resources.pause2;

                button5.Image.Tag = "Pause";

            }
            */
            PauseAndStopRobot pauserobot = new PauseAndStopRobot();
            pauserobot.label1.Text = "Do you want to pause this recipe?";

            DialogResult dr = pauserobot.ShowDialog();

            if (dr == DialogResult.OK)
            {

                scsb = new SqlConnectionStringBuilder();
                scsb.DataSource = datasource;
                scsb.InitialCatalog = "RecipeType";
                scsb.IntegratedSecurity = true;
                SqlConnection con = new SqlConnection(scsb.ToString());
                con.Open();

                SqlCommand cmdeventlog = new SqlCommand(strEvent, con);

                cmdeventlog.Parameters.AddWithValue("@1", DateTime.Now);
                cmdeventlog.Parameters.AddWithValue("@2", "Machine robot stoped");
                cmdeventlog.Parameters.AddWithValue("@3", "Pause the robot");

                cmdeventlog.ExecuteNonQuery();

                con.Close();

                ispauserobot = true;

                button2.Enabled = true;
                button2.Tag = "robotPause";

                //pauseSignal.WaitOne();
            }
        }

        private void Tasktest()
        {
            //   MessageBox.Show("Test");
            // NewRecipe test = new NewRecipe();
            // test.ShowDialog();

            PauseTest pausetest = new PauseTest();
            pausetest.form1 = this;
            pausetest.ShowDialog();
         //   button5.Enabled = true;
        }


        private static void threadwait()
        {
            myResetEvent.WaitOne();

            MessageBox.Show("123");
        }


        private void button6_Click(object sender, EventArgs e)
        {

        }

        private void btnEventLog_Click(object sender, EventArgs e)
        {

            EventLog eventLog = new EventLog();
            eventLog.ShowDialog();




        }

        private void btnLogIn_Click(object sender, EventArgs e)
        {
            if (btnLogIn.Tag.ToString() == "LogIn")
            {
                LogIn logIn = new LogIn();

                logIn.form1 = this;
                logIn.ShowDialog();
            }
            else if (btnLogIn.Tag.ToString() == "LogOut")
            {
                LogOut logOut = new LogOut();
                logOut.form1 = this;
                logOut.ShowDialog();

            }
        }

        private void btnCentralizeControl_Click(object sender, EventArgs e)
        {

        }

        private void picSV_Click(object sender, EventArgs e)
        {
            SlotValve slotValve = new SlotValve();
            slotValve.form1 = this;
            slotValve.ShowDialog();
        }

        private void btnrobot_Click(object sender, EventArgs e)
        {
            MessageBox.Show("123");


        }

        private void picrobot_Click(object sender, EventArgs e)
        {
            MessageBox.Show("123");
        }

        private void panelrobot_Click(object sender, EventArgs e)
        {
            MessageBox.Show("123");
        }

        private void btnAPM_Click(object sender, EventArgs e)
        {

            APM apm = new APM();
            apm.form1 = this;
            apm.ShowDialog();


        }

        private void btntm_Click(object sender, EventArgs e)
        {
            TM tm = new TM();
            tm.form1 = this;
            tm.ShowDialog();


        }

        private void btnendeffector_Click(object sender, EventArgs e)
        {
            endeffector endeffector = new endeffector();
            //  endeffector.ovalvisible = new endeffector.OvalVisible(OvalShapeVisible);
            endeffector.form1 = this;
            endeffector.ShowDialog();
            //  MessageBox.Show(endeffector.str);
        }

        private void button6_Click_1(object sender, EventArgs e)
        {

        }

        private void lblwafer_Click(object sender, EventArgs e)
        {
            //MessageBox.Show("");

            endeffector endeffector = new endeffector();
            //  endeffector.ovalvisible = new endeffector.OvalVisible(OvalShapeVisible);
            endeffector.form1 = this;
            endeffector.ShowDialog();
            //  MessageBox.Show(endeffector.str);



        }

        private void lblwaferAPM_Click(object sender, EventArgs e)
        {
            endeffector endeffector = new endeffector();
            //  endeffector.ovalvisible = new endeffector.OvalVisible(OvalShapeVisible);
            endeffector.form1 = this;
            endeffector.ShowDialog();
            //  MessageBox.Show(endeffector.str);
        }

        private void picendeffector_Click(object sender, EventArgs e)
        {

            endeffector endeffector = new endeffector();
            //  endeffector.ovalvisible = new endeffector.OvalVisible(OvalShapeVisible);
            endeffector.form1 = this;
            endeffector.ShowDialog();
            //  MessageBox.Show(endeffector.str);

        }

        private void btnChamberControl_Click(object sender, EventArgs e)
        {

        }

        private void picMain_Click(object sender, EventArgs e)
        {
            /* int x = Control.MousePosition.X;
             int y = Control.MousePosition.Y;



             if (x >= 736 && x <= 766 && y >= 561 && y <= 591)
             {
                 endeffector endeffector = new endeffector();
                 //  endeffector.ovalvisible = new endeffector.OvalVisible(OvalShapeVisible);
                 endeffector.form1 = this;
                 endeffector.ShowDialog();
                 //  MessageBox.Show(endeffector.str);



             }*/




        }

        private void Form1_MouseMove(object sender, MouseEventArgs e)
        {
            /* x = e.Location.X;
              y = e.Location.Y;
              this.Invalidate();*/

            //  Point mousePoint = new Point(e.X, e.Y);


        }

        private void picMain_MouseMove(object sender, MouseEventArgs e)
        {
            /*  x = e.Location.X;
              y = e.Location.Y;
              this.Invalidate();*/
            x = e.X;
            y = e.Y;
        }

        private void Form1_Click(object sender, EventArgs e)
        {
            if (x >= 736 && x <= 766 && y >= 561 && y <= 591)
            {
                endeffector endeffector = new endeffector();
                //  endeffector.ovalvisible = new endeffector.OvalVisible(OvalShapeVisible);
                endeffector.form1 = this;
                endeffector.ShowDialog();
                //  MessageBox.Show(endeffector.str);



            }

        }

        private void button6_Click_2(object sender, EventArgs e)
        {

        }

        private void picMain_MouseClick(object sender, MouseEventArgs e)
        {
            /* if (e.X > 736 && e.Y > 561)
             {
                 endeffector endeffector = new endeffector();
                 //  endeffector.ovalvisible = new endeffector.OvalVisible(OvalShapeVisible);
                 endeffector.form1 = this;
                 endeffector.ShowDialog();
                 //  MessageBox.Show(endeffector.str);

             }*/




            if (e.X >= 70 && e.X <= 90 && e.Y >= 350 && e.Y <= 380)
            {
                endeffector endeffector = new endeffector();
                //  endeffector.ovalvisible = new endeffector.OvalVisible(OvalShapeVisible);
                endeffector.form1 = this;
                endeffector.ShowDialog();
                //  MessageBox.Show(endeffector.str);

            }

            else if (e.X >= 70 && e.X <= 90 && e.Y >= 290 && e.Y <= 320)
            {
                ActionArm actionArm = new ActionArm();
                actionArm.form1 = this;
                actionArm.ShowDialog();

                Rotate rotate = new Rotate();
                rotate.myform1 = this;

            }

        }

        private void Form1_MouseClick(object sender, MouseEventArgs e)
        {
            /*  Point p = e.Location;
              string X = p.X.ToString();
              string Y = p.Y.ToString();
              MessageBox.Show(p.ToString(), X + Y);*/
            if (e.X > 736 && e.Y > 561 && e.X < 746 && e.Y < 571)
            {
                endeffector endeffector = new endeffector();
                //  endeffector.ovalvisible = new endeffector.OvalVisible(OvalShapeVisible);
                endeffector.form1 = this;
                endeffector.ShowDialog();
                //  MessageBox.Show(endeffector.str);

            }
        }

        private void lblwaferright_Click(object sender, EventArgs e)
        {
            endeffector endeffector = new endeffector();
            //  endeffector.ovalvisible = new endeffector.OvalVisible(OvalShapeVisible);
            endeffector.form1 = this;
            endeffector.ShowDialog();
            //  MessageBox.Show(endeffector.str);
        }

        private void lblwaferup_Click(object sender, EventArgs e)
        {
            endeffector endeffector = new endeffector();
            //  endeffector.ovalvisible = new endeffector.OvalVisible(OvalShapeVisible);
            endeffector.form1 = this;
            endeffector.ShowDialog();
            //  MessageBox.Show(endeffector.str);
        }

        private void lblwaferaligner_Click(object sender, EventArgs e)
        {
            endeffector endeffector = new endeffector();
            //  endeffector.ovalvisible = new endeffector.OvalVisible(OvalShapeVisible);
            endeffector.form1 = this;
            endeffector.ShowDialog();
            //  MessageBox.Show(endeffector.str);
        }
    }


}


